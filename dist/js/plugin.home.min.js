function AstroMath(){}function Projection(a,b){this.PROJECTION=Projection.PROJ_TAN,this.ROT=this.tr_oR(a,b)}function Coo(a,b,c){this.lon=a,this.lat=b,this.prec=c,this.frame=null,this.computeDirCos()}function Tokenizer(a,b){this.string=Strings.trim(a,b),this.sep=b,this.pos=0}function Strings(){}function Numbers(){}function relMouseCoords(a){if(a.offsetX)return{x:a.offsetX,y:a.offsetY};if(!Utils.cssScale){var b=window.getComputedStyle(document.body,null),c=b.getPropertyValue("-webkit-transform")||b.getPropertyValue("-moz-transform")||b.getPropertyValue("-ms-transform")||b.getPropertyValue("-o-transform")||b.getPropertyValue("transform"),d=/matrix\((-?\d*\.?\d+),\s*0,\s*0,\s*(-?\d*\.?\d+),\s*0,\s*0\)/,e=c.match(d);Utils.cssScale=e?parseFloat(e[1]):1}var f=a;f.target;var g=f.target||f.srcElement,h=g.currentStyle||window.getComputedStyle(g,null),i=parseInt(h.borderLeftWidth,10),j=parseInt(h.borderTopWidth,10),k=g.getBoundingClientRect(),l=f.clientX-i-k.left,m=f.clientY-j-k.top;return{x:parseInt(l/Utils.cssScale),y:parseInt(m/Utils.cssScale)}}var cds=cds||{},A=A||{};"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?i+"":"null";case"boolean":case"null":return i+"";case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text+="",cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),Logger={},Logger.log=function(a,b){try{var c="http://alasky.unistra.fr/cgi/AladinLiteLogger/log.py",d="";b&&(d=JSON.stringify(b)),$.ajax({url:c,data:{action:a,params:d,pageUrl:window.location.href,referer:document.referrer?document.referrer:""},method:"GET",dataType:"json"})}catch(a){window.console&&void 0}},function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a:a(jQuery)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,l=0,m=0,n=0,o=0,p=0;if(b=a.event.fix(g),b.type="mousewheel","detail"in g&&(m=-1*g.detail),"wheelDelta"in g&&(m=g.wheelDelta),"wheelDeltaY"in g&&(m=g.wheelDeltaY),"wheelDeltaX"in g&&(l=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(l=-1*m,m=0),j=0===m?l:m,"deltaY"in g&&(m=-1*g.deltaY,j=m),"deltaX"in g&&(l=g.deltaX,0===m&&(j=-1*l)),0!==m||0!==l){if(1===g.deltaMode){var q=a.data(this,"mousewheel-line-height");j*=q,m*=q,l*=q}else if(2===g.deltaMode){var r=a.data(this,"mousewheel-page-height");j*=r,m*=r,l*=r}if(n=Math.max(Math.abs(m),Math.abs(l)),(!f||f>n)&&(f=n,d(g,n)&&(f/=40)),d(g,n)&&(j/=40,l/=40,m/=40),j=Math[j>=1?"floor":"ceil"](j/f),l=Math[l>=1?"floor":"ceil"](l/f),m=Math[m>=1?"floor":"ceil"](m/f),k.settings.normalizeOffset&&this.getBoundingClientRect){var s=this.getBoundingClientRect();o=b.clientX-s.left,p=b.clientY-s.top}return b.deltaX=l,b.deltaY=m,b.deltaFactor=f,b.offsetX=o,b.offsetY=p,b.deltaMode=0,h.unshift(b,j,l,m),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)}}function c(){f=null}function d(a,b){return k.settings.adjustOldDeltas&&"mousewheel"===a.type&&0===b%120}var e,f,g=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],h="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,"mousewheel-line-height",k.getLineHeight(this)),a.data(this,"mousewheel-page-height",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var c=h.length;c;)this.removeEventListener(h[--c],b,!1);else this.onmousewheel=null;a.removeData(this,"mousewheel-line-height"),a.removeData(this,"mousewheel-page-height")},getLineHeight:function(b){var c=a(b),d=c["offsetParent"in a.fn?"offsetParent":"parent"]();return d.length||(d=a("body")),parseInt(d.css("fontSize"),10)||parseInt(c.css("fontSize"),10)||16},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}();var Stats=function(){function a(a,b,c){var d,e,f;for(e=0;30>e;e++)for(d=0;73>d;d++)f=4*(d+74*e),a[f]=a[f+4],a[f+1]=a[f+5],a[f+2]=a[f+6];for(e=0;30>e;e++)f=4*(73+74*e),b>e?(a[f]=E[c].bg.r,a[f+1]=E[c].bg.g,a[f+2]=E[c].bg.b):(a[f]=E[c].fg.r,a[f+1]=E[c].fg.g,a[f+2]=E[c].fg.b)}var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=0,q=2,r=0,s=(new Date).getTime(),t=s,u=s,v=0,w=1e3,x=0,y=0,z=1e3,A=0,B=0,C=1e3,D=0,E={fps:{bg:{r:16,g:16,b:48},fg:{r:0,g:255,b:255}},ms:{bg:{r:16,g:48,b:16},fg:{r:0,g:255,b:0}},mb:{bg:{r:48,g:16,b:26},fg:{r:255,g:0,b:128}}};b=document.createElement("div"),b.style.cursor="pointer",b.style.width="80px",b.style.opacity="0.9",b.style.zIndex="10001",b.addEventListener("click",function(){switch(p++,p==q&&(p=0),c.style.display="none",h.style.display="none",l.style.display="none",p){case 0:c.style.display="block";break;case 1:h.style.display="block";break;case 2:l.style.display="block"}},!1),c=document.createElement("div"),c.style.backgroundColor="rgb("+Math.floor(E.fps.bg.r/2)+","+Math.floor(E.fps.bg.g/2)+","+Math.floor(E.fps.bg.b/2)+")",c.style.padding="2px 0px 3px 0px",b.appendChild(c),d=document.createElement("div"),d.style.fontFamily="Helvetica, Arial, sans-serif",d.style.textAlign="left",d.style.fontSize="9px",d.style.color="rgb("+E.fps.fg.r+","+E.fps.fg.g+","+E.fps.fg.b+")",d.style.margin="0px 0px 1px 3px",d.innerHTML='<span style="font-weight:bold">FPS</span>',c.appendChild(d),e=document.createElement("canvas"),e.width=74,e.height=30,e.style.display="block",e.style.marginLeft="3px",c.appendChild(e),f=e.getContext("2d"),f.fillStyle="rgb("+E.fps.bg.r+","+E.fps.bg.g+","+E.fps.bg.b+")",f.fillRect(0,0,e.width,e.height),g=f.getImageData(0,0,e.width,e.height),h=document.createElement("div"),h.style.backgroundColor="rgb("+Math.floor(E.ms.bg.r/2)+","+Math.floor(E.ms.bg.g/2)+","+Math.floor(E.ms.bg.b/2)+")",h.style.padding="2px 0px 3px 0px",h.style.display="none",b.appendChild(h),i=document.createElement("div"),i.style.fontFamily="Helvetica, Arial, sans-serif",i.style.textAlign="left",i.style.fontSize="9px",i.style.color="rgb("+E.ms.fg.r+","+E.ms.fg.g+","+E.ms.fg.b+")",i.style.margin="0px 0px 1px 3px",i.innerHTML='<span style="font-weight:bold">MS</span>',h.appendChild(i),e=document.createElement("canvas"),e.width=74,e.height=30,e.style.display="block",e.style.marginLeft="3px",h.appendChild(e),j=e.getContext("2d"),j.fillStyle="rgb("+E.ms.bg.r+","+E.ms.bg.g+","+E.ms.bg.b+")",j.fillRect(0,0,e.width,e.height),k=j.getImageData(0,0,e.width,e.height);try{performance&&performance.memory&&performance.memory.totalJSHeapSize&&(q=3)}catch(a){}return l=document.createElement("div"),l.style.backgroundColor="rgb("+Math.floor(E.mb.bg.r/2)+","+Math.floor(E.mb.bg.g/2)+","+Math.floor(E.mb.bg.b/2)+")",l.style.padding="2px 0px 3px 0px",l.style.display="none",b.appendChild(l),m=document.createElement("div"),m.style.fontFamily="Helvetica, Arial, sans-serif",m.style.textAlign="left",m.style.fontSize="9px",m.style.color="rgb("+E.mb.fg.r+","+E.mb.fg.g+","+E.mb.fg.b+")",m.style.margin="0px 0px 1px 3px",m.innerHTML='<span style="font-weight:bold">MB</span>',l.appendChild(m),e=document.createElement("canvas"),e.width=74,e.height=30,e.style.display="block",e.style.marginLeft="3px",l.appendChild(e),n=e.getContext("2d"),n.fillStyle="#301010",n.fillRect(0,0,e.width,e.height),o=n.getImageData(0,0,e.width,e.height),{domElement:b,update:function(){r++,s=(new Date).getTime(),y=s-t,z=Math.min(z,y),A=Math.max(A,y),a(k.data,Math.min(30,30-30*(y/200)),"ms"),i.innerHTML='<span style="font-weight:bold">'+y+" MS</span> ("+z+"-"+A+")",j.putImageData(k,0,0),t=s,s>u+1e3&&(v=Math.round(1e3*r/(s-u)),w=Math.min(w,v),x=Math.max(x,v),a(g.data,Math.min(30,30-30*(v/100)),"fps"),d.innerHTML='<span style="font-weight:bold">'+v+" FPS</span> ("+w+"-"+x+")",f.putImageData(g,0,0),3==q&&(B=9.54e-7*performance.memory.usedJSHeapSize,C=Math.min(C,B),D=Math.max(D,B),a(o.data,Math.min(30,30-B/2),"mb"),m.innerHTML='<span style="font-weight:bold">'+Math.round(B)+" MB</span> ("+Math.round(C)+"-"+Math.round(D)+")",n.putImageData(o,0,0)),u=s,r=0)}}};Constants={},Constants.PI=Math.PI,Constants.C_PR=Math.PI/180,Constants.VLEV=2,Constants.EPS=1e-7,Constants.c=.105,Constants.LN10=Math.log(10),Constants.PIOVER2=Math.PI/2,Constants.TWOPI=2*Math.PI,Constants.TWOTHIRD=2/3,Constants.ARCSECOND_RADIAN=484813681109536e-20,SpatialVector=function(){function a(a,b,c){"use strict";this.x=a,this.y=b,this.z=c,this.ra_=0,this.dec_=0,this.okRaDec_=!1}return a.prototype.setXYZ=function(a,b,c){this.x=a,this.y=b,this.z=c,this.okRaDec_=!1},a.prototype.length=function(){"use strict";return Math.sqrt(this.lengthSquared())},a.prototype.lengthSquared=function(){"use strict";return this.x*this.x+this.y*this.y+this.z*this.z},a.prototype.normalized=function(){"use strict";var a=this.length();this.x/=a,this.y/=a,this.z/=a},a.prototype.set=function(a,b){"use strict";this.ra_=a,this.dec_=b,this.okRaDec_=!0,this.updateXYZ()},a.prototype.angle=function(a){"use strict";var b=this.y*a.z-this.z*a.y,c=this.z*a.x-this.x*a.z,d=this.x*a.y-this.y*a.x,e=Math.sqrt(b*b+c*c+d*d);return Math.abs(Math.atan2(e,dot(a)))},a.prototype.get=function(){"use strict";return[x,y,z]},a.prototype.toString=function(){"use strict";return"SpatialVector["+this.x+", "+this.y+", "+this.z+"]"},a.prototype.cross=function(b){"use strict";return new a(this.y*b.z-b.y*this.z,this.z*b.x-b.z*this.x,this.x*b.y-b.x()*this.y)},a.prototype.equal=function(a){"use strict";return this.x==a.x&&this.y==a.y&&this.z==a.z()},a.prototype.mult=function(b){"use strict";return new a(b*this.x,b*this.y,b*this.z)},a.prototype.dot=function(a){"use strict";return this.x*a.x+this.y*a.y+this.z*a.z},a.prototype.add=function(b){"use strict";return new a(this.x+b.x,this.y+b.y,this.z+b.z)},a.prototype.sub=function(b){"use strict";return new a(this.x-b.x,this.y-b.y,this.z-b.z)},a.prototype.dec=function(){"use strict";return this.okRaDec_||(this.normalized(),this.updateRaDec()),this.dec_},a.prototype.ra=function(){"use strict";return this.okRaDec_||(this.normalized(),this.updateRaDec()),this.ra_},a.prototype.updateXYZ=function(){"use strict";var a=Math.cos(this.dec_*Constants.C_PR);this.x=Math.cos(this.ra_*Constants.C_PR)*a,this.y=Math.sin(this.ra_*Constants.C_PR)*a,this.z=Math.sin(this.dec_*Constants.C_PR)},a.prototype.updateRaDec=function(){"use strict";this.dec_=Math.asin(this.z)/Constants.C_PR;var a=Math.cos(this.dec_*Constants.C_PR);this.ra_=a>Constants.EPS||-Constants.EPS>a?this.y>Constants.EPS||this.y<-Constants.EPS?0>this.y?360-Math.acos(this.x/a)/Constants.C_PR:Math.acos(this.x/a)/Constants.C_PR:0>this.x?180:0:0,this.okRaDec_=!0},a.prototype.toRaRadians=function(){"use strict";var a=0;return(0!=this.x||0!=this.y)&&(a=Math.atan2(this.y,this.x)),0>a&&(a+=2*Math.PI),a},a.prototype.toDeRadians=function(){var a=z/this.length(),b=Math.acos(a);return Math.PI/2-b},a}(),AngularPosition=function(){return AngularPosition=function(a,b){"use strict";this.theta=a,this.phi=b},AngularPosition.prototype.toString=function(){"use strict";return"theta: "+this.theta+", phi: "+this.phi},AngularPosition}(),LongRangeSetBuilder=function(){function a(){this.items=[]}return a.prototype.appendRange=function(a,b){for(var c=a;b>=c;c++)c in this.items||this.items.push(c)},a}(),HealpixIndex=function(){function a(a){"use strict";this.nside=a}return a.NS_MAX=8192,a.ORDER_MAX=13,a.NSIDELIST=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192],a.JRLL=[2,2,2,2,3,3,3,3,4,4,4,4],a.JPLL=[1,3,5,7,0,2,4,6,1,3,5,7],a.XOFFSET=[-1,-1,0,1,1,1,0,-1],a.YOFFSET=[0,1,1,1,0,-1,-1,-1],a.FACEARRAY=[[8,9,10,11,-1,-1,-1,-1,10,11,8,9],[5,6,7,4,8,9,10,11,9,10,11,8],[-1,-1,-1,-1,5,6,7,4,-1,-1,-1,-1],[4,5,6,7,11,8,9,10,11,8,9,10],[0,1,2,3,4,5,6,7,8,9,10,11],[1,2,3,0,0,1,2,3,5,6,7,4],[-1,-1,-1,-1,7,4,5,6,-1,-1,-1,-1],[3,0,1,2,3,0,1,2,4,5,6,7],[2,3,0,1,-1,-1,-1,-1,0,1,2,3]],a.SWAPARRAY=[[0,0,0,0,0,0,0,0,3,3,3,3],[0,0,0,0,0,0,0,0,6,6,6,6],[0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,5,5,5,5],[0,0,0,0,0,0,0,0,0,0,0,0],[5,5,5,5,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0],[6,6,6,6,0,0,0,0,0,0,0,0],[3,3,3,3,0,0,0,0,0,0,0,0]],a.Z0=Constants.TWOTHIRD,a.prototype.init=function(){"use strict";var b=256;this.ctab=Array(b),this.utab=Array(b);for(var c=0;256>c;++c)this.ctab[c]=1&c|(2&c)<<7|(4&c)>>1|(8&c)<<6|(16&c)>>2|(32&c)<<5|(64&c)>>3|(128&c)<<4,this.utab[c]=1&c|(2&c)<<1|(4&c)<<2|(8&c)<<3|(16&c)<<4|(32&c)<<5|(64&c)<<6|(128&c)<<7;this.nl2=2*this.nside,this.nl3=3*this.nside,this.nl4=4*this.nside,this.npface=this.nside*this.nside,this.ncap=2*this.nside*(this.nside-1),this.npix=12*this.npface,this.fact2=4/this.npix,this.fact1=(this.nside<<1)*this.fact2,this.order=a.nside2order(this.nside)},a.calculateNSide=function(b){for(var c=0,d=b*b,e=180/Constants.PI,f=5184e4*Constants.PI*e*e,g=Utils.castToInt(f/d),h=g/12,i=Math.sqrt(h),j=a.NS_MAX,k=0,l=0;a.NSIDELIST.length>l;l++)if(j>=Math.abs(i-a.NSIDELIST[l])&&(j=Math.abs(i-a.NSIDELIST[l]),c=a.NSIDELIST[l],k=l),i>c&&a.NS_MAX>i&&(c=a.NSIDELIST[k+1]),i>a.NS_MAX)return a.NS_MAX;return c},a.nside2order=function(b){"use strict";return(b&b-1)>0?-1:Utils.castToInt(a.log2(b))},a.log2=function(a){"use strict";return Math.log(a)/Math.log(2)},a.prototype.ang2pix_nest=function(b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p;if(c>=Constants.TWOPI&&(c-=Constants.TWOPI),0>c&&(c+=Constants.TWOPI),b>Constants.PI||0>b)throw{name:"Illegal argument",message:"theta must be between 0 and "+Constants.PI};if(c>Constants.TWOPI||0>c)throw{name:"Illegal argument",message:"phi must be between 0 and "+Constants.TWOPI};if(e=Math.cos(b),f=Math.abs(e),g=c/Constants.PIOVER2,a.Z0>=f){var q=this.nside*(.5+g),r=.75*this.nside*e,k=q-r,l=q+r;i=k>>this.order,j=l>>this.order,n=i==j?4==i?4:i+4:j>i?i:j+8,o=Utils.castToInt(l&this.nside-1),p=Utils.castToInt(this.nside-(k&this.nside-1)-1)}else{m=Utils.castToInt(g),m>=4&&(m=3),h=g-m;var s=this.nside*Math.sqrt(3*(1-f));k=Utils.castToInt(h*s),l=Utils.castToInt((1-h)*s),k=Math.min(a.NS_MAX-1,k),l=Math.min(a.NS_MAX-1,l),e>=0?(n=m,o=Utils.castToInt(this.nside-l-1),p=Utils.castToInt(this.nside-k-1)):(n=m+8,o=k,p=l)}return d=this.xyf2nest(o,p,n)},a.prototype.xyf2nest=function(a,b,c){"use strict";return(c<<2*this.order)+(this.utab[255&a]|this.utab[255&a>>8]<<16|this.utab[255&a>>16]<<32|this.utab[255&a>>24]<<48|this.utab[255&b]<<1|this.utab[255&b>>8]<<17|this.utab[255&b>>16]<<33|this.utab[255&b>>24]<<49)},a.prototype.nest2xyf=function(a){"use strict";var b={};b.face_num=a>>2*this.order;var c=a&this.npface-1,d=(93823560581120&c)>>16|(614882086624428e4&c)>>31|21845&c|(1431633920&c)>>15;return b.ix=this.ctab[255&d]|this.ctab[255&d>>8]<<4|this.ctab[255&d>>16]<<16|this.ctab[255&d>>24]<<20,c>>=1,d=(93823560581120&c)>>16|(614882086624428e4&c)>>31|21845&c|(1431633920&c)>>15,b.iy=this.ctab[255&d]|this.ctab[255&d>>8]<<4|this.ctab[255&d>>16]<<16|this.ctab[255&d>>24]<<20,b},a.prototype.pix2ang_nest=function(b){"use strict";if(0>b||b>this.npix-1)throw{name:"Illegal argument",message:"ipix out of range"};var c,d,e,f=this.nest2xyf(b),g=f.ix,h=f.iy,i=f.face_num,j=(a.JRLL[i]<<this.order)-g-h-1;this.nside>j?(c=j,d=1-c*c*this.fact2,e=0):j>this.nl3?(c=this.nl4-j,d=c*c*this.fact2-1,e=0):(c=this.nside,d=(this.nl2-j)*this.fact1,e=1&j-this.nside);var k=Math.acos(d),l=(a.JPLL[i]*c+g-h+1+e)/2;l>this.nl4&&(l-=this.nl4),1>l&&(l+=this.nl4);var m=(l-.5*(e+1))*(Constants.PIOVER2/c);return{theta:k,phi:m}},a.nside2Npix=function(b){"use strict";if(0>b||(b&-b)!=b||b>a.NS_MAX)throw{name:"Illegal argument",message:"nside should be >0, power of 2, <"+a.NS_MAX};var c=12*b*b;return c},a.prototype.xyf2ring=function(b,c,d){"use strict";var e,f,g,h=a.JRLL[d]*this.nside-b-c-1;this.nside>h?(e=h,g=2*e*(e-1),f=0):h>3*this.nside?(e=this.nl4-h,g=this.npix-2*(e+1)*e,f=0):(e=this.nside,g=this.ncap+(h-this.nside)*this.nl4,f=1&h-this.nside);var i=(a.JPLL[d]*e+b-c+1+f)/2;return i>this.nl4?i-=this.nl4:1>i&&(i+=this.nl4),g+i-1},a.prototype.nest2ring=function(a){"use strict";var b=this.nest2xyf(a),c=this.xyf2ring(b.ix,b.iy,b.face_num);return c},a.prototype.corners_nest=function(a,b){"use strict";var c=this.nest2ring(a);return this.corners_ring(c,b)},a.prototype.pix2ang_ring=function(a){"use strict";var b,c,d,e,f,g,h,i,j;if(0>a||a>this.npix-1)throw{name:"Illegal argument",message:"ipix out of range"};return g=a+1,this.ncap>=g?(i=g/2,j=Utils.castToInt(i),d=Utils.castToInt(Math.sqrt(i-Math.sqrt(j)))+1,e=g-2*d*(d-1),b=Math.acos(1-d*d*this.fact2),c=(e-.5)*Constants.PI/(2*d)):this.npix-this.ncap>a?(f=a-this.ncap,d=f/this.nl4+this.nside,e=f%this.nl4+1,h=(1&d+this.nside)>0?1:.5,b=Math.acos((this.nl2-d)*this.fact1),c=(e-h)*Constants.PI/this.nl2):(f=this.npix-a,d=Utils.castToInt(.5*(1+Math.sqrt(2*f-1))),e=4*d+1-(f-2*d*(d-1)),b=Math.acos(-1+Math.pow(d,2)*this.fact2),c=(e-.5)*Constants.PI/(2*d)),[b,c]},a.prototype.ring=function(a){"use strict";var b,c,d=0,e=a+1,f=0;return this.ncap>=e?(c=e/2,f=Utils.castToInt(c),d=Utils.castToInt(Math.sqrt(c-Math.sqrt(f)))+1):this.nl2*(5*this.nside+1)>=e?(b=Utils.castToInt(e-this.ncap-1),d=Utils.castToInt(b/this.nl4+this.nside)):(b=this.npix-e+1,c=b/2,f=Utils.castToInt(c),d=Utils.castToInt(Math.sqrt(c-Math.sqrt(f)))+1,d=this.nl4-d),d},a.prototype.integration_limits_in_costh=function(a){"use strict";var b,c,d,e;return e=1*this.nside,this.nside>=a?(c=1-Math.pow(a,2)/3/this.npface,d=1-Math.pow(a-1,2)/3/this.npface,b=a==this.nside?2*(this.nside-1)/3/e:1-Math.pow(a+1,2)/3/this.npface):this.nl3>a?(c=2*(2*this.nside-a)/3/e,d=2*(2*this.nside-a+1)/3/e,b=2*(2*this.nside-a-1)/3/e):(d=a==this.nl3?2*(-this.nside+1)/3/e:-1+Math.pow(4*this.nside-a+1,2)/3/this.npface,b=-1+Math.pow(this.nl4-a-1,2)/3/this.npface,c=-1+Math.pow(this.nl4-a,2)/3/this.npface),[d,c,b]},a.prototype.pixel_boundaries=function(a,b,c,d){var e,f,g,h,i,j,k,l,m=1*this.nside;if(Math.abs(d)>=1-1/3/this.npface)return k=c*Constants.PIOVER2,l=(c+1)*Constants.PIOVER2,[k,l];if(1.5*d>=1)e=Math.sqrt(3*(1-d)),f=1/m/e,g=b,h=g-1,i=a-b,j=i+1,k=Constants.PIOVER2*(Math.max(h*f,1-j*f)+c),l=Constants.PIOVER2*(Math.min(1-i*f,g*f)+c);else if(1.5*d>-1){var n=.5*(1-1.5*d),o=n+1,p=this.nside+a%2;g=b-(p-a)/2,h=g-1,i=(p+a)/2-b,j=i+1,k=Constants.PIOVER2*(Math.max(o-j/m,-n+h/m)+c),l=Constants.PIOVER2*(Math.min(o-i/m,-n+g/m)+c)}else{e=Math.sqrt(3*(1+d)),f=1/m/e;var q=2*this.nside;g=a-q+b,h=g-1,i=q-b,j=i+1,k=Constants.PIOVER2*(Math.max(1-(q-h)*f,(q-j)*f)+c),l=Constants.PIOVER2*(Math.min(1-(q-g)*f,(q-i)*f)+c)}return[k,l]},a.vector=function(a,b){"use strict";var c=1*Math.sin(a)*Math.cos(b),d=1*Math.sin(a)*Math.sin(b),e=1*Math.cos(a);return new SpatialVector(c,d,e)},a.prototype.corners_ring=function(b,c){"use strict";var d=2*c+2,e=Array(d),f=this.pix2ang_ring(b),g=Math.cos(f[0]),h=f[0],i=f[1],j=Utils.castToInt(i/Constants.PIOVER2),k=this.ring(b),l=Math.min(k,Math.min(this.nside,this.nl4-k)),m=0,n=Constants.PIOVER2/l;m=k>=this.nside&&this.nl3>=k?Utils.castToInt(i/n+k%2/2)+1:Utils.castToInt(i/n)+1,m-=j*l;var o=d/2,p=this.integration_limits_in_costh(k),q=Math.acos(p[0]),r=Math.acos(p[2]),s=this.pixel_boundaries(k,m,j,p[0]);if(e[0]=m>l/2?a.vector(q,s[1]):a.vector(q,s[0]),s=this.pixel_boundaries(k,m,j,p[2]),e[o]=m>l/2?a.vector(r,s[1]):a.vector(r,s[0]),1==c){var t=Math.acos(p[1]);s=this.pixel_boundaries(k,m,j,p[1]),e[1]=a.vector(t,s[0]),e[3]=a.vector(t,s[1])}else for(var u=p[2]-p[0],v=u/(c+1),w=1;c>=w;w++)g=p[0]+v*w,h=Math.acos(g),s=this.pixel_boundaries(k,m,j,g),e[w]=a.vector(h,s[0]),e[d-w]=a.vector(h,s[1]);return e},a.vec2Ang=function(a){"use strict";var b=a.z/a.length(),c=Math.acos(b),d=0;return(0!=a.x||0!=a.y)&&(d=Math.atan2(a.y,a.x)),0>d&&(d+=2*Math.PI),[c,d]},a.prototype.queryDisc=function(b,c,d,e){"use strict";if(0>c||c>Constants.PI)throw{name:"Illegal argument",message:"angular radius is in RADIAN and should be in [0,pi]"};var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=new LongRangeSetBuilder,z=null,j=c;if(e&&(j+=Constants.PI/this.nl4),z=a.vec2Ang(b),k=z[0],l=z[1],p=this.fact2,q=this.fact1,i=Math.cos(k),x=1/Math.sqrt((1-i)*(1+i)),s=k-j,t=k+j,m=Math.cos(j),v=Math.cos(s),f=this.ringAbove(v)+1,u=Math.cos(t),g=this.ringAbove(u),f>g&&0==g&&(g=f),0>=s)for(var A=1;f>A;++A)this.inRing(A,0,Math.PI,y);for(h=f;g>=h;++h)w=this.nside>h?1-h*h*p:this.nl3>=h?(this.nl2-h)*q:-1+(this.nl4-h)*(this.nl4-h)*p,n=(m-w*i)*x,o=1-w*w-n*n,r=Math.atan2(Math.sqrt(o),n),isNaN(r)&&(r=j),this.inRing(h,l,r,y);if(t>=Math.PI)for(var A=g+1;this.nl4>A;++A)this.inRing(A,0,Math.PI,y,!1);var B;if(d){for(var C=y.items,D=[],E=0;C.length>E;E++){var F=this.ring2nest(C[E]);D.indexOf(F)>=0||D.push(F)}B=D}else B=y.items;return B},a.prototype.inRing=function(a,b,c,d,e){"use strict";var f,g,h,i,j=!1,k=!1,l=1e-12,m=0,n=0,o=0,p=0,q=(b-c)%Constants.TWOPI-l,r=b+c+l,s=(b+c)%Constants.TWOPI+l;if(l>Math.abs(c-Constants.PI)&&(j=!0),a>=this.nside&&this.nl3>=a?(n=a-this.nside+1,h=this.ncap+this.nl4*(n-1),i=h+this.nl4-1,f=n%2,g=this.nl4):(this.nside>a?(n=a,h=2*n*(n-1),i=h+4*n-1):(n=4*this.nside-a,h=this.npix-2*n*(n+1),i=h+4*n-1),g=4*n,f=1),j)return void d.appendRange(h,i);if(m=f/2,e)o=Math.round(g*q/Constants.TWOPI-m),p=Math.round(g*r/Constants.TWOPI-m),o%=g,p>g&&(p%=g);else{if(o=Math.ceil(g*q/Constants.TWOPI-m),p=Utils.castToInt(g*s/Constants.TWOPI-m),o>p&&1==a&&(p=Utils.castToInt(g*r/Constants.TWOPI-m)),o==p+1&&(o=p),1==o-p&&Constants.PI>c*g)return;o=Math.min(o,g-1),p=Math.max(p,0)}if(o>p&&(k=!0),k)o+=h,p+=h,d.appendRange(h,p),d.appendRange(o,i);else{if(0>o)return o=Math.abs(o),d.appendRange(h,h+p),void d.appendRange(i-o+1,i);o+=h,p+=h,d.appendRange(o,p)}},a.prototype.ringAbove=function(a){"use strict";var b=Math.abs(a);if(b>Constants.TWOTHIRD){var c=Utils.castToInt(this.nside*Math.sqrt(3*(1-b)));return a>0?c:4*this.nside-c-1}return Utils.castToInt(this.nside*(2-1.5*a))},a.prototype.ring2nest=function(a){"use strict";var b=this.ring2xyf(a);return this.xyf2nest(b.ix,b.iy,b.face_num)},a.prototype.ring2xyf=function(b){"use strict";var c,d,e,f,g={};if(this.ncap>b){c=Utils.castToInt(.5*(1+Math.sqrt(1+2*b))),d=b+1-2*c*(c-1),e=0,f=c,g.face_num=0;var h=d-1;h>=2*c&&(g.face_num=2,h-=2*c),h>=c&&++g.face_num}else if(this.npix-this.ncap>b){var i=b-this.ncap;this.order>=0?(c=(i>>this.order+2)+this.nside,d=(i&this.nl4-1)+1):(c=i/this.nl4+this.nside,d=i%this.nl4+1),e=1&c+this.nside,f=this.nside;var j,k,l=c-this.nside+1,m=this.nl2+2-l;this.order>=0?(j=d-Utils.castToInt(l/2)+this.nside-1>>this.order,k=d-Utils.castToInt(m/2)+this.nside-1>>this.order):(j=(d-Utils.castToInt(l/2)+this.nside-1)/this.nside,k=(d-Utils.castToInt(m/2)+this.nside-1)/this.nside),g.face_num=k==j?4==k?4:Utils.castToInt(k)+4:j>k?Utils.castToInt(k):Utils.castToInt(j)+8}else{var i=this.npix-b;c=Utils.castToInt(.5*(1+Math.sqrt(2*i-1))),d=4*c+1-(i-2*c*(c-1)),e=0,f=c,c=2*this.nl2-c,g.face_num=8;var h=d-1;h>=2*f&&(g.face_num=10,h-=2*f),h>=f&&++g.face_num}var n=c-a.JRLL[g.face_num]*this.nside+1,o=2*d-a.JPLL[g.face_num]*f-e-1;return o>=this.nl2&&(o-=8*this.nside),g.ix=o-n>>1,g.iy=-(o+n)>>1,g},a}(),Utils=function(){},Utils.radecToPolar=function(a,b){return{theta:Math.PI/2-b/180*Math.PI,phi:a/180*Math.PI}},Utils.polarToRadec=function(a,b){return{ra:180*b/Math.PI,dec:180*(Math.PI/2-a)/Math.PI}},Utils.castToInt=function(a){return a>0?Math.floor(a):Math.ceil(a)},AstroMath.D2R=Math.PI/180,AstroMath.R2D=180/Math.PI,AstroMath.sign=function(a){return a>0?1:0>a?-1:0},AstroMath.cosd=function(a){if(0==a%90){var b=Math.abs(Math.floor(a/90+.5))%4;switch(b){case 0:return 1;case 1:return 0;case 2:return-1;case 3:return 0}}return Math.cos(a*AstroMath.D2R)},AstroMath.sind=function(a){if(0===a%90){var b=Math.abs(Math.floor(a/90-.5))%4;switch(b){case 0:return 1;case 1:return 0;case 2:return-1;case 3:return 0}}return Math.sin(a*AstroMath.D2R)},AstroMath.tand=function(a){var b;return b=a%360,0==b||180==Math.abs(b)?0:45==b||225==b?1:-135==b||-315==b?-1:Math.tan(a*AstroMath.D2R)},AstroMath.asind=function(a){return Math.asin(a)*AstroMath.R2D},AstroMath.acosd=function(a){return Math.acos(a)*AstroMath.R2D},AstroMath.atand=function(a){return Math.atan(a)*AstroMath.R2D},AstroMath.atan2=function(a,b){if(0==a)return b>0?0:0>b?Math.PI:NaN;var c=AstroMath.sign(a);if(0==b)return Math.PI/2*c;var d=Math.atan(Math.abs(a/b));return b>0?d*c:0>b?(Math.PI-d)*c:void 0},AstroMath.atan2d=function(a,b){return AstroMath.atan2(a,b)*AstroMath.R2D},AstroMath.cosh=function(a){return(Math.exp(a)+Math.exp(-a))/2},AstroMath.sinh=function(a){return(Math.exp(a)-Math.exp(-a))/2},AstroMath.tanh=function(a){return(Math.exp(a)-Math.exp(-a))/(Math.exp(a)+Math.exp(-a))},AstroMath.acosh=function(a){return Math.log(a+Math.sqrt(a*a-1))},AstroMath.asinh=function(a){return Math.log(a+Math.sqrt(a*a+1))},AstroMath.atanh=function(a){return.5*Math.log((1+a)/(1-a))},AstroMath.sinc=function(a){var b,c=Math.abs(a);return.001>=c?(c*=c,b=1-c*(1-c/20)/6):b=Math.sin(c)/c,b},AstroMath.asinc=function(a){var b,c=Math.abs(a);return.001>=c?(c*=c,b=1+c*(6+.45*c)/6):b=Math.asin(c)/c,b},AstroMath.hypot=function(a,b){return Math.sqrt(a*a+b*b)},AstroMath.eulerMatrix=function(a,b,c){var d=Array(3);d[0]=Array(3),d[1]=Array(3),d[2]=Array(3);var e=AstroMath.cosd(a),f=AstroMath.sind(a),g=AstroMath.cosd(b),h=AstroMath.sind(b),i=AstroMath.cosd(c),j=AstroMath.sind(c);return d[0][0]=i*g*e-j*f,d[0][1]=-j*g*e-i*f,d[0][2]=-h*e,d[1][0]=i*g*f+j*e,d[1][1]=-j*g*f+i*e,d[1][2]=-h*f,d[2][0]=-h*i,d[2][1]=-h*e,d[2][2]=g,d},AstroMath.displayMatrix=function(a){for(var b=a.length,c=0,d=0;b>d;d++)a[d].length>c&&(c=a[d].length);for(var e="<table>\n",d=0;b>d;d++){e+="<tr>";for(var f=0;b>f;f++)e+="<td>",a[d].length>d&&(e+=""+a[d][f]),e+="</td>";e+="</td>\n"}return e+="</table>\n"},Projection.PROJ_TAN=1,Projection.PROJ_TAN2=2,Projection.PROJ_STG=2,Projection.PROJ_SIN=3,Projection.PROJ_SIN2=4,Projection.PROJ_ZEA=4,Projection.PROJ_ARC=5,Projection.PROJ_SCHMIDT=5,Projection.PROJ_AITOFF=6,Projection.PROJ_AIT=6,Projection.PROJ_GLS=7,Projection.PROJ_MERCATOR=8,Projection.PROJ_MER=8,Projection.PROJ_LAM=9,Projection.PROJ_LAMBERT=9,Projection.PROJ_TSC=10,Projection.PROJ_QSC=11,Projection.PROJ_LIST=["Mercator",Projection.PROJ_MERCATOR,"Gnomonic",Projection.PROJ_TAN,"Stereographic",Projection.PROJ_TAN2,"Orthographic",Projection.PROJ_SIN,"Zenithal",Projection.PROJ_ZEA,"Schmidt",Projection.PROJ_SCHMIDT,"Aitoff",Projection.PROJ_AITOFF,"Lambert",Projection.PROJ_LAMBERT],Projection.PROJ_NAME=["-","Gnomonic","Stereographic","Orthographic","Equal-area","Schmidt plates","Aitoff","Global sin","Mercator","Lambert"],Projection.prototype={setCenter:function(a,b){this.ROT=this.tr_oR(a,b)},setProjection:function(a){this.PROJECTION=a},project:function(a,b){var c=this.tr_ou(a,b),d=this.tr_uu(c,this.ROT),e=this.tr_up(this.PROJECTION,d);return null==e?null:{X:-e[0],Y:-e[1]}},unproject:function(a,b){a=-a,b=-b;var c=this.tr_pu(this.PROJECTION,a,b),d=this.tr_uu1(c,this.ROT),e=this.tr_uo(d);return{ra:e[0],dec:e[1]}},tr_up:function(a,b){var c,d,e,f,g,h=b[0],i=b[1],j=b[2];if(c=AstroMath.hypot(h,i),0==c&&0==j)return null;switch(a){default:e=null;break;case Projection.PROJ_AITOFF:d=Math.sqrt(c*(c+h)/2),f=Math.sqrt(2*c*(c-h)),d=Math.sqrt((1+d)/2),f/=d,g=j/d,0>i&&(f=-f),e=[f,g];break;case Projection.PROJ_GLS:g=Math.asin(j),f=0!=c?Math.atan2(i,h)*c:0,e=[f,g];break;case Projection.PROJ_MERCATOR:0!=c?(f=Math.atan2(i,h),g=AstroMath.atanh(j),e=[f,g]):e=null;break;case Projection.PROJ_TAN:h>0?(f=i/h,g=j/h,e=[f,g]):e=null;break;case Projection.PROJ_TAN2:d=(1+h)/2,d>0?(f=i/d,g=j/d,e=[f,g]):e=null;break;case Projection.PROJ_ARC:-1>=h?(f=Math.PI,g=0):(c=AstroMath.hypot(i,j),d=h>0?AstroMath.asinc(c):Math.acos(h)/c,f=i*d,g=j*d),e=[f,g];break;case Projection.PROJ_SIN:h>=0?(f=i,g=j,e=[f,g]):e=null;break;case Projection.PROJ_SIN2:d=Math.sqrt((1+h)/2),0!=d?(f=i/d,g=j/d):(f=2,g=0),e=[f,g];break;case Projection.PROJ_LAMBERT:g=j,f=0,0!=c&&(f=Math.atan2(i,h)),e=[f,g]}return e},tr_pu:function(a,b,c){var d,e,f,g,h;switch(a){default:return null;case Projection.PROJ_AITOFF:if(d=b*b/8+c*c/2,d>1)return null;f=1-d,e=Math.sqrt(1-d/2),g=b*e/2,h=c*e,d=AstroMath.hypot(f,g),0!=d&&(e=f,f=(e*e-g*g)/d,g=2*e*g/d);break;case Projection.PROJ_GLS:if(h=Math.sin(c),d=1-h*h,0>d)return null;d=Math.sqrt(d),e=0!=d?b/d:0,f=d*Math.cos(e),g=d*Math.sin(e);break;case Projection.PROJ_MERCATOR:h=AstroMath.tanh(c),d=1/AstroMath.cosh(c),f=d*Math.cos(b),g=d*Math.sin(b);break;case Projection.PROJ_LAMBERT:if(h=c,d=1-h*h,0>d)return null;d=Math.sqrt(d),f=d*Math.cos(b),g=d*Math.sin(b);break;case Projection.PROJ_TAN:f=1/Math.sqrt(1+b*b+c*c),g=b*f,h=c*f;break;case Projection.PROJ_TAN2:d=(b*b+c*c)/4,e=1+d,f=(1-d)/e,g=b/e,h=c/e;break;case Projection.PROJ_ARC:if(d=AstroMath.hypot(b,c),d>Math.PI)return null;e=AstroMath.sinc(d),f=Math.cos(d),g=e*b,h=e*c;break;case Projection.PROJ_SIN:if(e=1-b*b-c*c,0>e)return null;f=Math.sqrt(e),g=b,h=c;break;case Projection.PROJ_SIN2:if(d=(b*b+c*c)/4,d>1)return null;e=Math.sqrt(1-d),f=1-2*d,g=e*b,h=e*c}return[f,g,h]},tr_oR:function(a,b){var c=Array(3);return c[0]=Array(3),c[1]=Array(3),c[2]=Array(3),c[2][2]=AstroMath.cosd(b),c[0][2]=AstroMath.sind(b),c[1][1]=AstroMath.cosd(a),c[1][0]=-AstroMath.sind(a),c[1][2]=0,c[0][0]=c[2][2]*c[1][1],c[0][1]=-c[2][2]*c[1][0],c[2][0]=-c[0][2]*c[1][1],
c[2][1]=c[0][2]*c[1][0],c},tr_ou:function(a,b){var c=Array(3),d=AstroMath.cosd(b);return c[0]=d*AstroMath.cosd(a),c[1]=d*AstroMath.sind(a),c[2]=AstroMath.sind(b),c},tr_uu:function(a,b){var c=Array(3),d=a[0],e=a[1],f=a[2];return c[0]=b[0][0]*d+b[0][1]*e+b[0][2]*f,c[1]=b[1][0]*d+b[1][1]*e+b[1][2]*f,c[2]=b[2][0]*d+b[2][1]*e+b[2][2]*f,c},tr_uu1:function(a,b){var c=Array(3),d=a[0],e=a[1],f=a[2];return c[0]=b[0][0]*d+b[1][0]*e+b[2][0]*f,c[1]=b[0][1]*d+b[1][1]*e+b[2][1]*f,c[2]=b[0][2]*d+b[1][2]*e+b[2][2]*f,c},tr_uo:function(a){var b,c,d=a[0],e=a[1],f=a[2],g=d*d+e*e;if(0==g){if(0==f)return null;b=0,c=f>0?90:-90}else c=AstroMath.atand(f/Math.sqrt(g)),b=AstroMath.atan2d(e,d),0>b&&(b+=360);return[b,c]}},Coo.factor=[3600,60,1],Coo.prototype={setFrame:function(a){this.frame=a},computeDirCos:function(){var a=AstroMath.cosd(this.lat);this.x=a*AstroMath.cosd(this.lon),this.y=a*AstroMath.sind(this.lon),this.z=AstroMath.sind(this.lat)},computeLonLat:function(){var a=this.x*this.x+this.y*this.y;this.lon=0,0==a?0==this.z?(this.lon=NaN,this.lat=NaN):this.lat=this.z>0?90:-90:(this.lon=AstroMath.atan2d(this.y,this.x),this.lat=AstroMath.atan2d(this.z,Math.sqrt(a)),0>this.lon&&(this.lon+=360))},dist2:function(a){var b=a.x-this.x,c=b*b;return b=a.y-this.y,c+=b*b,b=a.z-this.z,c+=b*b},distance:function(a){return 0==a.x&&0==a.y&&0==a.z?NaN:0==this.x&&0==this.y&&0==this.z?NaN:2*AstroMath.asind(.5*Math.sqrt(this.dist2(a)))},convertTo:function(a){this.frame.equals(a)||(this.frame.toICRS(this.coo),a.fromICRS(this.coo),this.frame=a,this.lon=this.lat=NaN)},rotate:function(a){var b,c,d;a!=Umatrix3&&(b=a[0][0]*this.x+a[0][1]*this.y+a[0][2]*this.z,c=a[1][0]*this.x+a[1][1]*this.y+a[1][2]*this.z,d=a[2][0]*this.x+a[2][1]*this.y+a[2][2]*this.z,this.x=b,this.y=c,this.z=d,this.lon=this.lat=NaN)},rotate_1:function(a){var b,c,d;a!=Umatrix3&&(b=a[0][0]*this.x+a[1][0]*this.y+a[2][0]*this.z,c=a[0][1]*this.x+a[1][1]*this.y+a[2][1]*this.z,d=a[0][2]*this.x+a[1][2]*this.y+a[2][2]*this.z,this.x=b,this.y=c,this.z=d,this.lon=this.lat=NaN)},equals:function(a){return this.x==a.x&&this.y==a.y&&this.z==a.z},parse:function(a){var b=a.indexOf("+");if(0>b&&(b=a.indexOf("-")),0>b&&(b=a.indexOf(" ")),0>b)return this.lon=NaN,this.lat=NaN,this.prec=0,!1;var c=a.substring(0,b),d=a.substring(b);return this.lon=this.parseLon(c),this.lat=this.parseLat(d),!0},parseLon:function(a){var a=a.trim();if(a=a.replace(/:/g," "),0>a.indexOf(" ")){var b=a.indexOf(".");return this.prec=0>b?0:a.length-b-1,parseFloat(a)}for(var c=new Tokenizer(a," "),d=0,e=0,f=0;c.hasMore();){var g=c.nextToken(),h=g.indexOf(".");switch(e+=parseFloat(g)*Coo.factor[d],d){case 0:f=0>h?1:2;break;case 1:f=0>h?3:4;break;case 2:f=0>h?5:4+g.length-h}d++}return this.prec=f,15*e/3600},parseLat:function(a){var a=a.trim();a=a.replace(/:/g," ");var b;if("-"==a.charAt(0)?(b=-1,a=a.substring(1)):"-"==a.charAt(0)?(b=1,a=a.substring(1)):b=1,0>a.indexOf(" ")){var c=a.indexOf(".");return this.prec=0>c?0:a.length-c-1,parseFloat(a)*b}for(var d=new Tokenizer(a," "),e=0,f=0,g=0;d.hasMore();){var h=d.nextToken(),i=h.indexOf(".");switch(f+=parseFloat(h)*Coo.factor[e],e){case 0:g=0>i?1:2;break;case 1:g=0>i?3:4;break;case 2:g=0>i?5:4+h.length-i}e++}return this.prec=g,f*b/3600},format:function(a){isNaN(this.lon)&&this.computeLonLat();var b="",c="";if(a.indexOf("d")>=0)b=Numbers.format(this.lon,this.prec),c=Numbers.format(this.lat,this.prec);else var d=this.lon/15,b=Numbers.toSexagesimal(d,this.prec+1,!1),c=Numbers.toSexagesimal(this.lat,this.prec,!1);return this.lat>0&&(c="+"+c),a.indexOf("/")>=0?b+" "+c:a.indexOf("2")>=0?[b,c]:b+c}},Tokenizer.prototype={hasMore:function(){return this.pos<this.string.length},nextToken:function(){for(var a=this.pos;this.string.length>a&&this.string.charAt(a)==this.sep;)a++;for(var b=a;this.string.length>b&&this.string.charAt(b)!=this.sep;)b++;return this.pos=b,this.string.substring(a,b)}},Strings.trim=function(a,b){for(var c=0,d=a.length-1;a.length>c&&a.charAt(c)==b;)c++;if(c==a.length)return"";for(;d>c&&a.charAt(d)==b;)d--;return a.substring(c,d+1)},Numbers.pow10=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13,1e14],Numbers.rndval=[.5,.05,.005,5e-4,5e-5,5e-6,5e-7,5e-8,5e-9,5e-10,5e-11,5e-12,5e-13,5e-14,5e-14],Numbers.format=function(a,b){if(0>=b)return""+Math.round(a);var c=""+a,d=c.indexOf("."),e=d>=0?c.length-d-1:0;if(b>=e){0>d&&(c+=".");for(var f=0;b-e>f;f++)c+="0";return c}return c=""+(a+Numbers.rndval[b]),c.substr(0,d+b+1)},Numbers.toSexagesimal=function(a,b,c){var d=0>a?"-":c?"+":"",e=Math.abs(a);switch(b){case 1:var f=Math.round(e);return d+(""+f);case 2:return d+Numbers.format(e,1);case 3:var f=Math.floor(e),g=Math.round(60*(e-f));return d+f+" "+g;case 4:var f=Math.floor(e),g=60*(e-f);return d+f+" "+Numbers.format(g,1);case 5:var f=Math.floor(e),g=60*(e-f),h=Math.floor(g),i=Math.round(60*(g-h));return d+f+" "+h+" "+i;case 6:case 7:case 8:var f=Math.floor(e);10>f&&(f="0"+f);var g=60*(e-f),h=Math.floor(g);10>h&&(h="0"+h);var i=60*(g-h);return d+f+" "+h+" "+Numbers.format(i,b-5);default:return d+Numbers.format(e,1)}},CooConversion=function(){var a={};return a.GALACTIC_TO_J2000=[-.0548755604024359,.4941094279435681,-.867666148981161,-.8734370902479237,-.4448296299195045,-.1980763734646737,-.4838350155267381,.7469822444763707,.4559837762325372],a.J2000_TO_GALACTIC=[-.0548755604024359,-.873437090247923,-.4838350155267381,.4941094279435681,-.4448296299195045,.7469822444763707,-.867666148981161,-.1980763734646737,.4559837762325372],a.Transform=function(a,b){a[0]=a[0]*Math.PI/180,a[1]=a[1]*Math.PI/180;var c=[Math.cos(a[0])*Math.cos(a[1]),Math.sin(a[0])*Math.cos(a[1]),Math.sin(a[1])],d=[c[0]*b[0]+c[1]*b[1]+c[2]*b[2],c[0]*b[3]+c[1]*b[4]+c[2]*b[5],c[0]*b[6]+c[1]*b[7]+c[2]*b[8]],e=Math.sqrt(d[0]*d[0]+d[1]*d[1]+d[2]*d[2]),f=[0,0];f[1]=Math.asin(d[2]/e);var g=d[0]/e/Math.cos(f[1]),h=d[1]/e/Math.cos(f[1]);return f[0]=Math.atan2(h,g),0>f[0]&&(f[0]=f[0]+2*Math.PI),f[0]=180*f[0]/Math.PI,f[1]=180*f[1]/Math.PI,f},a.GalacticToJ2000=function(b){return a.Transform(b,a.GALACTIC_TO_J2000)},a.J2000ToGalactic=function(b){return a.Transform(b,a.J2000_TO_GALACTIC)},a}(),Sesame=function(){return Sesame={},Sesame.cache={},Sesame.getTargetRADec=function(a,b,c){if(b){var d=/[a-zA-Z]/.test(a);if(d)Sesame.resolve(a,function(a){b({ra:a.Target.Resolver.jradeg,dec:a.Target.Resolver.jdedeg})},function(){c&&c()});else{var e=new Coo;e.parse(a),b&&b({ra:e.lon,dec:e.lat})}}},Sesame.resolve=function(a,b,c){var d="http://cds.unistra.fr/cgi-bin/nph-sesame.jsonp?";$.ajax({url:d,data:{object:a},method:"GET",dataType:"jsonp",success:function(a){a.Target&&a.Target.Resolver&&a.Target.Resolver?b(a):c(a)},error:c})},Sesame}(),HealpixCache=function(){var a={};return a.staticCache={corners:{nside8:[]}},a.dynamicCache={},a.lastNside=8,a.hpxIdxCache=null,a.init=function(){var b=new HealpixIndex(8);b.init();for(var c=HealpixIndex.nside2Npix(8),d=0;c>d;d++)a.staticCache.corners.nside8[d]=b.corners_nest(d,1);a.hpxIdxCache=b},a.corners_nest=function(b,c){return 8==c?a.staticCache.corners.nside8[b]:(c!=a.lastNside&&(a.hpxIdxCache=new HealpixIndex(c),a.hpxIdxCache.init(),a.lastNside=c),a.hpxIdxCache.corners_nest(b,1))},a}(),Utils=Utils||{},Utils.cssScale=void 0,HTMLCanvasElement.prototype.relMouseCoords=relMouseCoords,Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=[].slice,c=b.call(arguments,1),d=this,e=function(){},f=function(){return d.apply(this instanceof e?this:a||{},c.concat(b.call(arguments)))};return f.prototype=this.prototype,f}),$=$||jQuery,$.urlParam=function(a,b){return void 0===b&&(b=location.search),decodeURIComponent((RegExp("[?|&]"+a+"=([^&;]+?)(&|#|;|$)").exec(b)||[,""])[1].replace(/\+/g,"%20"))||null},Utils.isNumber=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},Utils.isInt=function(a){return Utils.isNumber(a)&&Math.floor(a)==a},Utils.debounce=function(a,b){var c=null;return function(){var d=this,e=arguments;clearTimeout(c),c=setTimeout(function(){a.apply(d,e)},b)}},Utils.LRUCache=function(a){this._keys=[],this._items={},this._expires={},this._size=0,this._maxsize=a||1024},Utils.LRUCache.prototype={set:function(a,b){var c=this._keys,d=this._items,e=this._expires,f=this._size,g=this._maxsize;f>=g&&(c.sort(function(a,b){return e[a]>e[b]?-1:e[a]<e[b]?1:0}),f--,delete e[c[f]],delete d[c[f]]),c[f]=a,d[a]=b,e[a]=Date.now(),f++,this._keys=c,this._items=d,this._expires=e,this._size=f},get:function(a){var b=this._items[a];return b&&(this._expires[a]=Date.now()),b},keys:function(){return this._keys}},Utils.getAjaxObject=function(a,b,c,d){if(d!==!1&&(d=!0),d===!0)var e=Aladin.JSONP_PROXY+"?url="+encodeURIComponent(a);else e=a;return b=b||"GET",c=c||null,$.ajax({url:e,method:b,dataType:c})},URLBuilder=function(){return URLBuilder={buildSimbadCSURL:function(a,b){if(a&&"object"==typeof a&&"ra"in a&&"dec"in a){var c=new Coo(a.ra,a.dec,7);a=c.format("s")}return"http://alasky.unistra.fr/cgi/simbad-flat/simbad-cs.py?target="+encodeURIComponent(a)+"&SR="+b+"&format=votable&SRUNIT=deg&SORTBY=nbref"},buildNEDPositionCSURL:function(a,b,c){return"http://nedwww.ipac.caltech.edu/cgi-bin/nph-objsearch?search_type=Near+Position+Search&of=xml_main&RA="+a+"&DEC="+b+"&SR="+c},buildNEDObjectCSURL:function(a,b){return"http://ned.ipac.caltech.edu/cgi-bin/nph-objsearch?search_type=Near+Name+Search&radius="+60*b+"&of=xml_main&objname="+a},buildVizieRCSURL:function(a,b,c){if(b&&"object"==typeof b&&"ra"in b&&"dec"in b){var d=new Coo(b.ra,b.dec,7);b=d.format("s")}return"http://vizier.unistra.fr/viz-bin/votable?-source="+a+"&-c="+encodeURIComponent(b)+"&-out.max=999999&-c.rd="+c},buildSkyBotCSURL:function(a,b,c,d,e){var f="http://vo.imcce.fr/webservices/skybot/skybotconesearch_query.php?-from=AladinLite";if(f+="&RA="+encodeURIComponent(a),f+="&DEC="+encodeURIComponent(b),f+="&SR="+encodeURIComponent(c),f+="&EPOCH="+encodeURIComponent(d),e)for(var g in e)e.hasOwnProperty(g)&&(f+="&"+g+"="+encodeURIComponent(e[g]));return f}}}(),MeasurementTable=function(){return MeasurementTable=function(a){this.isShowing=!1,this.divEl=$('<div class="aladin-measurement-div"></div>'),$(a).append(this.divEl)},MeasurementTable.prototype.showMeasurement=function(a){this.divEl.empty();var b="<thead><tr>",c="<tr>";for(key in a.data)b+="<th>"+key+"</th>",c+="<td>"+a.data[key]+"</td>";b+="</tr></thead>",c+="</tr>",this.divEl.append("<table>"+b+c+"</table>"),this.show()},MeasurementTable.prototype.show=function(){this.divEl.show()},MeasurementTable.prototype.hide=function(){this.divEl.hide()},MeasurementTable}(),Color=function(){return Color={},Color.curIdx=0,Color.colors=["#ff0000","#0000ff","#99cc00","#ffff00","#000066","#00ffff","#9900cc","#0099cc","#cc9900","#cc0099","#00cc99","#663333","#ffcc9a","#ff9acc","#ccff33","#660000","#ffcc33","#ff00ff","#00ff00","#ffffff"],Color.getNextColor=function(){var a=Color.colors[Color.curIdx%Color.colors.length];return Color.curIdx++,a},Color.getLabelColorForBackground=function(a){var c="#eee",d="#111";if(rgb=a.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),null==rgb)return d;r=parseInt(rgb[1]),g=parseInt(rgb[2]),b=parseInt(rgb[3]);var e=1-(.299*r+.587*g+.114*b)/255;return.5>e?d:c},Color}(),AladinUtils=function(){return{xyToView:function(a,b,c,d,e,f,g){return void 0==g&&(g=!0),g?{vx:AladinUtils.myRound(e/2*(1+f*a)-(e-c)/2),vy:AladinUtils.myRound(e/2*(1+f*b)-(e-d)/2)}:{vx:e/2*(1+f*a)-(e-c)/2,vy:e/2*(1+f*b)-(e-d)/2}},viewToXy:function(a,b,c,d,e,f){return{x:((2*a+(e-c))/e-1)/f,y:((2*b+(e-d))/e-1)/f}},radecToViewXy:function(a,b,c,d,e,f,g,h){var i;if(d!=CooFrameEnum.J2000){var j=CooConversion.J2000ToGalactic([a,b]);i=c.project(j[0],j[1])}else i=c.project(a,b);return i?AladinUtils.xyToView(i.X,i.Y,e,f,g,h,!1):null},myRound:function(a){return 0>a?-1*(0|-a):0|a},isHpxPixVisible:function(a,b,c){for(var d=0;a.length>d;d++)if(a[d].vx>=-20&&b+20>a[d].vx&&a[d].vy>=-20&&c+20>a[d].vy)return!0;return!1},ipixToIpix:function(a,b,c){},getZoomFactorForAngle:function(a,b){var c={ra:0,dec:0},d={ra:a,dec:0},e=new Projection(a/2,0);e.setProjection(b);var f=e.project(c.ra,c.dec),g=e.project(d.ra,d.dec),h=1/(f.X-g.Y);return h},grow2:function(a,b){for(var c=0,d=0;4>d;d++)null==a[d]&&c++;if(c>1)return a;for(var e=[],d=0;4>d;d++)e.push({vx:a[d].vx,vy:a[d].vy});for(var d=0;2>d;d++){var f=1==d?1:0,g=1==d?3:2;if(null==e[f]){var h,i;0==f||3==f?(h=1,i=2):(h=0,i=3),e[f]={vx:(e[h].vx+e[i].vx)/2,vy:(e[h].vy+e[i].vy)/2}}if(null==e[g]){var h,i;0==g||3==g?(h=1,i=2):(h=0,i=3),e[g]={vx:(e[h].vx+e[i].vx)/2,vy:(e[h].vy+e[i].vy)/2}}if(null!=e[f]&&null!=e[g]){var j=Math.atan2(e[g].vy-e[f].vy,e[g].vx-e[f].vx),k=b*Math.cos(j);e[f].vx-=k,e[g].vx+=k,k=b*Math.sin(j),e[f].vy-=k,e[g].vy+=k}}return e}}}(),ProjectionEnum={SIN:Projection.PROJ_SIN,AITOFF:Projection.PROJ_AITOFF},CooFrameEnum=function(){return{J2000:"J2000",GAL:"Galactic"}}(),CooFrameEnum.fromString=function(a,b){return a?(a=a.toLowerCase().replace(/^\s+|\s+$/g,""),0==a.indexOf("j2000")||0==a.indexOf("icrs")?CooFrameEnum.J2000:0==a.indexOf("gal")?CooFrameEnum.GAL:b?b:null):b?b:null},CooFrameEnum.shortName=function(a){return a==CooFrameEnum.J2000?"J2000":a==CooFrameEnum.GAL?"GAL":null},Downloader=function(){var a=4,b=!1,c=700,d=function(a){this.view=a,this.nbDownloads=0,this.dlQueue=[],this.urlsInQueue={}};return d.prototype.requestDownload=function(a,b,c){b in this.urlsInQueue||(this.dlQueue.push({img:a,url:b,cors:c}),this.urlsInQueue[b]=1,this.tryDownload())},d.prototype.tryDownload=function(){for(;this.dlQueue.length>0&&a>this.nbDownloads;)this.startDownloadNext()},d.prototype.startDownloadNext=function(){var a=this.dlQueue.shift();if(a){this.nbDownloads++;var b=this;a.img.onload=function(){b.completeDownload(this,!0)},a.img.onerror=function(){b.completeDownload(this,!1)},a.cors?a.img.crossOrigin="anonymous":void 0!==a.img.crossOrigin&&delete a.img.crossOrigin,a.img.src=a.url}},d.prototype.completeDownload=function(a,d){if(delete this.urlsInQueue[a.src],a.onerror=null,a.onload=null,this.nbDownloads--,d){if(b){var e=(new Date).getTime();a.fadingStart=e,a.fadingEnd=e+c}this.view.requestRedraw()}else a.dlError=!0;this.tryDownload()},d}(),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q={}.hasOwnProperty,r=function(a,b){function c(){this.constructor=a}for(var d in b)q.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},s=[].slice;null==this.astro&&(this.astro={}),a=function(){function a(){}return a.include=function(a){var b,c;for(b in a)c=a[b],this.prototype[b]=c;return this},a.extend=function(a){var b,c;for(b in a)c=a[b],this[b]=c;return this},a.prototype.proxy=function(a){var b=this;return function(){return a.apply(b,arguments)}},a.prototype.invoke=function(a,b,c){var d;return d=null!=(null!=b?b.context:void 0)?b.context:this,null!=a?a.call(d,c,b):void 0},a}(),l=function(a){function b(a,b,c){var d,e=this;this.arg=a,this.callback=b,this.opts=c,this.hdus=[],this.blockCount=0,this.begin=0,this.end=this.BLOCKLENGTH,this.offset=0,this.headerStorage=new Uint8Array,"string"==typeof this.arg?(this.readNextBlock=this._readBlockFromBuffer,d=new XMLHttpRequest,d.open("GET",this.arg),d.responseType="arraybuffer",d.onload=function(){return 200!==d.status?void e.invoke(e.callback,e.opts):(e.arg=d.response,e.length=e.arg.byteLength,e.readFromBuffer())},d.send()):(this.length=this.arg.size,this.readNextBlock=this._readBlockFromFile,this.readFromFile())}return r(b,a),b.prototype.LINEWIDTH=80,b.prototype.BLOCKLENGTH=2880,File.prototype.slice=File.prototype.slice||File.prototype.webkitSlice,Blob.prototype.slice=Blob.prototype.slice||Blob.prototype.webkitSlice,b.prototype.readFromBuffer=function(){var a;return a=this.arg.slice(this.begin+this.offset,this.end+this.offset),this.readBlock(a)},b.prototype.readFromFile=function(){var a,b=this;return this.reader=new FileReader,this.reader.onloadend=function(a){return b.readBlock(a.target.result)},a=this.arg.slice(this.begin+this.offset,this.end+this.offset),this.reader.readAsArrayBuffer(a)},b.prototype.readBlock=function(a){var b,c,d,e,f,i,j,k,l,m,n,o,p;for(b=new Uint8Array(a),l=new Uint8Array(this.headerStorage),this.headerStorage=new Uint8Array(this.end),this.headerStorage.set(l,0),this.headerStorage.set(b,this.begin),i=this.BLOCKLENGTH/this.LINEWIDTH;i--;)if(f=i*this.LINEWIDTH,32!==b[f]){if(69===b[f]&&78===b[f+1]&&68===b[f+2]&&32===b[f+3]){for(j="",p=this.headerStorage,n=0,o=p.length;o>n;n++)m=p[n],j+=String.fromCharCode(m);return e=new h(j),this.start=this.end+this.offset,c=e.getDataLength(),k=this.arg.slice(this.start,this.start+c),e.hasDataUnit()&&(d=this.createDataUnit(e,k)),this.hdus.push(new g(e,d)),this.offset+=this.end+c+this.excessBytes(c),this.offset===this.length?(this.headerStorage=null,void this.invoke(this.callback,this.opts,this)):(this.blockCount=0,this.begin=this.blockCount*this.BLOCKLENGTH,this.end=this.begin+this.BLOCKLENGTH,this.headerStorage=new Uint8Array,a=this.arg.slice(this.begin+this.offset,this.end+this.offset),void this.readNextBlock(a))}break}this.blockCount+=1,this.begin=this.blockCount*this.BLOCKLENGTH,this.end=this.begin+this.BLOCKLENGTH,a=this.arg.slice(this.begin+this.offset,this.end+this.offset),this.readNextBlock(a)},b.prototype._readBlockFromBuffer=function(a){return this.readBlock(a)},b.prototype._readBlockFromFile=function(a){return this.reader.readAsArrayBuffer(a)},b.prototype.createDataUnit=function(a,b){var c;return c=a.getDataType(),new astro.FITS[c](a,b)},b.prototype.excessBytes=function(a){return(this.BLOCKLENGTH-a%this.BLOCKLENGTH)%this.BLOCKLENGTH},b.prototype.isEOF=function(){return this.offset===this.length},b}(a),f=function(a){function b(a,b,c){var d,e=this;this.arg=a,d=new l(this.arg,function(){return e.hdus=d.hdus,e.invoke(b,c,e)})}return r(b,a),b.prototype.getHDU=function(a){var b,c,d,e;if(null!=a&&null!=this.hdus[a])return this.hdus[a];for(e=this.hdus,c=0,d=e.length;d>c;c++)if(b=e[c],b.hasData())return b},b.prototype.getHeader=function(a){return this.getHDU(a).header},b.prototype.getDataUnit=function(a){return this.getHDU(a).data},b}(a),f.version="0.6.5",this.astro.FITS=f,d=function(a){function b(a,b){b instanceof ArrayBuffer?this.buffer=b:this.blob=b}return r(b,a),b.swapEndian={B:function(a){return a},I:function(a){return a<<8|a>>8},J:function(a){return(255&a)<<24|(65280&a)<<8|65280&a>>8|255&a>>24}},b.swapEndian[8]=b.swapEndian.B,b.swapEndian[16]=b.swapEndian.I,b.swapEndian[32]=b.swapEndian.J,b}(a),this.astro.FITS.DataUnit=d,i={verifyOrder:function(a,b){return b!==this.cardIndex,void 0},verifyBetween:function(a,b,c,d){if(!(b>=c&&d>=b))throw"The "+a+" value of "+b+" is not between "+c+" and "+d},verifyBoolean:function(a){return"T"===a},VerifyFns:{SIMPLE:function(){var a,b;return a=arguments.length>=1?s.call(arguments,0):[],b=arguments[0],this.primary=!0,this.verifyOrder("SIMPLE",0),this.verifyBoolean(b)},XTENSION:function(){var a;return a=arguments.length>=1?s.call(arguments,0):[],this.extension=!0,this.extensionType=arguments[0],this.verifyOrder("XTENSION",0),this.extensionType},BITPIX:function(){var a,b,c;if(a=arguments.length>=1?s.call(arguments,0):[],b="BITPIX",c=parseInt(arguments[0]),this.verifyOrder(b,1),8!==c&&16!==c&&32!==c&&-32!==c&&-64!==c)throw""+b+" value "+c+" is not permitted";return c},NAXIS:function(){var a,b,c,d,e,f;if(a=arguments.length>=1?s.call(arguments,0):[],c="NAXIS",e=parseInt(arguments[0]),b=arguments[1],!b&&(this.verifyOrder(c,2),this.verifyBetween(c,e,0,999),this.isExtension()&&("TABLE"===(f=this.extensionType)||"BINTABLE"===f)&&(d=2,e!==d)))throw""+c+" must be "+d+" for TABLE and BINTABLE extensions";return e},PCOUNT:function(){var a,b,c,d,e,f;if(a=arguments.length>=1?s.call(arguments,0):[],b="PCOUNT",e=parseInt(arguments[0]),c=3+this.get("NAXIS"),this.verifyOrder(b,c),this.isExtension()&&("IMAGE"===(f=this.extensionType)||"TABLE"===f)&&(d=0,e!==d))throw""+b+" must be "+d+" for the "+this.extensionType+" extensions";return e},GCOUNT:function(){var a,b,c,d,e,f;if(a=arguments.length>=1?s.call(arguments,0):[],b="GCOUNT",e=parseInt(arguments[0]),c=3+this.get("NAXIS")+1,this.verifyOrder(b,c),this.isExtension()&&("IMAGE"===(f=this.extensionType)||"TABLE"===f||"BINTABLE"===f)&&(d=1,e!==d))throw""+b+" must be "+d+" for the "+this.extensionType+" extensions";return e},EXTEND:function(){var a,b;if(a=arguments.length>=1?s.call(arguments,0):[],b=arguments[0],!this.isPrimary())throw"EXTEND must only appear in the primary header";return this.verifyBoolean(b)},BSCALE:function(){var a;return a=arguments.length>=1?s.call(arguments,0):[],parseFloat(arguments[0])},BZERO:function(){var a;return a=arguments.length>=1?s.call(arguments,0):[],parseFloat(arguments[0])},BLANK:function(){var a,b;return a=arguments.length>=1?s.call(arguments,0):[],b=arguments[0],this.get("BITPIX")>0||void 0,parseInt(b)},DATAMIN:function(){var a;return a=arguments.length>=1?s.call(arguments,0):[],parseFloat(arguments[0])},DATAMAX:function(){var a;return a=arguments.length>=1?s.call(arguments,0):[],parseFloat(arguments[0])},EXTVER:function(){var a;return a=arguments.length>=1?s.call(arguments,0):[],parseInt(arguments[0])},EXTLEVEL:function(){var a;return a=arguments.length>=1?s.call(arguments,0):[],parseInt(arguments[0])},TFIELDS:function(){var a,b;return a=arguments.length>=1?s.call(arguments,0):[],b=parseInt(arguments[0]),this.verifyBetween("TFIELDS",b,0,999),b},TBCOL:function(){var a,b,c;return a=arguments.length>=1?s.call(arguments,0):[],c=arguments[0],b=arguments[2],this.verifyBetween("TBCOL",b,0,this.get("TFIELDS")),c},ZIMAGE:function(){var a;return a=arguments.length>=1?s.call(arguments,0):[],this.verifyBoolean(arguments[0])},ZCMPTYPE:function(){var a,b;if(a=arguments.length>=1?s.call(arguments,0):[],b=arguments[0],"GZIP_1"!==b&&"RICE_1"!==b&&"PLIO_1"!==b&&"HCOMPRESS_1"!==b)throw"ZCMPTYPE value "+b+" is not permitted";if("RICE_1"!==b)throw"Compress type "+b+" is not yet implement";return b},ZBITPIX:function(){var a,b;if(a=arguments.length>=1?s.call(arguments,0):[],b=parseInt(arguments[0]),8!==b&&16!==b&&32!==b&&64!==b&&-32!==b&&-64!==b)throw"ZBITPIX value "+b+" is not permitted";return b},ZNAXIS:function(){var a,b,c;return a=arguments.length>=1?s.call(arguments,0):[],c=parseInt(arguments[0]),b=arguments[1],c=c,b||this.verifyBetween("ZNAXIS",c,0,999),c},ZTILE:function(){var a;return a=arguments.length>=1?s.call(arguments,0):[],parseInt(arguments[0])},ZSIMPLE:function(){var a;return a=arguments.length>=1?s.call(arguments,0):[],"T"===arguments[0]},ZPCOUNT:function(){var a;return a=arguments.length>=1?s.call(arguments,0):[],parseInt(arguments[0])},ZGCOUNT:function(){var a;return a=arguments.length>=1?s.call(arguments,0):[],parseInt(arguments[0])},ZDITHER0:function(){var a;return a=arguments.length>=1?s.call(arguments,0):[],parseInt(arguments[0])}}},this.astro.FITS.HeaderVerify=i,h=function(a){function b(a){var b,c,d;this.primary=!1,this.extension=!1,this.verifyCard={},d=this.VerifyFns;for(c in d)b=d[c],this.verifyCard[c]=this.proxy(b);this.cards={},this.cards.COMMENT=[],this.cards.HISTORY=[],this.cardIndex=0,this.block=a,this.readBlock(a)}return r(b,a),b.include(i),b.prototype.arrayPattern=/(\D+)(\d+)/,b.prototype.maxLines=600,b.prototype.get=function(a){return this.contains(a)?this.cards[a].value:null},b.prototype.set=function(a,b,c){return c=c||"",this.cards[a]={index:this.cardIndex,value:b,comment:c},this.cardIndex+=1},b.prototype.contains=function(a){return this.cards.hasOwnProperty(a)},b.prototype.readLine=function(a){var b,c,d,e,f,g,h;return f=a.slice(0,8).trim(),(b=""===f)?void 0:(e=a.slice(8,10),g=a.slice(10),"= "!==e?void(("COMMENT"===f||"HISTORY"===f)&&this.cards[f].push(g.trim())):(h=g.split(" /"),g=h[0],c=h[1],g=g.trim(),d=g[0],"'"===d?g=g.slice(1,-1).trim():"T"!==g&&"F"!==g&&(g=parseFloat(g)),g=this.validate(f,g),this.set(f,g,c)))},b.prototype.validate=function(a,b){var c,d,e,f,g;return d=null,c=a,e=this.arrayPattern.test(a),e&&(f=this.arrayPattern.exec(a),g=f.slice(1),c=g[0],d=g[1]),c in this.verifyCard&&(b=this.verifyCard[c](b,e,d)),b},b.prototype.readBlock=function(a){var b,c,d,e,f,g,h;for(d=80,e=a.length/d,e=this.maxLines>e?e:this.maxLines,h=[],b=f=0,g=e-1;g>=0?g>=f:f>=g;b=g>=0?++f:--f)c=a.slice(b*d,(b+1)*d),h.push(this.readLine(c));return h},b.prototype.hasDataUnit=function(){return 0!==this.get("NAXIS")},b.prototype.getDataLength=function(){var a,b,c,d,e;if(!this.hasDataUnit())return 0;for(c=[],a=d=1,e=this.get("NAXIS");e>=1?e>=d:d>=e;a=e>=1?++d:--d)c.push(this.get("NAXIS"+a));return b=c.reduce(function(a,b){return a*b})*Math.abs(this.get("BITPIX"))/8,b+=this.get("PCOUNT")},b.prototype.getDataType=function(){switch(this.extensionType){case"BINTABLE":return this.contains("ZIMAGE")?"CompressedImage":"BinaryTable";case"TABLE":return"Table";default:return this.hasDataUnit()?"Image":null}},b.prototype.isPrimary=function(){return this.primary},b.prototype.isExtension=function(){return this.extension},b}(a),this.astro.FITS.Header=h,k={getExtent:function(a){var b,c,d,e;for(b=a.length;b--;)if(e=a[b],!isNaN(e)){d=c=e;break}if(-1===b)return[NaN,NaN];for(;b--;)e=a[b],isNaN(e)||(d>e&&(d=e),e>c&&(c=e));return[d,c]},getPixel:function(a,b,c){return a[c*this.width+b]}},this.astro.FITS.ImageUtils=k,j=function(a){function b(a){var c,d,e,f,g,h,i;for(b.__super__.constructor.apply(this,arguments),f=a.get("NAXIS"),this.bitpix=a.get("BITPIX"),this.naxis=[],e=g=1;f>=1?f>=g:g>=f;e=f>=1?++g:--g)this.naxis.push(a.get("NAXIS"+e));for(this.width=a.get("NAXIS1"),this.height=a.get("NAXIS2")||1,this.depth=a.get("NAXIS3")||1,this.bzero=a.get("BZERO")||0,this.bscale=a.get("BSCALE")||1,this.bytes=Math.abs(this.bitpix)/8,this.length=this.naxis.reduce(function(a,b){return a*b})*Math.abs(this.bitpix)/8,this.frame=0,this.frameOffsets=[],this.frameLength=this.bytes*this.width*this.height,this.nBuffers=null!=this.buffer?1:2,e=h=0,i=this.depth-1;i>=0?i>=h:h>=i;e=i>=0?++h:--h)c=e*this.frameLength,d={begin:c},null!=this.buffer&&(d.buffers=[this.buffer.slice(c,c+this.frameLength)]),this.frameOffsets.push(d)}return r(b,a),b.include(k),b.prototype.allocationSize=16777216,b.prototype._getFrame=function(a,b,c,d){var e,f,g,h,i,j,k,l;if(f=Math.abs(b)/8,i=h=a.byteLength/f,g=Math.abs(b),b>0){switch(b){case 8:k=new Uint8Array(a),k=new Uint16Array(k),j=function(a){return a};break;case 16:k=new Int16Array(a),j=function(a){return(255&a)<<8|255&a>>8};break;case 32:k=new Int32Array(a),j=function(a){return(255&a)<<24|(65280&a)<<8|65280&a>>8|255&a>>24}}for(e=parseInt(c)!==c||parseInt(d)!==d?new Float32Array(k.length):k;i--;)k[i]=j(k[i]),e[i]=c+d*k[i]}else{for(e=new Uint32Array(a),j=function(a){return(255&a)<<24|(65280&a)<<8|65280&a>>8|255&a>>24};h--;)l=e[h],e[h]=j(l);for(e=new Float32Array(a);i--;)e[i]=c+d*e[i]}return e},b.prototype._getFrameAsync=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this;l=function(a){var b,c,d,e,f,g,h;return g=a.data,e=g.buffer,c=g.bitpix,f=g.bzero,d=g.bscale,h=g.url,importScripts(h),b=_getFrame(e,c,f,d),postMessage(b)},g=(""+l).replace("return postMessage","postMessage"),g="onmessage = "+g,h=""+this._getFrame,h=h.replace("function","function _getFrame"),j="application/javascript",f=new Blob([g],{type:j}),e=new Blob([h],{type:j}),d=window.URL||window.webkitURL,p=d.createObjectURL(f),o=d.createObjectURL(e),q=new Worker(p),k={buffer:a[0],bitpix:this.bitpix,bzero:this.bzero,bscale:this.bscale,url:o},i=0,m=null,n=0,q.onmessage=function(e){var f;return f=e.data,null==m&&(m=new f.constructor(r.width*r.height)),m.set(f,n),n+=f.length,i+=1,i===r.nBuffers?(r.invoke(b,c,m),d.revokeObjectURL(p),d.revokeObjectURL(o),q.terminate()):(k.buffer=a[i],q.postMessage(k,[a[i]]))},q.postMessage(k,[a[0]])},b.prototype.getFrame=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p=this;if(this.frame=a||this.frame,i=this.frameOffsets[this.frame],g=i.buffers,(null!=g?g.length:void 0)===this.nBuffers)return this._getFrameAsync(g,b,c);for(this.frameOffsets[this.frame].buffers=[],d=i.begin,e=this.blob.slice(d,d+this.frameLength),f=[],k=Math.floor(this.height/this.nBuffers),h=k*this.bytes*this.width,j=n=0,o=this.nBuffers-1;o>=0?o>=n:n>=o;j=o>=0?++n:--n)m=j*h,j===this.nBuffers-1?f.push(e.slice(m)):f.push(e.slice(m,m+h));return g=[],l=new FileReader,l.frame=this.frame,j=0,l.onloadend=function(d){var e;return a=d.target.frame,e=d.target.result,p.frameOffsets[a].buffers.push(e),j+=1,j===p.nBuffers?p.getFrame(a,b,c):l.readAsArrayBuffer(f[j])},l.readAsArrayBuffer(f[0])},b.prototype.getFrames=function(a,b,c,d){var e,f=this;return e=function(d,g){return f.invoke(c,g,d),b-=1,a+=1,b?f.getFrame(a,e,g):void 0},this.getFrame(a,e,d)},b.prototype.isDataCube=function(){return this.naxis.length>2},b}(d),this.astro.FITS.Image=j,n=function(a){function b(a){b.__super__.constructor.apply(this,arguments),this.rowByteSize=a.get("NAXIS1"),this.rows=a.get("NAXIS2"),this.cols=a.get("TFIELDS"),this.length=this.rowByteSize*this.rows,this.heapLength=a.get("PCOUNT"),this.columns=this.getColumns(a),null!=this.buffer?(this.rowsInMemory=this._rowsInMemoryBuffer,this.heap=this.buffer.slice(this.length,this.length+this.heapLength)):(this.rowsInMemory=this._rowsInMemoryBlob,this.firstRowInBuffer=this.lastRowInBuffer=0,this.nRowsInBuffer=Math.floor(this.maxMemory/this.rowByteSize)),this.accessors=[],this.descriptors=[],this.elementByteLengths=[],this.setAccessors(a)}return r(b,a),b.prototype.maxMemory=1048576,b.prototype._rowsInMemoryBuffer=function(){return!0},b.prototype._rowsInMemoryBlob=function(a,b){return!(this.firstRowInBuffer>a)&&!(b>this.lastRowInBuffer)},b.prototype.getColumns=function(a){var b,c,d,e,f;for(b=[],c=e=1,f=this.cols;f>=1?f>=e:e>=f;c=f>=1?++e:--e){if(d="TTYPE"+c,!a.contains(d))return null;b.push(a.get(d))}return b},b.prototype.getColumn=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o=this;return null!=this.blob?(l=this.columns.indexOf(a),g=this.descriptors[l],d=this.accessors[l],h=this.elementByteLengths[l],i=this.elementByteLengths.slice(0,l),i=0===i.length?0:i.reduce(function(a,b){return a+b}),f=null!=this.typedArray[g]?new this.typedArray[g](this.rows):[],n=~~(this.maxMemory/this.rowByteSize),n=Math.min(n,this.rows),j=this.rows/n,m=Math.floor(j)===j?j:Math.floor(j)+1,k=0,l=0,e=function(a,c){var g,h,j,p;for(g=a.byteLength/o.rowByteSize,p=new DataView(a),h=i;g--;)f[k]=d(p,h)[0],k+=1,h+=o.rowByteSize;return m-=1,l+=1,m?(j=l*n,o.getTableBuffer(j,n,e,c)):void o.invoke(b,c,f)},this.getTableBuffer(0,n,e,c)):(e=function(c,d){return f=c.map(function(b){return b[a]}),o.invoke(b,d,f)},this.getRows(0,this.rows,e,c))},b.prototype.getTableBuffer=function(a,b,c,d){var e,f,g,h,i=this;return b=Math.min(this.rows-a,b),e=a*this.rowByteSize,g=e+b*this.rowByteSize,f=this.blob.slice(e,g),h=new FileReader,h.row=a,h.number=b,h.onloadend=function(a){return i.invoke(c,d,a.target.result)},h.readAsArrayBuffer(f)},b.prototype.getRows=function(a,b,c,d){var e,f,g,h,i,j,k=this;return this.rowsInMemory(a,a+b)?(null!=this.blob?g=this.buffer:(e=a*this.rowByteSize,h=e+b*this.rowByteSize,g=this.buffer.slice(e,h)),j=this._getRows(g,b),this.invoke(c,d,j),j):(e=a*this.rowByteSize,h=e+Math.max(this.nRowsInBuffer*this.rowByteSize,b*this.rowByteSize),f=this.blob.slice(e,h),i=new FileReader,i.row=a,i.number=b,i.onloadend=function(e){var f;return f=e.target,k.buffer=f.result,k.firstRowInBuffer=k.lastRowInBuffer=f.row,k.lastRowInBuffer+=f.number,k.getRows(a,b,c,d)},i.readAsArrayBuffer(f))},b}(d),this.astro.FITS.Tabular=n,m=function(a){function b(){return o=b.__super__.constructor.apply(this,arguments)}return r(b,a),b.prototype.dataAccessors={A:function(a){return a.trim()},I:function(a){return parseInt(a)},F:function(a){return parseFloat(a)},E:function(a){return parseFloat(a)},D:function(a){return parseFloat(a)}},b.prototype.setAccessors=function(a){var b,c,d,e,f,g,h,i,j,k=this;for(f=/([AIFED])(\d+)\.*(\d+)*/,j=[],d=h=1,i=this.cols;i>=1?i>=h:h>=i;d=i>=1?++h:--h)c=a.get("TFORM"+d),g=a.get("TTYPE"+d),e=f.exec(c),b=e[1],j.push(function(a){var b;return b=function(b){return k.dataAccessors[a](b)},k.accessors.push(b)}(b));return j},b.prototype._getRows=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;for(i=a.byteLength/this.rowByteSize,c=new Uint8Array(a),k=[],f=n=0,s=i-1;s>=0?s>=n:n>=s;f=s>=0?++n:--n){
for(d=f*this.rowByteSize,e=d+this.rowByteSize,l=c.subarray(d,e),h="",o=0,q=l.length;q>o;o++)m=l[o],h+=String.fromCharCode(m);for(h=h.trim().split(/\s+/),j={},t=this.accessors,g=p=0,r=t.length;r>p;g=++p)b=t[g],m=h[g],j[this.columns[g]]=b(m);k.push(j)}return k},b}(n),this.astro.FITS.Table=m,b=function(a){function b(){return p=b.__super__.constructor.apply(this,arguments)}return r(b,a),b.prototype.typedArray={B:Uint8Array,I:Uint16Array,J:Uint32Array,E:Float32Array,D:Float64Array,1:Uint8Array,2:Uint16Array,4:Uint32Array},b.offsets={L:1,B:1,I:2,J:4,K:8,A:1,E:4,D:8,C:8,M:16},b.prototype.dataAccessors={L:function(a,b){var c,d;return d=a.getInt8(b),b+=1,c=84===d,[c,b]},B:function(a,b){var c;return c=a.getUint8(b),b+=1,[c,b]},I:function(a,b){var c;return c=a.getInt16(b),b+=2,[c,b]},J:function(a,b){var c;return c=a.getInt32(b),b+=4,[c,b]},K:function(a,b){var c,d,e,f,g;return d=Math.abs(a.getInt32(b)),b+=4,e=Math.abs(a.getInt32(b)),b+=4,f=d%10,c=f?-1:1,d-=f,g=c*(d<<32|e),[g,b]},A:function(a,b){var c;return c=a.getUint8(b),c=String.fromCharCode(c),b+=1,[c,b]},E:function(a,b){var c;return c=a.getFloat32(b),b+=4,[c,b]},D:function(a,b){var c;return c=a.getFloat64(b),b+=8,[c,b]},C:function(a,b){var c,d,e;return d=a.getFloat32(b),b+=4,e=a.getFloat32(b),b+=4,c=[d,e],[c,b]},M:function(a,b){var c,d,e;return d=a.getFloat64(b),b+=8,e=a.getFloat64(b),b+=8,c=[d,e],[c,b]}},b.prototype.toBits=function(a){var b,c;for(b=[],c=128;c>=1;)b.push(a&c?1:0),c/=2;return b},b.prototype.getFromHeap=function(a,b,c){var d,e,f,g,h;for(h=a.getInt32(b),b+=4,e=a.getInt32(b),b+=4,f=this.heap.slice(e,e+h),d=new this.typedArray[c](f),g=d.length;g--;)d[g]=this.constructor.swapEndian[c](d[g]);return[d,b]},b.prototype.setAccessors=function(a){var b,c,d,f,g,h,i,j,k,l,m,n=this;for(i=/(\d*)([P|Q]*)([L|X|B|I|J|K|A|E|D|C|M]{1})/,m=[],f=k=1,l=this.cols;l>=1?l>=k:k>=l;f=l>=1?++k:--k)d=a.get("TFORM"+f),j=a.get("TTYPE"+f),h=i.exec(d),b=parseInt(h[1])||1,g=h[2],c=h[3],m.push(function(a,b){var c,d;if(n.descriptors.push(a),n.elementByteLengths.push(n.constructor.offsets[a]*b),g)switch(j){case"COMPRESSED_DATA":c=function(b,c){var d,f,g;return g=n.getFromHeap(b,c,a),d=g[0],c=g[1],f=new n.typedArray[n.algorithmParameters.BYTEPIX](n.ztile[0]),e.Rice(d,n.algorithmParameters.BLOCKSIZE,n.algorithmParameters.BYTEPIX,f,n.ztile[0],e.RiceSetup),[f,c]};break;case"GZIP_COMPRESSED_DATA":c=function(a,b){var c;for(c=new Float32Array(n.width),f=c.length;f--;)c[f]=NaN;return[c,b]};break;default:c=function(b,c){return n.getFromHeap(b,c,a)}}else 1===b?c=function(b,c){var d,e;return e=n.dataAccessors[a](b,c),d=e[0],c=e[1],[d,c]}:"X"===a?(d=Math.log(b)/Math.log(2),c=function(a,c){var e,f,g,h,i,j,k;for(g=a.buffer.slice(c,c+d),i=new Uint8Array(g),f=[],j=0,k=i.length;k>j;j++)h=i[j],e=n.toBits(h),f=f.concat(e);return c+=d,[f.slice(0,+(b-1)+1||9e9),c]}):c="A"===a?function(a,c){var d,e,f,g,h,i;for(e=a.buffer.slice(c,c+b),d=new Uint8Array(e),f="",h=0,i=d.length;i>h;h++)g=d[h],f+=String.fromCharCode(g);return f=f.trim(),c+=b,[f,c]}:function(c,d){var e,g,h;for(f=b,e=[];f--;)h=n.dataAccessors[a](c,d),g=h[0],d=h[1],e.push(g);return[e,d]};return n.accessors.push(c)}(c,b));return m},b.prototype._getRows=function(a,b){var c,d,e,f,g,h,i,j,k,l,m;for(i=new DataView(a),e=0,g=[];b--;){for(f={},l=this.accessors,d=j=0,k=l.length;k>j;d=++j)c=l[d],m=c(i,e),h=m[0],e=m[1],f[this.columns[d]]=h;g.push(f)}return g},b}(n),this.astro.FITS.BinaryTable=b,e={RiceSetup:{1:function(a){var b,c,d,e;return e=1,b=3,c=6,d=a[0],[b,c,d,e]},2:function(a){var b,c,d,e,f;return f=2,c=4,d=14,e=0,b=a[0],e|=b<<8,b=a[1],e|=b,[c,d,e,f]},4:function(a){var b,c,d,e,f;return f=4,c=5,d=25,e=0,b=a[0],e|=b<<24,b=a[1],e|=b<<16,b=a[2],e|=b<<8,b=a[3],e|=b,[c,d,e,f]}},Rice:function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;for(h=1<<k,u=f[c](a),k=u[0],l=u[1],p=u[2],t=u[3],r=new Uint8Array(256),s=8,v=[128,255],o=v[0],m=v[1];m>=0;){for(;m>=o;)r[m]=s,m-=1;o/=2,s-=1}for(r[0]=0,g=a[t++],q=8,m=0;e>m;){for(q-=k;0>q;)g=g<<8|a[t++],q+=8;if(j=(g>>q)-1,g&=(1<<q)-1,n=m+b,n>e&&(n=e),0>j)for(;n>m;)d[m]=p,m+=1;else if(j===l)for(;n>m;){for(o=h-q,i=g<<o,o-=8;o>=0;)g=a[t++],i|=g<<o,o-=8;q>0?(g=a[t++],i|=g>>-o,g&=(1<<q)-1):g=0,0===(1&i)?i>>=1:i=~(i>>1),d[m]=i+p,p=d[m],m++}else for(;n>m;){for(;0===g;)q+=8,g=a[t++];for(s=q-r[g],q-=s+1,g^=1<<q,q-=j;0>q;)g=g<<8|a[t++],q+=8;i=s<<j|g>>q,g&=(1<<q)-1,0===(1&i)?i>>=1:i=~(i>>1),d[m]=i+p,p=d[m],m++}}return d}},this.astro.FITS.Decompress=e,c=function(a){function b(a){var c,d,e,f,g,h;for(b.__super__.constructor.apply(this,arguments),this.zcmptype=a.get("ZCMPTYPE"),this.zbitpix=a.get("ZBITPIX"),this.znaxis=a.get("ZNAXIS"),this.zblank=a.get("ZBLANK"),this.blank=a.get("BLANK"),this.zdither=a.get("ZDITHER0")||0,this.ztile=[],c=g=1,h=this.znaxis;h>=1?h>=g:g>=h;c=h>=1?++g:--g)f=a.contains("ZTILE"+c)?a.get("ZTILE"+c):1===c?a.get("ZNAXIS1"):1,this.ztile.push(f);for(this.width=a.get("ZNAXIS1"),this.height=a.get("ZNAXIS2")||1,this.algorithmParameters={},"RICE_1"===this.zcmptype&&(this.algorithmParameters.BLOCKSIZE=32,this.algorithmParameters.BYTEPIX=4),c=1;d="ZNAME"+c,a.contains(d);)e="ZVAL"+c,this.algorithmParameters[a.get(d)]=a.get(e),c+=1;this.zmaskcmp=a.get("ZMASKCMP"),this.zquantiz=a.get("ZQUANTIZ")||"LINEAR_SCALING",this.bzero=a.get("BZERO")||0,this.bscale=a.get("BSCALE")||1}return r(b,a),b.include(k),b.extend(e),b.randomGenerator=function(){var a,b,c,d,e,f,g;for(a=16807,c=2147483647,e=1,d=new Float32Array(1e4),b=g=0;9999>=g;b=++g)f=a*e,e=f-c*parseInt(f/c),d[b]=e/c;return d},b.randomSequence=b.randomGenerator(),b.prototype._getRows=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;for(r=new DataView(a),j=0,d=new Float32Array(this.width*this.height);b--;){for(m={},x=this.accessors,h=t=0,v=x.length;v>t;h=++t)c=x[h],y=c(r,j),q=y[0],j=y[1],m[this.columns[h]]=q;for(f=m.COMPRESSED_DATA||m.UNCOMPRESSED_DATA||m.GZIP_COMPRESSED_DATA,e=m.ZBLANK||this.zblank,n=m.ZSCALE||this.bscale,s=m.ZZERO||this.bzero,i=this.height-b,o=i+this.zdither-1,p=(o-1)%1e4,l=parseInt(500*this.constructor.randomSequence[p]),h=u=0,w=f.length;w>u;h=++u)q=f[h],g=(i-1)*this.width+h,-2147483647===q?d[g]=NaN:-2147483646===q?d[g]=0:(k=this.constructor.randomSequence[l],d[g]=(q-k+.5)*n+s),l+=1,1e4===l&&(p=(p+1)%1e4,l=parseInt(500*this.randomSequence[p]))}return d},b.prototype.getFrame=function(a,b,c){var d,e,f=this;return this.heap?(this.frame=a||this.frame,this.getRows(0,this.rows,b,c)):(d=this.blob.slice(this.length,this.length+this.heapLength),e=new FileReader,e.onloadend=function(d){return f.heap=d.target.result,f.getFrame(a,b,c)},e.readAsArrayBuffer(d))},b}(b),this.astro.FITS.CompressedImage=c,g=function(){function a(a,b){this.header=a,this.data=b}return a.prototype.hasData=function(){return null!=this.data},a}(),this.astro.FITS.HDU=g}.call(this),MOC=function(){function a(a){return Math.log(a)/Math.LN2}MOC=function(a){this.order=void 0,this._highResCells={},this._lowResCells={},a=a||{},this.name=a.name||"MOC",this.color=a.color||Color.getNextColor(),this.opacity=a.opacity||1,this.opacity=Math.max(0,Math.min(1,this.opacity)),this.lineWidth=a.lineWidth||1,this.isShowing=!0},MOC.MAX_NORDER=13,MOC.LOWRES_MAXORDER=5,MOC.HIGHRES_MAXORDER=11,MOC.PIVOT_FOV=20,MOC.prototype._addPix=function(a,b){if(MOC.LOWRES_MAXORDER>=a)a in this._lowResCells||(this._lowResCells[a]=[],this._highResCells[a]=[]),this._lowResCells[a].push(b),this._highResCells[a].push(b);else if(MOC.HIGHRES_MAXORDER>=a){a in this._highResCells||(this._highResCells[a]=[]),this._highResCells[a].push(b);var c=MOC.LOWRES_MAXORDER,d=Math.floor(b/Math.pow(4,a-c));c in this._lowResCells||(this._lowResCells=[]),this._lowResCells[c].push(d)}else{var c=MOC.LOWRES_MAXORDER,d=Math.floor(b/Math.pow(4,a-c));c in this._lowResCells||(this._lowResCells=[]),this._lowResCells[c].push(d),c=MOC.HIGHRES_MAXORDER,d=Math.floor(b/Math.pow(4,a-c)),c in this._highResCells||(this._highResCells=[]),this._highResCells[c].push(d)}},MOC.prototype.dataFromJSON=function(a){this._highResCells={},this._lowResCells={};var b,c;for(var d in a)if(a.hasOwnProperty(d)){b=parseInt(d),(void 0===this.order||b>this.order)&&(this.order=b);for(var e=0;a[d].length>e;e++)c=a[d][e],this._addPix(b,c)}},MOC.prototype.dataFromFITSURL=function(b,c){this._highResCells={},this._lowResCells={};var d=this,e=function(){var b;try{b=this.getHeader(0)}catch(a){return}var e=this.getHeader(1);if(b.contains("HPXMOC"))d.order=b.get("HPXMOC");else if(b.contains("MOCORDER"))d.order=b.get("MOCORDER");else if(e.contains("HPXMOC"))d.order=e.get("HPXMOC");else{if(!e.contains("MOCORDER"))return;d.order=e.get("MOCORDER")}var f=this.getDataUnit(1),g=f.columns[0];f.getRows(0,f.rows,function(b){for(var c=0;b.length>c;c++){var e=b[c][g],f=Math.floor(Math.floor(a(Math.floor(e/4)))/2),h=e-4*Math.pow(4,f);d._addPix(f,h)}}),f=null,c&&c()};this.dataURL=b;var f=Aladin.JSONP_PROXY+"?url="+encodeURIComponent(this.dataURL);new astro.FITS(f,e)},MOC.prototype.setView=function(a){this.view=a},MOC.prototype.draw=function(a,b,c,d,e,f,g,h){if(this.isShowing){var i=h>MOC.PIVOT_FOV?this._lowResCells:this._highResCells;this._drawCells(a,i,h,b,c,CooFrameEnum.J2000,d,e,f,g)}},MOC.prototype._drawCells=function(a,d,e,f,g,h,i,j,k,l){a.lineWidth=this.lineWidth,1==this.opacity?a.strokeStyle=this.color:(a.fillStyle=this.color,a.globalAlpha=this.opacity),a.beginPath();var m=[];for(key in d)m.push(key);m.sort();var n,o,p;if(e>80)for(var q,r=0;m.length>r;r++){q=parseInt(m[r]),n=1<<q;for(var s=0;d[q].length>s;s++)if(p=d[q][s],q>=3)o=c(n,p,g,h,i,j,k,l,f),o&&b(a,o);else for(var t=Math.pow(4,3-q),u=p*t,v=0;t>v;v++)o=c(8,u+v,g,h,i,j,k,l,f),o&&b(a,o)}else{this.view.getVisiblePixList(3,CooFrameEnum.J2000);for(var w={},x=parseInt(m[m.length-1]),q=1;x>=q;q++)if(n=1<<q,void 0!==d[q])if(3>=q)for(var s=0;d[q].length>s;s++){p=d[q][s];for(var t=Math.pow(4,3-q),u=p*t,v=0;t>v;v++)norder3Ipix=u+v,o=c(8,norder3Ipix,g,h,i,j,k,l,f),o&&b(a,o),w[norder3Ipix]=1}else for(var s=0;d[q].length>s;s++){p=d[q][s];var y=Math.floor(p/Math.pow(4,q-3));y in w||(o=c(n,p,g,h,i,j,k,l,f),o&&b(a,o))}}1==this.opacity?a.stroke():(a.fill(),a.globalAlpha=1)};var b=function(a,b){a.moveTo(b[0].vx,b[0].vy),a.lineTo(b[1].vx,b[1].vy),a.lineTo(b[2].vx,b[2].vy),a.lineTo(b[3].vx,b[3].vy),a.lineTo(b[0].vx,b[0].vy)},c=function(a,b,c,d,e,f,g,h,i){for(var j=[],k=[],l=new SpatialVector,m=HealpixCache.corners_nest(b,a),n=0;4>n;n++){if(l.setXYZ(m[n].x,m[n].y,m[n].z),d&&d!=c){if(d==CooFrameEnum.J2000){var o=CooConversion.J2000ToGalactic([l.ra(),l.dec()]);lon=o[0],lat=o[1]}else if(d==CooFrameEnum.GAL){var o=CooConversion.GalacticToJ2000([l.ra(),l.dec()]);lon=o[0],lat=o[1]}}else lon=l.ra(),lat=l.dec();k[n]=i.project(lon,lat)}if(null==k[0]||null==k[1]||null==k[2]||null==k[3])return null;for(var n=0;4>n;n++)j[n]=AladinUtils.xyToView(k[n].X,k[n].Y,e,f,g,h);return 0>j[0].vx&&0>j[1].vx&&0>j[2].vx&&0>j[3].vx?null:0>j[0].vy&&0>j[1].vy&&0>j[2].vy&&0>j[3].vy?null:j[0].vx>=e&&j[1].vx>=e&&j[2].vx>=e&&j[3].vx>=e?null:j[0].vy>=f&&j[1].vy>=f&&j[2].vy>=f&&j[3].vy>=f?null:j=AladinUtils.grow2(j,1)};return MOC.prototype.reportChange=function(){this.view.requestRedraw()},MOC.prototype.show=function(){this.isShowing||(this.isShowing=!0,this.reportChange())},MOC.prototype.hide=function(){this.isShowing&&(this.isShowing=!1,this.reportChange())},MOC}(),CooGrid=function(){function a(a,b,c,d,e,f,g){var h,i=AladinUtils.viewToXy(b,c,d,e,f,g);try{h=a.unproject(i.x,i.y)}catch(a){return null}return{lon:h.ra,lat:h.dec}}var b=function(){};return b.prototype.redraw=function(b,c,d,e,f,g,h,i){if(!(i>60)){var j=0,k=359.9999,l=-90,m=90,n=a(c,0,0,e,f,g,h),o=a(c,e-1,f-1,e,f,g,h);k=Math.min(n.lon,o.lon),j=Math.max(n.lon,o.lon),m=Math.min(n.lat,o.lat),l=Math.max(n.lat,o.lat);var p=a(c,0,f-1,e,f,g,h);k=Math.min(k,p.lon),j=Math.max(j,p.lon),m=Math.min(m,p.lat),l=Math.max(l,p.lat);var q=a(c,e-1,0,e,f,g,h);k=Math.min(k,q.lon),j=Math.max(j,q.lon),m=Math.min(m,q.lat),l=Math.max(l,q.lat);var r,s,t=j-k,u=l-m;i>10?(r=4,s=4):i>1?(r=1,s=1):i>.1?(r=.1,s=.1):(r=.01,s=.01);var v=Math.round(k%r)*r,w=Math.round(m%s)*s;b.lineWidth=1,b.strokeStyle="rgb(120,120,255)";for(var x=w;l+s>x;x+=s){b.beginPath();var y;if(y=AladinUtils.radecToViewXy(k,x,c,CooFrameEnum.J2000,e,f,g,h)){b.moveTo(y.vx,y.vy);for(var z=0,A=k;j+r>A;A+=t/10)z++,y=AladinUtils.radecToViewXy(A,x,c,CooFrameEnum.J2000,e,f,g,h),b.lineTo(y.vx,y.vy),3==z&&b.strokeText(x.toFixed(2),y.vx,y.vy-2);b.stroke()}}for(var A=v;j+r>A;A+=r){b.beginPath();var y;if(y=AladinUtils.radecToViewXy(A,m,c,CooFrameEnum.J2000,e,f,g,h)){b.moveTo(y.vx,y.vy);for(var z=0,x=m;l+s>x;x+=u/10)z++,y=AladinUtils.radecToViewXy(A,x,c,CooFrameEnum.J2000,e,f,g,h),b.lineTo(y.vx,y.vy),3==z&&b.strokeText(A.toFixed(2),y.vx,y.vy-2);b.stroke()}}}},b}(),Footprint=function(){return Footprint=function(a){this.polygons=a,this.overlay=null,this.isShowing=!0,this.isSelected=!1},Footprint.prototype.setOverlay=function(a){this.overlay=a},Footprint.prototype.show=function(){this.isShowing||(this.isShowing=!0,this.overlay&&this.overlay.reportChange())},Footprint.prototype.hide=function(){this.isShowing&&(this.isShowing=!1,this.overlay&&this.overlay.reportChange())},Footprint.prototype.select=function(){this.isSelected||(this.isSelected=!0,this.overlay&&this.overlay.reportChange())},Footprint.prototype.deselect=function(){this.isSelected&&(this.isSelected=!1,this.overlay&&this.overlay.reportChange())},Footprint}(),Popup=function(){return Popup=function(a){this.domEl=$('<div class="aladin-popup-container"><div class="aladin-popup"><a class="aladin-closeBtn">&times;</a><div class="aladin-popupTitle"></div><div class="aladin-popupText"></div></div><div class="aladin-popup-arrow"></div></div>'),this.domEl.appendTo(a);var b=this;this.domEl.find(".aladin-closeBtn").click(function(){b.hide()})},Popup.prototype.hide=function(){this.domEl.hide()},Popup.prototype.show=function(){this.domEl.show()},Popup.prototype.setTitle=function(a){this.domEl.find(".aladin-popupTitle").html(a||"")},Popup.prototype.setText=function(a){this.domEl.find(".aladin-popupText").html(a||""),this.w=this.domEl.outerWidth(),this.h=this.domEl.outerHeight()},Popup.prototype.setSource=function(a){this.source&&(this.source.popup=null),a.popup=this,this.source=a,this.setPosition(a.x,a.y)},Popup.prototype.setPosition=function(a,b){var c=a-this.w/2,d=b-this.h+this.source.catalog.sourceSize/2;this.domEl[0].style.left=c+"px",this.domEl[0].style.top=d+"px"},Popup}(),Circle=function(){return Circle=function(a,b,c){c=c||{},this.color=c.color||void 0,this.setCenter(a),this.setRadius(b),this.overlay=null,this.isShowing=!0,this.isSelected=!1},Circle.prototype.setOverlay=function(a){this.overlay=a},Circle.prototype.show=function(){this.isShowing||(this.isShowing=!0,this.overlay&&this.overlay.reportChange())},Circle.prototype.hide=function(){this.isShowing&&(this.isShowing=!1,this.overlay&&this.overlay.reportChange())},Circle.prototype.select=function(){this.isSelected||(this.isSelected=!0,this.overlay&&this.overlay.reportChange())},Circle.prototype.deselect=function(){this.isSelected&&(this.isSelected=!1,this.overlay&&this.overlay.reportChange())},Circle.prototype.setCenter=function(a){this.centerRaDec=a,this.overlay&&this.overlay.reportChange()},Circle.prototype.setRadius=function(a){this.radiusDegrees=a,this.overlay&&this.overlay.reportChange()},Circle.prototype.draw=function(a,b,c,d,e,f,g){if(this.isShowing){var h;if(c!=CooFrameEnum.J2000){var i=CooConversion.J2000ToGalactic([this.centerRaDec[0],this.centerRaDec[1]]);h=b.project(i[0],i[1])}else h=b.project(this.centerRaDec[0],this.centerRaDec[1]);if(h){var j,k=AladinUtils.xyToView(h.X,h.Y,d,e,f,g,!1),l=this.centerRaDec[0],m=this.centerRaDec[1]+(l>0?-this.radiusDegrees:this.radiusDegrees);if(c!=CooFrameEnum.J2000){var i=CooConversion.J2000ToGalactic([l,m]);j=b.project(i[0],i[1])}else j=b.project(l,m);if(j){var n=AladinUtils.xyToView(j.X,j.Y,d,e,f,g,!1),o=n.vx-k.vx,p=n.vy-k.vy,q=Math.sqrt(o*o+p*p);this.color&&(a.strokeStyle=this.color),a.beginPath(),a.arc(k.vx,k.vy,q,0,2*Math.PI,!1),a.stroke()}}}},Circle}(),Polyline=function(){return Polyline=function(a,b){b=b||{},this.color=b.color||void 0,this.radecArray=a,this.overlay=null,this.isShowing=!0,this.isSelected=!1},Polyline.prototype.setOverlay=function(a){this.overlay=a},Polyline.prototype.show=function(){this.isShowing||(this.isShowing=!0,this.overlay&&this.overlay.reportChange())},Polyline.prototype.hide=function(){this.isShowing&&(this.isShowing=!1,this.overlay&&this.overlay.reportChange())},Polyline.prototype.select=function(){this.isSelected||(this.isSelected=!0,this.overlay&&this.overlay.reportChange())},Polyline.prototype.deselect=function(){this.isSelected&&(this.isSelected=!1,this.overlay&&this.overlay.reportChange())},Polyline.prototype.draw=function(a,b,c,d,e,f,g){if(this.isShowing&&this.radecArray&&!(2>this.radecArray.length)){this.color&&(a.strokeStyle=this.color);var h=AladinUtils.radecToViewXy(this.radecArray[0][0],this.radecArray[0][1],b,c,d,e,f,g);if(h){a.moveTo(h.vx,h.vy);for(var i,j=1;this.radecArray.length>j&&(i=AladinUtils.radecToViewXy(this.radecArray[j][0],this.radecArray[j][1],b,c,d,e,f,g));j++)a.lineTo(i.vx,i.vy);a.stroke()}}},Polyline}(),Overlay=function(){return Overlay=function(a){a=a||{},this.name=a.name||"overlay",this.color=a.color||Color.getNextColor(),this.lineWidth=a.lineWidth||2,this.overlays=[],this.overlay_items=[],this.isShowing=!0},Overlay.prototype.show=function(){this.isShowing||(this.isShowing=!0,this.reportChange())},Overlay.prototype.hide=function(){this.isShowing&&(this.isShowing=!1,this.reportChange())},Overlay.parseSTCS=function(a){for(var b,c=[],d=a.match(/\S+/g),e=0,f=d.length;f>e;){var g=d[e].toLowerCase();if("polygon"==g&&(b=[],e++,frame=d[e].toLowerCase(),"icrs"==frame||"j2000"==frame)){for(;f>e+2;){var h=parseFloat(d[e+1]);if(isNaN(h))break;var i=parseFloat(d[e+2]);b.push([h,i]),e+=2}b.push(b[0]),c.push(b)}e++}return c},Overlay.prototype.addFootprints=function(a){this.overlays=this.overlays.concat(a);for(var b=0,c=a.length;c>b;b++)a[b].setOverlay(this);this.view.requestRedraw()},Overlay.prototype.add=function(a){this.overlay_items.push(a),a.setOverlay(this),this.view.requestRedraw()},Overlay.prototype.getFootprint=function(a){return this.footprints.length>a?this.footprints[a]:null},Overlay.prototype.setView=function(a){this.view=a},Overlay.prototype.removeAll=function(){this.overlays=[],this.overlay_items=[]},Overlay.prototype.draw=function(a,b,c,d,e,f,g){if(this.isShowing){a.strokeStyle=this.color,a.lineWidth=this.lineWidth,a.beginPath(),xyviews=[];for(var h=0,i=this.overlays.length;i>h;h++)xyviews.push(this.drawFootprint(this.overlays[h],a,b,c,d,e,f,g));a.stroke(),a.strokeStyle=Overlay.increase_brightness(this.color,80),a.beginPath();for(var h=0,i=this.overlays.length;i>h;h++)this.overlays[h].isSelected&&this.drawFootprintSelected(a,xyviews[h]);a.stroke();for(var h=0;this.overlay_items.length>h;h++)this.overlay_items[h].draw(a,b,c,d,e,f,g)}},Overlay.increase_brightness=function(a,b){a=a.replace(/^\s*#|\s*$/g,""),3==a.length&&(a=a.replace(/(.)/g,"$1$1"));var c=parseInt(a.substr(0,2),16),d=parseInt(a.substr(2,2),16),e=parseInt(a.substr(4,2),16);return"#"+(0|256+c+(256-c)*b/100).toString(16).substr(1)+(0|256+d+(256-d)*b/100).toString(16).substr(1)+(0|256+e+(256-e)*b/100).toString(16).substr(1)},Overlay.prototype.drawFootprint=function(a,b,c,d,e,f,g,h){if(!a.isShowing)return null;for(var i=[],j=!1,k=a.polygons,l=0,m=k.length;m>l;l++){var n;if(d!=CooFrameEnum.J2000){var o=CooConversion.J2000ToGalactic([k[l][0],k[l][1]]);n=c.project(o[0],o[1])}else n=c.project(k[l][0],k[l][1]);if(!n)return null;var p=AladinUtils.xyToView(n.X,n.Y,e,f,g,h);i.push(p),!j&&e>p.vx&&p.vx>=0&&f>=p.vy&&p.vy>=0&&(j=!0)}if(j){b.moveTo(i[0].vx,i[0].vy);for(var l=1,m=i.length;m>l;l++)b.lineTo(i[l].vx,i[l].vy)}return i},Overlay.prototype.drawFootprintSelected=function(a,b){if(b){var c=b;a.moveTo(c[0].vx,c[0].vy);for(var d=1,e=c.length;e>d;d++)a.lineTo(c[d].vx,c[d].vy)}},Overlay.prototype.reportChange=function(){this.view.requestRedraw()},Overlay}(),cds.Source=function(){return cds.Source=function(a,b,c,d){this.ra=a,this.dec=b,this.data=c,this.catalog=null,this.marker=d&&d.marker||!1,this.marker&&(this.popupTitle=d&&d.popupTitle?d.popupTitle:"",this.popupDesc=d&&d.popupDesc?d.popupDesc:""),this.isShowing=!0,this.isSelected=!1},cds.Source.prototype.setCatalog=function(a){this.catalog=a},cds.Source.prototype.show=function(){this.isShowing||(this.isShowing=!0,this.catalog&&this.catalog.reportChange())},cds.Source.prototype.hide=function(){this.isShowing&&(this.isShowing=!1,this.catalog&&this.catalog.reportChange())},cds.Source.prototype.select=function(){this.isSelected||(this.isSelected=!0,this.catalog&&this.catalog.reportChange())},cds.Source.prototype.deselect=function(){this.isSelected&&(this.isSelected=!1,this.catalog&&this.catalog.reportChange())},cds.Source.prototype.actionClicked=function(){if(this.catalog&&this.catalog.onClick){var a=this.catalog.view;if("showTable"==this.catalog.onClick)a.aladin.measurementTable.showMeasurement(this),this.select();else if("showPopup"==this.catalog.onClick){a.popup.setTitle("<br><br>");var b='<div class="aladin-marker-measurement">';b+="<table>";for(var c in this.data)b+="<tr><td>"+c+"</td><td>"+this.data[c]+"</td></tr>";b+="</table>",b+="</div>",a.popup.setText(b),a.popup.setSource(this),a.popup.show()}}},cds.Source.prototype.actionOtherObjectClicked=function(){this.catalog&&this.catalog.onClick&&"showTable"==this.catalog.onClick&&this.deselect()},cds.Source}(),ProgressiveCat=function(){function a(a,b){var c=["name","ID","ucd","utype","unit","datatype","arraysize","width","precision"],d=[],e=0;return a.keyRa=a.keyDec=null,$(b).find("FIELD").each(function(){for(var b={},f=0;c.length>f;f++){var g=c[f];$(this).attr(g)&&(b[g]=$(this).attr(g))}b.ID||(b.ID="col_"+e),a.keyRa||!b.ucd||0!=b.ucd.indexOf("pos.eq.ra")&&0!=b.ucd.indexOf("POS_EQ_RA")||(a.keyRa=b.name?b.name:b.ID),a.keyDec||!b.ucd||0!=b.ucd.indexOf("pos.eq.dec")&&0!=b.ucd.indexOf("POS_EQ_DEC")||(a.keyDec=b.name?b.name:b.ID),d.push(b),e++}),d}function b(a,b,c){if(!a.keyRa||!a.keyDec)return[];lines=b.split("\n");for(var d=[],e=0;c.length>e;e++)c[e].name?d.push(c[e].name):d.push(c[e].ID);for(var f,g=[],h=new Coo,i=2;lines.length>i;i++){var j={},k=lines[i].split("\t");if(!(k.length<d.length)){for(var l=0;d.length>l;l++)j[d[l]]=k[l];var m,n;Utils.isNumber(j[a.keyRa])&&Utils.isNumber(j[a.keyDec])?(m=parseFloat(j[a.keyRa]),n=parseFloat(j[a.keyDec])):(h.parse(j[a.keyRa]+" "+j[a.keyDec]),m=h.lon,n=h.lat),f=new cds.Source(m,n,j),g.push(f),f.setCatalog(a)}}return g}return ProgressiveCat=function(a,b,c,d){d=d||{},this.type="progressivecat",this.rootUrl=a,this.frameStr=b,this.frame=CooFrameEnum.fromString(b)||CooFrameEnum.J2000,this.maxOrder=c,this.isShowing=!0,this.name=d.name||"progressive-cat",this.color=d.color||Color.getNextColor(),this.shape=d.shape||"square",this.sourceSize=d.sourceSize||6,this.selectSize=this.sourceSize+2,this.selectionColor="#00ff00",this.onClick=d.onClick||void 0,this.sourcesCache=new Utils.LRUCache(100),this.cacheCanvas=cds.Catalog.createShape(this.shape,this.color,this.sourceSize),this.cacheSelectCanvas=document.createElement("canvas"),this.cacheSelectCanvas.width=this.selectSize,this.cacheSelectCanvas.height=this.selectSize;var e=this.cacheSelectCanvas.getContext("2d");e.beginPath(),e.strokeStyle=this.selectionColor,e.lineWidth=2,e.moveTo(0,0),e.lineTo(0,this.selectSize),e.lineTo(this.selectSize,this.selectSize),e.lineTo(this.selectSize,0),e.lineTo(0,0),e.stroke(),this.maxOrderAllsky=2,this.isReady=!1},ProgressiveCat.readProperties=function(a,b,c){if(b){var d=a+"/properties";$.ajax({url:d,method:"GET",dataType:"text",success:function(a){for(var c={},d=a.split("\n"),e=0;d.length>e;e++){var f=d[e],g=f.indexOf("="),h=$.trim(f.substring(0,g)),i=$.trim(f.substring(g+1));c[h]=i}b(c)},error:function(a){c&&c(a)}})}},ProgressiveCat.prototype={init:function(a){var b=this;this.view=a,this.maxOrder&&this.frameStr?this._loadMetadata():ProgressiveCat.readProperties(b.rootUrl,function(a){b.properties=a,b.maxOrder=b.properties.hips_order,b.frame=CooFrameEnum.fromString(b.properties.hips_frame),b._loadMetadata()},function(){})},_loadMetadata:function(){var b=this;$.ajax({url:b.rootUrl+"/Metadata.xml",method:"GET",success:function(c){b.fields=a(b,c),b._loadAllskyNewMethod()},error:function(){b._loadAllskyOldMethod()}})},_loadAllskyNewMethod:function(){var a=this;$.ajax({url:a.rootUrl+"/Norder1/Allsky.tsv",method:"GET",success:function(c){a.order1Sources=b(a,c,a.fields),a.order2Sources&&(a.isReady=!0,a.view.requestRedraw())},error:function(a){}}),$.ajax({url:a.rootUrl+"/Norder2/Allsky.tsv",method:"GET",success:function(c){a.order2Sources=b(a,c,a.fields),a.order1Sources&&(a.isReady=!0,a.view.requestRedraw())},error:function(a){}})},_loadAllskyOldMethod:function(){this.maxOrderAllsky=3,this._loadLevel2Sources(),this._loadLevel3Sources()},_loadLevel2Sources:function(){var c=this;$.ajax({url:c.rootUrl+"/Norder2/Allsky.xml",method:"GET",success:function(d){c.fields=a(c,d),c.order2Sources=b(c,$(d).find("CSV").text(),c.fields),c.order3Sources&&(c.isReady=!0,c.view.requestRedraw())},error:function(a){}})},_loadLevel3Sources:function(){var a=this;$.ajax({url:a.rootUrl+"/Norder3/Allsky.xml",method:"GET",success:function(c){a.order3Sources=b(a,$(c).find("CSV").text(),a.fields),a.order2Sources&&(a.isReady=!0,a.view.requestRedraw())},error:function(a){}})},draw:function(a,b,c,d,e,f,g){if(this.isShowing&&this.isReady&&(this.drawSources(this.order1Sources,a,b,c,d,e,f,g),this.drawSources(this.order2Sources,a,b,c,d,e,f,g),this.drawSources(this.order3Sources,a,b,c,d,e,f,g),this.tilesInView))for(var h,i,j,k=0;this.tilesInView.length>k;k++)j=this.tilesInView[k],i=j[0]+"-"+j[1],h=this.sourcesCache.get(i),h&&this.drawSources(h,a,b,c,d,e,f,g)},drawSources:function(a,b,c,d,e,f,g,h){if(a){for(var i=0,j=a.length;j>i;i++)cds.Catalog.drawSource(this,a[i],b,c,d,e,f,g,h);for(var i=0,j=a.length;j>i;i++)a[i].isSelected&&cds.Catalog.drawSourceSelection(this,a[i],b)}},getSources:function(){var a=[];if(this.order1Sources&&(a=a.concat(this.order1Sources)),this.order2Sources&&(a=a.concat(this.order2Sources)),this.order3Sources&&(a=a.concat(this.order3Sources)),this.tilesInView)for(var b,c,d,e=0;this.tilesInView.length>e;e++)d=this.tilesInView[e],c=d[0]+"-"+d[1],b=this.sourcesCache.get(c),b&&(a=a.concat(b));return a},deselectAll:function(){if(this.order1Sources)for(var a=0;this.order1Sources.length>a;a++)this.order1Sources[a].deselect();if(this.order2Sources)for(var a=0;this.order2Sources.length>a;a++)this.order2Sources[a].deselect();if(this.order3Sources)for(var a=0;this.order3Sources.length>a;a++)this.order3Sources[a].deselect();var b=this.sourcesCache.keys();for(key in b)if(this.sourcesCache[key])for(var c=this.sourcesCache[key],a=0;c.length>a;a++)c[a].deselect()},show:function(){this.isShowing||(this.isShowing=!0,this.reportChange())},hide:function(){this.isShowing&&(this.isShowing=!1,this.reportChange())},reportChange:function(){this.view.requestRedraw()},getTileURL:function(a,b){var c=1e4*Math.floor(b/1e4);return this.rootUrl+"/Norder"+a+"/Dir"+c+"/Npix"+b+".tsv"},loadNeededTiles:function(){this.tilesInView=[],this.otherSources=[];var a=this.view.realNorder;if(a>this.maxOrder&&(a=this.maxOrder),!(this.maxOrderAllsky>=a)){for(var c,d,e=this.view.getVisibleCells(a,this.frame),f=4;a>=f;f++){c=[];for(var g=0;e.length>g;g++)d=Math.floor(e[g].ipix/Math.pow(4,a-f)),0>c.indexOf(d)&&c.push(d);for(var h=0;c.length>h;h++)this.tilesInView.push([f,c[h]])}for(var i,j,g=0;this.tilesInView.length>g;g++)i=this.tilesInView[g],j=i[0]+"-"+i[1],this.sourcesCache.get(j)||function(a,c,d){var e=c+"-"+d;$.ajax({url:a.getTileURL(c,d),method:"GET",success:function(c){a.sourcesCache.set(e,b(a,c,a.fields)),a.view.requestRedraw()},error:function(){a.sourcesCache.set(e,[])}})}(this,i[0],i[1])}},reportChange:function(){this.view&&this.view.requestRedraw()}},ProgressiveCat}(),cds.Catalog=function(){return cds.Catalog=function(a){a=a||{},this.type="catalog",this.name=a.name||"catalog",this.color=a.color||Color.getNextColor(),this.sourceSize=a.sourceSize||6,this.markerSize=a.sourceSize||12,this.shape=a.shape||"square",this.maxNbSources=a.limit||void 0,this.onClick=a.onClick||void 0,this.raField=a.raField||void 0,this.decField=a.decField||void 0,this.displayLabel=a.displayLabel||!1,this.labelColor=a.labelColor||this.color,this.labelFont=a.labelFont||"10px sans-serif",this.displayLabel&&(this.labelColumn=a.labelColumn,this.labelColumn||(this.displayLabel=!1)),(this.shape instanceof Image||this.shape instanceof HTMLCanvasElement)&&(this.sourceSize=this.shape.width),this._shapeIsFunction=!1,$.isFunction(this.shape)&&(this._shapeIsFunction=!0),this.selectSize=this.sourceSize+2,this.isShowing=!0,this.indexationNorder=5,this.sources=[],this.hpxIdx=new HealpixIndex(this.indexationNorder),this.hpxIdx.init(),this.selectionColor="#00ff00",this.cacheCanvas=cds.Catalog.createShape(this.shape,this.color,this.sourceSize),this.cacheMarkerCanvas=document.createElement("canvas"),this.cacheMarkerCanvas.width=this.markerSize,this.cacheMarkerCanvas.height=this.markerSize;var b=this.cacheMarkerCanvas.getContext("2d");b.fillStyle=this.color,b.beginPath();var c=this.markerSize/2;b.arc(c,c,c-2,0,2*Math.PI,!1),b.fill(),b.lineWidth=2,b.strokeStyle="#ccc",b.stroke(),this.cacheSelectCanvas=document.createElement("canvas"),this.cacheSelectCanvas.width=this.selectSize,this.cacheSelectCanvas.height=this.selectSize;var d=this.cacheSelectCanvas.getContext("2d");d.beginPath(),d.strokeStyle=this.selectionColor,d.lineWidth=2,d.moveTo(0,0),d.lineTo(0,this.selectSize),d.lineTo(this.selectSize,this.selectSize),d.lineTo(this.selectSize,0),d.lineTo(0,0),d.stroke()},cds.Catalog.createShape=function(a,b,c){if(a instanceof Image||a instanceof HTMLCanvasElement)return a;var d=document.createElement("canvas");d.width=d.height=c;var e=d.getContext("2d");return e.beginPath(),e.strokeStyle=b,e.lineWidth=2,"plus"==a?(e.moveTo(c/2,0),e.lineTo(c/2,c),e.stroke(),e.moveTo(0,c/2),e.lineTo(c,c/2),e.stroke()):"cross"==a?(e.moveTo(0,0),e.lineTo(c-1,c-1),e.stroke(),e.moveTo(c-1,0),e.lineTo(0,c-1),e.stroke()):"rhomb"==a?(e.moveTo(c/2,0),e.lineTo(0,c/2),e.lineTo(c/2,c),e.lineTo(c,c/2),e.lineTo(c/2,0),e.stroke()):"triangle"==a?(e.moveTo(c/2,0),e.lineTo(0,c-1),e.lineTo(c-1,c-1),e.lineTo(c/2,0),e.stroke()):(e.moveTo(0,0),e.lineTo(0,c),e.lineTo(c,c),e.lineTo(c,0),e.lineTo(0,0),e.stroke()),d},cds.Catalog.parseVOTable=function(a,b,c,d,e,f){function g(a){var b;if(a.find("RESOURCE").length>0)b="";else{if(b=a.find("*").first(),0==b.length)return"";b=b.prop("tagName");var c=b.indexOf(":");b=b.substring(0,c)+"\\:"}return b}function h(a,b){a=a.replace(/^\s+/g,"");var d=["name","ID","ucd","utype","unit","datatype","arraysize","width","precision"],h=[],i=0,j=$(a),k=g(j);j.find(k+"FIELD").each(function(){for(var a={},b=0;d.length>b;b++){var c=d[b];$(this).attr(c)&&(a[c]=$(this).attr(c))}a.ID||(a.ID="col_"+i),h.push(a),i++});var l,m;if(l=m=null,e)for(var n=0,o=h.length;o>n;n++){var p=h[n];if(Utils.isInt(e)&&h.length>e){l=e;break}if(p.ID&&p.ID===e||p.name&&p.name===e){l=n;break}}if(f)for(var n=0,o=h.length;o>n;n++){var p=h[n];if(Utils.isInt(f)&&h.length>f){m=f;break}if(p.ID&&p.ID===f||p.name&&p.name===f){m=n;break}}for(var n=0,o=h.length;o>n&&(null==l||null==m);n++){var p=h[n];if(!l&&p.ucd){var q=$.trim(p.ucd.toLowerCase());if(0==q.indexOf("pos.eq.ra")||0==q.indexOf("pos_eq_ra")){l=n;continue}}if(!m&&p.ucd){var q=$.trim(p.ucd.toLowerCase());if(0==q.indexOf("pos.eq.dec")||0==q.indexOf("pos_eq_dec")){m=n;continue}}}var r,s,t=[],u=new Coo;j.find(k+"TR").each(function(){var a={},b=0;$(this).find(k+"TD").each(function(){var c=h[b].name?h[b].name:h[b].id;a[c]=$(this).text(),b++});var d=h[l].name?h[l].name:h[l].id,e=h[m].name?h[m].name:h[m].id;return Utils.isNumber(a[d])&&Utils.isNumber(a[e])?(r=parseFloat(a[d]),s=parseFloat(a[e])):(u.parse(a[d]+" "+a[e]),r=u.lon,s=u.lat),t.push(new cds.Source(r,s,a)),(!c||t.length!=c)&&void 0}),b&&b(t)}var i=Utils.getAjaxObject(a,"GET","text",d);i.done(function(a){h(a,b)})},cds.Catalog.prototype.addSources=function(a){this.sources=this.sources.concat(a);
for(var b=0,c=a.length;c>b;b++)a[b].setCatalog(this);this.reportChange()},cds.Catalog.prototype.getSources=function(){return this.sources},cds.Catalog.prototype.selectAll=function(){if(this.sources)for(var a=0;this.sources.length>a;a++)this.sources[a].select()},cds.Catalog.prototype.deselectAll=function(){if(this.sources)for(var a=0;this.sources.length>a;a++)this.sources[a].deselect()},cds.Catalog.prototype.getSource=function(a){return this.sources.length>a?this.sources[a]:null},cds.Catalog.prototype.setView=function(a){this.view=a,this.reportChange()},cds.Catalog.prototype.removeAll=cds.Catalog.prototype.clear=function(){this.sources=[]},cds.Catalog.prototype.draw=function(a,b,c,d,e,f,g){if(this.isShowing){this._shapeIsFunction&&a.save();for(var h=0,i=this.sources.length;i>h;h++)cds.Catalog.drawSource(this,this.sources[h],a,b,c,d,e,f,g);this._shapeIsFunction&&a.restore(),a.strokeStyle=this.selectionColor;for(var h=0,i=this.sources.length;i>h;h++)this.sources[h].isSelected&&cds.Catalog.drawSourceSelection(this,this.sources[h],a);if(this.displayLabel){a.fillStyle=this.labelColor,a.font=this.labelFont;for(var h=0,i=this.sources.length;i>h;h++)cds.Catalog.drawSourceLabel(this,this.sources[h],a)}}},cds.Catalog.drawSource=function(a,b,c,d,e,f,g,h,i){if(b.isShowing){var j,k=a.sourceSize;if(e!=CooFrameEnum.J2000){var l=CooConversion.J2000ToGalactic([b.ra,b.dec]);j=d.project(l[0],l[1])}else j=d.project(b.ra,b.dec);if(j){var m=AladinUtils.xyToView(j.X,j.Y,f,g,h,i,!0),n=b.popup?100:b.sourceSize;if(m){if(m.vx>f+n||0-n>m.vx||m.vy>g+n||0-n>m.vy)return void(b.x=b.y=void 0);b.x=m.vx,b.y=m.vy,a._shapeIsFunction?a.shape(b,c,a.view.getViewParams()):b.marker?c.drawImage(a.cacheMarkerCanvas,b.x-k/2,b.y-k/2):c.drawImage(a.cacheCanvas,b.x-a.cacheCanvas.width/2,b.y-a.cacheCanvas.height/2),b.popup&&b.popup.setPosition(b.x,b.y)}}}},cds.Catalog.drawSourceSelection=function(a,b,c){if(b&&b.isShowing&&b.x&&b.y){var d=a.selectSize;c.drawImage(a.cacheSelectCanvas,b.x-d/2,b.y-d/2)}},cds.Catalog.drawSourceLabel=function(a,b,c){if(b&&b.isShowing&&b.x&&b.y){var d=b.data[a.labelColumn];d&&c.fillText(d,b.x,b.y)}},cds.Catalog.prototype.reportChange=function(){this.view&&this.view.requestRedraw()},cds.Catalog.prototype.show=function(){this.isShowing||(this.isShowing=!0,this.reportChange())},cds.Catalog.prototype.hide=function(){this.isShowing&&(this.isShowing=!1,this.view&&this.view.popup&&this.view.popup.source&&this.view.popup.source.catalog==this&&this.view.popup.hide(),this.reportChange())},cds.Catalog}(),Tile=function(){function a(a,b){this.img=a,this.url=b}return a.isImageOk=function(a){return!!a.allSkyTexture||!!a.src&&(!!a.complete&&(void 0===a.naturalWidth||0!=a.naturalWidth))},a}(),TileBuffer=function(){function a(){this.pointer=0,this.tilesMap={},this.tilesArray=Array(b);for(var a=0;b>a;a++)this.tilesArray[a]=new Tile(new Image,null)}var b=800;return a.prototype.addTile=function(a){if(this.getTile(a))return null;var c=this.tilesArray[this.pointer];return null!=c.url&&(c.img.src=null,delete this.tilesMap[c.url]),this.tilesArray[this.pointer].url=a,this.tilesMap[a]=this.tilesArray[this.pointer],this.pointer++,this.pointer>=b&&(this.pointer=0),this.tilesMap[a]},a.prototype.getTile=function(a){return this.tilesMap[a]},a}(),ColorMap=function(){return ColorMap=function(a){this.view=a,this.reversed=!1,this.mapName="native",this.sig=this.signature()},ColorMap.MAPS={},ColorMap.MAPS.eosb={name:"Eos B",r:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,18,27,36,45,49,57,72,81,91,100,109,118,127,136,131,139,163,173,182,191,200,209,218,227,213,221,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,253,251,249,247,245,243,241,215,214,235,234,232,230,228,226,224,222,198,196,216,215,213,211,209,207,205,203,181,179,197,196,194,192,190,188,186,184,164,162,178,176,175,173,171,169,167,165,147,145,159,157,156,154,152,150,148,146,130,128,140,138,137,135,133,131,129,127,113,111,121,119,117,117],g:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,15,23,31,39,47,55,57,64,79,87,95,103,111,119,127,135,129,136,159,167,175,183,191,199,207,215,200,207,239,247,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,255,255,255,255,255,255,255,229,229,255,250,246,242,238,233,229,225,198,195,212,208,204,199,195,191,187,182,160,156,169,165,161,157,153,148,144,140,122,118,127,125,123,121,119,116,114,112,99,97,106,104,102,99,97,95,93,91,80,78,84,82,80,78,76,74,72,70,61,59,63,61,59,57,55,53,50,48,42,40,42,40,38,36,33,31,29,27,22,21,21,19,16,14,12,13,8,6,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b:[116,121,127,131,136,140,144,148,153,157,145,149,170,174,178,182,187,191,195,199,183,187,212,216,221,225,229,233,238,242,221,225,255,247,239,231,223,215,207,199,172,164,175,167,159,151,143,135,127,119,100,93,95,87,79,71,63,55,47,39,28,21,15,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},ColorMap.MAPS.rainbow={name:"Rainbow",r:[0,4,9,13,18,22,27,31,36,40,45,50,54,58,61,64,68,69,72,74,77,79,80,82,83,85,84,86,87,88,86,87,87,87,85,84,84,84,83,79,78,77,76,71,70,68,66,60,58,55,53,46,43,40,36,33,25,21,16,12,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,8,12,21,25,29,33,42,46,51,55,63,67,72,76,80,89,93,97,101,110,114,119,123,131,135,140,144,153,157,161,165,169,178,182,187,191,199,203,208,212,221,225,229,233,242,246,250,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255],g:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,8,16,21,25,29,38,42,46,51,55,63,67,72,76,84,89,93,97,106,110,114,119,127,131,135,140,144,152,157,161,165,174,178,182,187,195,199,203,208,216,220,225,229,233,242,246,250,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,242,238,233,229,221,216,212,208,199,195,191,187,178,174,170,165,161,153,148,144,140,131,127,123,119,110,106,102,97,89,85,80,76,72,63,59,55,51,42,38,34,29,21,17,12,8,0],b:[0,3,7,10,14,19,23,28,32,38,43,48,53,59,63,68,72,77,81,86,91,95,100,104,109,113,118,122,127,132,136,141,145,150,154,159,163,168,173,177,182,186,191,195,200,204,209,214,218,223,227,232,236,241,245,250,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,246,242,238,233,225,220,216,212,203,199,195,191,187,178,174,170,165,157,152,148,144,135,131,127,123,114,110,106,102,97,89,84,80,76,67,63,59,55,46,42,38,34,25,21,16,12,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},ColorMap.MAPS.cubehelix={name:"Cubehelix",r:[0,1,3,4,6,8,9,10,12,13,14,15,17,18,19,20,20,21,22,23,23,24,24,25,25,25,26,26,26,26,26,26,26,26,26,26,26,25,25,25,25,24,24,24,23,23,23,23,22,22,22,21,21,21,21,21,21,20,20,20,21,21,21,21,21,22,22,22,23,23,24,25,26,27,27,28,30,31,32,33,35,36,38,39,41,43,45,47,49,51,53,55,57,60,62,65,67,70,72,75,78,81,83,86,89,92,95,98,101,104,107,110,113,116,120,123,126,129,132,135,138,141,144,147,150,153,155,158,161,164,166,169,171,174,176,178,181,183,185,187,189,191,193,194,196,198,199,201,202,203,204,205,206,207,208,209,209,210,211,211,211,212,212,212,212,212,212,212,212,211,211,211,210,210,210,209,208,208,207,207,206,205,205,204,203,203,202,201,201,200,199,199,198,197,197,196,196,195,195,194,194,194,193,193,193,193,193,193,193,193,193,193,194,194,195,195,196,196,197,198,199,200,200,202,203,204,205,206,208,209,210,212,213,215,217,218,220,222,223,225,227,229,231,232,234,236,238,240,242,244,245,247,249,251,253,255],g:[0,0,1,1,2,2,3,4,4,5,6,6,7,8,9,10,11,11,12,13,14,15,17,18,19,20,21,22,24,25,26,28,29,31,32,34,35,37,38,40,41,43,45,46,48,50,52,53,55,57,58,60,62,64,66,67,69,71,73,74,76,78,79,81,83,84,86,88,89,91,92,94,95,97,98,99,101,102,103,104,106,107,108,109,110,111,112,113,114,114,115,116,116,117,118,118,119,119,120,120,120,121,121,121,121,122,122,122,122,122,122,122,122,122,122,122,122,122,122,122,121,121,121,121,121,121,121,121,121,120,120,120,120,120,120,120,120,120,120,121,121,121,121,121,122,122,122,123,123,124,124,125,125,126,127,127,128,129,130,131,131,132,133,135,136,137,138,139,140,142,143,144,146,147,149,150,152,154,155,157,158,160,162,164,165,167,169,171,172,174,176,178,180,182,183,185,187,189,191,193,194,196,198,200,202,203,205,207,208,210,212,213,215,216,218,219,221,222,224,225,226,228,229,230,231,232,233,235,236,237,238,239,240,240,241,242,243,244,244,245,246,247,247,248,248,249,250,250,251,251,252,252,253,253,254,255],b:[0,1,3,4,6,8,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,48,50,52,54,56,57,59,60,62,63,65,66,67,69,70,71,72,73,74,74,75,76,76,77,77,77,78,78,78,78,78,78,78,77,77,77,76,76,75,75,74,73,73,72,71,70,69,68,67,66,66,65,64,63,61,60,59,58,58,57,56,55,54,53,52,51,51,50,49,49,48,48,47,47,47,46,46,46,46,46,47,47,47,48,48,49,50,50,51,52,53,55,56,57,59,60,62,64,65,67,69,71,74,76,78,81,83,86,88,91,94,96,99,102,105,108,111,114,117,120,124,127,130,133,136,140,143,146,149,153,156,159,162,165,169,172,175,178,181,184,186,189,192,195,197,200,203,205,207,210,212,214,216,218,220,222,224,226,227,229,230,231,233,234,235,236,237,238,239,239,240,241,241,242,242,242,243,243,243,243,243,243,243,243,243,243,242,242,242,242,241,241,241,241,240,240,240,239,239,239,239,239,238,238,238,238,238,238,238,238,239,239,239,240,240,240,241,242,242,243,244,245,246,247,248,249,250,252,253,255]},ColorMap.MAPS_CUSTOM=["cubehelix","eosb","rainbow"],ColorMap.MAPS_NAMES=["native","grayscale"].concat(ColorMap.MAPS_CUSTOM),ColorMap.prototype.reverse=function(a){this.reversed=a?a:!this.reversed,this.sig=this.signature(),this.view.requestRedraw()},ColorMap.prototype.signature=function(){var a=this.mapName;return this.reversed&&(a+=" reversed"),a},ColorMap.prototype.update=function(a){this.mapName=a,this.sig=this.signature(),this.view.requestRedraw()},ColorMap.prototype.apply=function(a){if("native"==this.sig)return a;if(a.cmSig==this.sig)return a.cmImg;var b=document.createElement("canvas");b.width=a.width,b.height=a.height;var c=b.getContext("2d");c.drawImage(a,0,0);var d,e,f,g=c.getImageData(0,0,b.width,b.height),h=g.data,i=h.length,j=3;"grayscale"==this.mapName?j=1:ColorMap.MAPS_CUSTOM.indexOf(this.mapName)>=0&&(j=2);for(var k=0;i>k;k+=4){switch(j){case 1:d=e=f=AladinUtils.myRound((h[k]+h[k+1]+h[k+2])/3);break;case 2:this.reversed?(d=ColorMap.MAPS[this.mapName].r[255-h[k]],e=ColorMap.MAPS[this.mapName].g[255-h[k+1]],f=ColorMap.MAPS[this.mapName].b[255-h[k+2]]):(d=ColorMap.MAPS[this.mapName].r[h[k]],e=ColorMap.MAPS[this.mapName].g[h[k+1]],f=ColorMap.MAPS[this.mapName].b[h[k+2]]);break;default:d=h[k],e=h[k+1],f=h[k+2]}2!=j&&this.reversed&&(d=255-d,e=255-e,f=255-f),h[k]=d,h[k+1]=e,h[k+2]=f}return g.data=h,c.putImageData(g,0,0),a.cmSig=this.sig,a.cmImg=b,a.cmImg},ColorMap}(),HpxKey=function(){"use strict";var a=function(a,b,c,d,e,f,g,h,i){this.norder=a,this.npix=b,this.nside=Math.pow(2,a),this.hips=c,this.frame=c.cooFrame,this.width=d,this.height=e,this.dx=f||0,this.dy=g||0,this.allskyTexture=h||void 0,this.allskyTextureSize=i,this.parente=0,this.children=null,this.ancestor=null};a.createHpxKeyfromAncestor=function(b,c){var d=new a(b.norder+1,4*b.npix+c,b.hips,b.width/2,b.height/2,2==c||3==c?b.dx+b.width/2:b.dx,1==c||3==c?b.dy+b.height/2:b.dy,b.allskyTexture,b.allskyTextureSize);return d.parente=b.parente+1,d.ancestor=b.ancestor||b,d};var b=4;a.prototype={draw:function(a,c){var d=0,e=this.getProjViewCorners(c);if(null==e)return 0;var f=(new Date).getTime(),h=null==this.ancestor&&this.norder>=3&&f-this.hips.lastUpdateDateNeededTiles>.1;try{if(g(e)){var i=this.drawChildren(a,c,b);if(i>0)return i}}catch(a){return 0}var j=null==this.ancestor?this.norder:this.ancestor.norder,k=null==this.ancestor?this.npix:this.ancestor.npix,l=this.hips.getTileURL(j,k),m=this.hips.tileBuffer.getTile(l);if(m&&Tile.isImageOk(m.img)||this.allskyTexture){this.allskyTexture||this.hips.tileSize||(this.hips.tileSize=m.img.width);var n=this.allskyTexture||m.img,o=this.allskyTextureSize||n.width;this.parente&&(o/=Math.pow(2,this.parente)),this.hips.drawOneTile2(a,n,e,o,null,this.dx,this.dy,!0,j),d+=2}else h&&!m&&(m=this.hips.tileBuffer.addTile(l),c.downloader.requestDownload(m.img,m.url,this.hips.useCors),this.hips.lastUpdateDateNeededTiles=f,c.requestRedrawAtDate(f+HpxImageSurvey.UPDATE_NEEDED_TILES_DELAY+10));return d},drawChildren:function(a,b,c){var d=0,e=13;if(this.width>1&&e>this.norder&&c>this.parente){var f=this.getChildren();if(null!=f)for(var g=0;4>g;g++)null!=f[g]&&(d+=f[g].draw(a,b,c))}return d},getChildren:function(){if(null!=this.children)return this.children;for(var b=[],c=0;4>c;c++){var d=a.createHpxKeyfromAncestor(this,c);b[c]=d}return this.children=b,this.children},getProjViewCorners:function(a){var b=[],c=[],d=new SpatialVector;corners=HealpixCache.corners_nest(this.npix,this.nside);for(var e,f,g=0;4>g;g++){if(d.setXYZ(corners[g].x,corners[g].y,corners[g].z),this.frame!=a.cooFrame){if(this.frame==CooFrameEnum.J2000){var h=CooConversion.J2000ToGalactic([d.ra(),d.dec()]);e=h[0],f=h[1]}else if(this.frame==CooFrameEnum.GAL){var h=CooConversion.GalacticToJ2000([d.ra(),d.dec()]);e=h[0],f=h[1]}}else e=d.ra(),f=d.dec();b[g]=a.projection.project(e,f)}if(null==b[0]||null==b[1]||null==b[2]||null==b[3])return null;for(var g=0;4>g;g++)c[g]=AladinUtils.xyToView(b[g].X,b[g].Y,a.width,a.height,a.largestDim,a.zoomFactor);return c}};var c=function(a,b,c){var d=a[b].vx-a[c].vx,e=a[b].vy-a[c].vy;return d*d+e*e},d=78400,e=22500,f=.7,g=function(a){var b,g;if((b=c(a,0,2))>d||(g=c(a,2,1))>d)return!0;if(0==b||0==g)throw"Rhomb error";var h=c(a,0,3),i=c(a,1,2);if(0==i||0==i)throw"Rhomb error";var j=i>h?h/i:i/h;return f>j&&(h>e||i>e)};return a}(),HpxImageSurvey=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){p=p||0,q=q||0,r||(r=!1),i+=p,k+=p,m+=p,j+=q,l+=q,n+=q;var s=(c+e+g)/3,t=(d+f+h)/3,s=(c+e+g)/3,t=(d+f+h)/3;a.save(),o&&(a.globalAlpha=o),coeff=.02,a.beginPath(),a.moveTo((1+coeff)*c-s*coeff,(1+coeff)*d-t*coeff),a.lineTo((1+coeff)*e-s*coeff,(1+coeff)*f-t*coeff),a.lineTo((1+coeff)*g-s*coeff,(1+coeff)*h-t*coeff),a.closePath(),a.clip(),r&&(coeff=.01,c=(1+coeff)*c-s*coeff,d=(1+coeff)*d-t*coeff,e=(1+coeff)*e-s*coeff,f=(1+coeff)*f-t*coeff,g=(1+coeff)*g-s*coeff,h=(1+coeff)*h-t*coeff);var u=1/(i*(n-l)-k*n+m*l+(k-m)*j);a.transform(-(j*(g-e)-l*g+n*e+(l-n)*c)*u,(l*h+j*(f-h)-n*f+(n-l)*d)*u,(i*(g-e)-k*g+m*e+(k-m)*c)*u,-(k*h+i*(f-h)-m*f+(m-k)*d)*u,(i*(n*e-l*g)+j*(k*g-m*e)+(m*l-k*n)*c)*u,(i*(n*f-l*h)+j*(k*h-m*f)+(m*l-k*n)*d)*u),a.drawImage(b,0,0),a.restore()}function b(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){p=p||0,q=q||0,r||(r=!1),i+=p,k+=p,m+=p,j+=q,l+=q,n+=q;var s=(c+e+g)/3,t=(d+f+h)/3,s=(c+e+g)/3,t=(d+f+h)/3;a.save(),o&&(a.globalAlpha=o);var u=.01;r&&(u=.01),a.beginPath(),a.moveTo((1+u)*c-s*u,(1+u)*d-t*u),a.lineTo((1+u)*e-s*u,(1+u)*f-t*u),a.lineTo((1+u)*g-s*u,(1+u)*h-t*u),a.closePath(),a.clip(),r&&(u=.03,c=(1+u)*c-s*u,d=(1+u)*d-t*u,e=(1+u)*e-s*u,f=(1+u)*f-t*u,g=(1+u)*g-s*u,h=(1+u)*h-t*u);var v=1/(i*(n-l)-k*n+m*l+(k-m)*j);a.transform(-(j*(g-e)-l*g+n*e+(l-n)*c)*v,(l*h+j*(f-h)-n*f+(n-l)*d)*v,(i*(g-e)-k*g+m*e+(k-m)*c)*v,-(k*h+i*(f-h)-m*f+(m-k)*d)*v,(i*(n*e-l*g)+j*(k*g-m*e)+(m*l-k*n)*c)*v,(i*(n*f-l*h)+j*(k*h-m*f)+(m*l-k*n)*d)*v),a.drawImage(b,0,0),a.restore()}var c=function(a,b,d,e,f,g){this.id=a,this.name=b,this.rootUrl="/"===d.slice(-1)?d.substr(0,d.length-1):d,g=g||{},this.imgFormat=g.imgFormat||"jpg",this.minOrder=g.minOrder||null,this.tileSize=void 0,this.cooFrame=CooFrameEnum.fromString(e,CooFrameEnum.J2000),this.rootUrl.indexOf("/glimpse360/aladin/data")>=0&&(this.cooFrame=CooFrameEnum.J2000),this.maxOrder=f,this.allskyTexture=null,this.alpha=0,this.allskyTextureSize=0,this.lastUpdateDateNeededTiles=0;for(var h=!1,i=0;c.SURVEYS.length>i;i++)c.SURVEYS[i].id==this.id&&(h=!0);h||c.SURVEYS.push({id:this.id,url:this.rootUrl,name:this.name,maxOrder:this.maxOrder,frame:this.cooFrame}),c.SURVEYS_OBJECTS[this.id]=this};c.HTTPS_CONTEXT="https:"===window.location.protocol,c.UPDATE_NEEDED_TILES_DELAY=1e3,c.prototype.init=function(a,b){this.view=a,this.cm||(this.cm=new ColorMap(this.view)),this.tileBuffer=this.view.tileBuffer,this.useCors=!1;var c=this;$.support.cors?$.ajax({type:"GET",url:this.rootUrl+"/properties",dataType:"text",xhrFields:{},headers:{},success:function(){c.useCors=!0,c.retrieveAllskyTextures(),b&&b()},error:function(){c.retrieveAllskyTextures(),b&&b()}}):(this.retrieveAllskyTextures(),b())},c.DEFAULT_SURVEY_ID="P/DSS2/color",c.SURVEYS_OBJECTS={},c.SURVEYS=[{id:"P/2MASS/color",url:"http://alasky.u-strasbg.fr/2MASS/Color",name:"2MASS colored",maxOrder:9,frame:"equatorial",format:"jpeg"},{id:"P/DSS2/color",url:"http://alasky.u-strasbg.fr/DSS/DSSColor",name:"DSS colored",maxOrder:9,frame:"equatorial",format:"jpeg"},{id:"P/DSS2/red",url:"http://alasky.u-strasbg.fr/DSS/DSS2Merged",name:"DSS2 Red (F+R)",maxOrder:9,frame:"equatorial",format:"jpeg fits"},{id:"P/Fermi/color",url:"http://alasky.u-strasbg.fr/Fermi/Color",name:"Fermi color",maxOrder:3,frame:"equatorial",format:"jpeg"},{id:"P/Finkbeiner",url:"http://alasky.u-strasbg.fr/FinkbeinerHalpha",maxOrder:3,frame:"galactic",format:"jpeg fits",name:"Halpha"},{id:"P/GALEXGR6/AIS/color",url:"http://alasky.u-strasbg.fr/GALEX/GR6-02-Color",name:"GALEX Allsky Imaging Survey colored",maxOrder:8,frame:"equatorial",format:"jpeg"},{id:"P/IRIS/color",url:"http://alasky.u-strasbg.fr/IRISColor",name:"IRIS colored",maxOrder:3,frame:"galactic",format:"jpeg"},{id:"P/Mellinger/color",url:"http://alasky.u-strasbg.fr/MellingerRGB",name:"Mellinger colored",maxOrder:4,frame:"galactic",format:"jpeg"},{id:"P/SDSS9/color",url:"http://alasky.u-strasbg.fr/SDSS/DR9/color",name:"SDSS9 colored",maxOrder:10,frame:"equatorial",format:"jpeg"},{id:"P/SPITZER/color",url:"http://alasky.u-strasbg.fr/SpitzerI1I2I4color",name:"IRAC color I1,I2,I4 - (GLIMPSE, SAGE, SAGE-SMC, SINGS)",maxOrder:9,frame:"galactic",format:"jpeg"},{id:"P/VTSS/Ha",url:"http://alasky.u-strasbg.fr/VTSS/Ha",maxOrder:3,frame:"galactic",format:"png jpeg fits",name:"VTSS-Ha"},{id:"P/XMM/EPIC",url:"http://saada.u-strasbg.fr/xmmallsky",name:"XMM-Newton stacked EPIC images (no phot. normalization)",maxOrder:7,frame:"equatorial",format:"png fits"},{id:"P/XMM/PN/color",url:"http://saada.unistra.fr/xmmpnsky",name:"XMM PN colored",maxOrder:7,frame:"equatorial",format:"png jpeg"},{id:"P/allWISE/color",url:"http://alasky.u-strasbg.fr/AllWISE/RGB-W4-W2-W1/",name:"AllWISE color",maxOrder:8,frame:"equatorial",format:"jpeg"},{id:"P/GLIMPSE360",url:"http://www.spitzer.caltech.edu/glimpse360/aladin/data",name:"GLIMPSE360",maxOrder:9,frame:"equatorial",format:"jpeg"}],c.getAvailableSurveys=function(){return c.SURVEYS},c.getSurveyInfoFromId=function(a){for(var b=c.getAvailableSurveys(),d=0;b.length>d;d++)if(b[d].id==a)return b[d];return null},c.getSurveyFromId=function(a){if(c.SURVEYS_OBJECTS[a])return c.SURVEYS_OBJECTS[a];var b=c.getSurveyInfoFromId(a);if(b){var d={};return b.format&&0>b.format.indexOf("jpeg")&&b.format.indexOf("png")>=0&&(d.imgFormat="png"),new c(b.id,b.name,b.url,b.frame,b.maxOrder,d)}return null},c.prototype.getTileURL=function(a,b){var c=1e4*Math.floor(b/1e4);return this.rootUrl+"/Norder"+a+"/Dir"+c+"/Npix"+b+"."+this.imgFormat},c.prototype.retrieveAllskyTextures=function(){var a=new Image;this.useCors&&(a.crossOrigin="anonymous");var b=this;a.onload=function(){b.allskyTextureSize=a.width/27,b.allskyTexture=a,b.view.requestRedraw()},a.src=this.rootUrl+"/Norder3/Allsky."+this.imgFormat},c.prototype.draw=function(a,b,c,d){c=void 0!==c&&c;var e=b.getVisibleCells(3,this.cooFrame),f=null,g=Math.min(d,this.maxOrder);return d>=3&&(f=3==d?e:b.getVisibleCells(g,this.cooFrame)),c?void(d>=3?this.drawHighres(a,f,g,b):this.drawAllsky(a,e,g,b)):void(b.curNorder>=3?this.redrawHighres(a,f,b.curNorder):this.redrawAllsky(a,e,b.fov,b.curNorder))},c.prototype.drawHighres=function(a,b,c,d){for(var e=[],f=this.tileSize||512,g=0;b.length>g;g++)e.push(new HpxKey(c,b[g].ipix,this,f,f));for(var g=0;e.length>g;g++)e[g].draw(a,d)},c.prototype.drawAllsky=function(a,b,c,d){if(!(this.view.curNorder>6)&&this.allskyTexture&&Tile.isImageOk(this.allskyTexture)){for(var e,f,g,h,i=[],j=0;b.length>j;j++)e=b[j],f=e.ipix,h=this.allskyTextureSize*Math.floor(f/27),g=this.allskyTextureSize*(f-27*Math.floor(f/27)),i.push(new HpxKey(3,b[j].ipix,this,this.allskyTextureSize,this.allskyTextureSize,g,h,this.allskyTexture,this.allskyTextureSize));for(var j=0;i.length>j;j++)i[j].draw(a,d)}},c.prototype.redrawAllsky=function(a,b,c){if(!(this.view.curNorder>6)&&this.allskyTexture)for(var d,e,f,g=0,h=0,i=b.length;i>h;h++)if(d=b[h],f=d.ipix,this.allskyTexture&&Tile.isImageOk(this.allskyTexture)){var j=this.allskyTextureSize*Math.floor(f/27),k=this.allskyTextureSize*(f-27*Math.floor(f/27));if(c>40){g=.02,g=0,e={x:(d[0].vx+d[2].vx)/2,y:(d[0].vy+d[2].vy)/2};for(var l=0;4>l;l++){var m={x:d[l].vx-e.x,y:d[l].vy-e.y};d[l].vx+=g*m.x,d[l].vy+=g*m.y}}this.drawOneTile(a,this.allskyTexture,d,this.allskyTextureSize,null,k,j,!0)}},c.prototype.getColorMap=function(){return this.cm};var d=!0;return c.prototype.redrawHighres=function(a,b,e){if(0!=b.length){d=!d;var f,g,h,i,j,k,l,m,n=(new Date).getTime(),o=n-this.lastUpdateDateNeededTiles>c.UPDATE_NEEDED_TILES_DELAY,p=e-1,q=[],r=[],s={},t=!1,u=[],v=[];if(o){var w=[(b[0][0].vx+b[0][1].vx)/2,(b[0][0].vy+b[0][1].vy)/2],x=b.sort(function(a,b){var c=[(a[0].vx+a[2].vx)/2,(a[0].vy+a[2].vy)/2],d=[(b[0].vx+b[2].vx)/2,(b[0].vy+b[2].vy)/2],e=(c[0]-w[0])*(c[0]-w[0])+(c[1]-w[1])*(c[1]-w[1]),f=(d[0]-w[0])*(d[0]-w[0])+(d[1]-w[1])*(d[1]-w[1]);return e-f});b=x}for(var y=0,z=b.length;z>y;y++)if(j=b[y],m=j.ipix,l=~~(m/4),i=this.getTileURL(p,l),o&&p>=3&&(h=this.tileBuffer.addTile(i),h&&v.push({img:h.img,url:i})),g=this.getTileURL(e,m),f=this.tileBuffer.getTile(g))Tile.isImageOk(f.img)?q.push({img:f.img,corners:j}):(t=!0,o&&!f.img.dlError&&u.push({img:f.img,url:g}),p>=3&&!s[l]&&(h=this.tileBuffer.getTile(i),h&&Tile.isImageOk(h.img)&&(k=this.view.getPositionsInView(l,p),k&&r.push({img:h.img,corners:k,ipix:l})),s[l]=1));else{if(t=!0,o){var f=this.tileBuffer.addTile(g);f&&u.push({img:f.img,url:g})}p>=3&&!s[l]&&(h=this.tileBuffer.getTile(i),h&&Tile.isImageOk(h.img)&&(k=this.view.getPositionsInView(l,p),k&&r.push({img:h.img,corners:k,ipix:l})),s[l]=1)}for(var y=0,z=r.length;z>y;y++)this.drawOneTile(a,r[y].img,r[y].corners,r[y].img.width);for(var y=0,z=q.length;z>y;y++){var A=null,B=q[y].img;B.fadingStart&&B.fadingEnd&&B.fadingEnd>n&&(A=.2+.8*((n-B.fadingStart)/(B.fadingEnd-B.fadingStart))),this.drawOneTile(a,B,q[y].corners,B.width,A)}if(o){for(var y=0,z=u.length;z>y;y++)this.view.downloader.requestDownload(u[y].img,u[y].url,this.useCors);for(var y=0,z=v.length;z>y;y++)this.view.downloader.requestDownload(v[y].img,v[y].url,this.useCors);this.lastUpdateDateNeededTiles=n}t&&this.view.requestRedrawAtDate(n+c.UPDATE_NEEDED_TILES_DELAY+10)}},c.prototype.drawOneTile=function(a,c,d,e,f,g,h,i){var j=this.useCors?this.cm.apply(c):c;b(a,j,d[0].vx,d[0].vy,d[1].vx,d[1].vy,d[3].vx,d[3].vy,e-1,e-1,e-1,0,0,e-1,f,g,h,i),b(a,j,d[1].vx,d[1].vy,d[3].vx,d[3].vy,d[2].vx,d[2].vy,e-1,0,0,e-1,0,0,f,g,h,i)},c.prototype.drawOneTile2=function(b,c,d,e,f,g,h,i,j){var k=this.useCors?this.cm.apply(c):c,l=3>=j?.2:0;a(b,k,d[0].vx,d[0].vy,d[1].vx,d[1].vy,d[3].vx,d[3].vy,e-l,e-l,e-l,0+l,0+l,e-l,f,g,h,i,j),a(b,k,d[1].vx,d[1].vy,d[3].vx,d[3].vy,d[2].vx,d[2].vy,e-l,0+l,0+l,e-l,0+l,0+l,f,g,h,i,j)},c.prototype.setAlpha=function(a){a=+a,this.alpha=Math.max(0,Math.min(a,1)),this.view.requestRedraw()},c.prototype.getAlpha=function(){return this.alpha},c}(),HealpixGrid=function(){var a=function(){};return a.prototype.redraw=function(a,b,c,d){a.lineWidth=1,a.strokeStyle="rgb(150,150,220)",a.beginPath();for(var e,f=0,g=b.length;g>f;f++)e=b[f],ipix=e.ipix,a.moveTo(e[0].vx,e[0].vy),a.lineTo(e[1].vx,e[1].vy),a.lineTo(e[2].vx,e[2].vy);a.stroke(),a.strokeStyle="#FFDDDD",a.beginPath();for(var f=0,g=b.length;g>f;f++)e=b[f],ipix=e.ipix,a.strokeText(d+"/"+ipix,(e[0].vx+e[2].vx)/2,(e[0].vy+e[2].vy)/2);a.stroke()},a}(),Location=function(){return Location=function(a){this.$div=$(a)},Location.prototype.update=function(a,b,c,d){d=d&&d===!0||!1;var e=new Coo(a,b,7);c==CooFrameEnum.J2000?this.$div.html(e.format("s/")):this.$div.html(e.format("d/")),this.$div.toggleClass("aladin-reticleColor",d)},Location}(),View=function(){function a(b,c,e,f,g){this.aladin=b,this.options=b.options,this.aladinDiv=this.aladin.aladinDiv,this.popup=new Popup(this.aladinDiv),this.createCanvases(),this.location=c,this.fovDiv=e,this.mustClearCatalog=!0,this.mustRedrawReticle=!0,this.mode=a.PAN,this.minFOV=this.maxFOV=null,this.healpixGrid=new HealpixGrid(this.imageCanvas),this.cooFrame=f?f:CooFrameEnum.GAL;var h,i;h=i=0,this.projectionMethod=ProjectionEnum.SIN,this.projection=new Projection(h,i),this.projection.setProjection(this.projectionMethod),this.zoomLevel=0,this.zoomFactor=this.computeZoomFactor(this.zoomLevel),this.viewCenter={lon:h,lat:i},g&&this.setZoom(g),this.imageSurvey=null,this.catalogs=[],this.overlays=[],this.mocs=[],this.tileBuffer=new TileBuffer,this.fixLayoutDimensions(),this.curNorder=1,this.realNorder=1,this.curOverlayNorder=1,this.dragging=!1,this.dragx=null,this.dragy=null,this.needRedraw=!0,this.downloader=new Downloader(this),this.flagForceRedraw=!1,this.fadingLatestUpdate=null,this.dateRequestRedraw=null,this.showGrid=!1,d(this),this.resizeTimer=null;var j=this;$(window).resize(function(){clearTimeout(j.resizeTimer),j.resizeTimer=setTimeout(function(){j.fixLayoutDimensions(j)},100)})}function b(a,b,c,d){if(a.projection){var e,f=AladinUtils.viewToXy(b,c,a.width,a.height,a.largestDim,a.zoomFactor);try{e=a.projection.unproject(f.x,f.y)}catch(a){}e&&a.location.update(e.ra,e.dec,a.cooFrame,d)}}a.PAN=0,a.SELECT=1,a.DRAW_SOURCES_WHILE_DRAGGING=!0,a.DRAW_MOCS_WHILE_DRAGGING=!0,a.prototype.createCanvases=function(){var a=$(this.aladinDiv);a.find(".aladin-imageCanvas").remove(),a.find(".aladin-catalogCanvas").remove(),a.find(".aladin-reticleCanvas").remove(),this.imageCanvas=$("<canvas class='aladin-imageCanvas'></canvas>").appendTo(this.aladinDiv)[0],this.catalogCanvas=$("<canvas class='aladin-catalogCanvas'></canvas>").appendTo(this.aladinDiv)[0],this.reticleCanvas=$("<canvas class='aladin-reticleCanvas'></canvas>").appendTo(this.aladinDiv)[0]},a.prototype.fixLayoutDimensions=function(){Utils.cssScale=void 0,this.width=$(this.aladinDiv).width(),this.height=$(this.aladinDiv).height(),this.width=Math.max(this.width,1),this.height=Math.max(this.height,1),this.cx=this.width/2,this.cy=this.height/2,this.largestDim=Math.max(this.width,this.height),this.smallestDim=Math.min(this.width,this.height),this.ratio=this.largestDim/this.smallestDim,this.mouseMoveIncrement=160/this.largestDim,this.imageCtx=this.imageCanvas.getContext("2d"),this.catalogCtx=this.catalogCanvas.getContext("2d"),this.reticleCtx=this.reticleCanvas.getContext("2d"),this.imageCtx.canvas.width=this.width,this.catalogCtx.canvas.width=this.width,this.reticleCtx.canvas.width=this.width,this.imageCtx.canvas.height=this.height,this.catalogCtx.canvas.height=this.height,this.reticleCtx.canvas.height=this.height,c(this.imageCtx),this.logoDiv||(this.logoDiv=$(this.aladinDiv).find(".aladin-logo")[0]),this.width>800?($(this.logoDiv).removeClass("aladin-logo-small"),$(this.logoDiv).addClass("aladin-logo-large"),$(this.logoDiv).css("width","90px")):($(this.logoDiv).addClass("aladin-logo-small"),$(this.logoDiv).removeClass("aladin-logo-large"),$(this.logoDiv).css("width","32px")),this.computeNorder(),this.requestRedraw()};var c=function(a){a.imageSmoothingEnabled=!1,a.webkitImageSmoothingEnabled=!1,a.mozImageSmoothingEnabled=!1,a.msImageSmoothingEnabled=!1,a.oImageSmoothingEnabled=!1};a.prototype.setMode=function(b){this.mode=b,this.mode==a.SELECT?this.setCursor("crosshair"):this.setCursor("default")},a.prototype.setCursor=function(a){this.reticleCanvas.style.cursor!=a&&(this.reticleCanvas.style.cursor=a)},a.prototype.getCanvasDataURL=function(a){a=a||"image/png";var b=document.createElement("canvas");b.width=this.width,b.height=this.height;var c=b.getContext("2d");return c.drawImage(this.imageCanvas,0,0),c.drawImage(this.catalogCanvas,0,0),c.drawImage(this.reticleCanvas,0,0),b.toDataURL(a)},computeFov=function(a){var b=doComputeFov(a,a.zoomFactor);return a.mouseMoveIncrement=b/a.imageCanvas.width,b},doComputeFov=function(a,b){if(1>a.zoomFactor)fov=180;else{var c=AladinUtils.viewToXy(0,a.cy,a.width,a.height,a.largestDim,b),d=a.projection.unproject(c.x,c.y),e=AladinUtils.viewToXy(a.imageCanvas.width-1,a.cy,a.width,a.height,a.largestDim,b),f=a.projection.unproject(e.x,e.y);fov=new Coo(d.ra,d.dec).distance(new Coo(f.ra,f.dec))}return fov},updateFovDiv=function(a){if(isNaN(a.fov))return void a.fovDiv.html("FoV:");var b;b=a.fov>1?Math.round(100*a.fov)/100+"":60*a.fov>1?Math.round(6e3*a.fov)/100+"'":Math.round(36e4*a.fov)/100+'"',a.fovDiv.html("FoV: "+b)},createListeners=function(c){var d=!1;"ontouchstart"in window&&(d=!0),onDblClick=function(a){var b=c.imageCanvas.relMouseCoords(a),d=AladinUtils.viewToXy(b.x,b.y,c.width,c.height,c.largestDim,c.zoomFactor);try{var e=c.projection.unproject(d.x,d.y)}catch(a){return}radec=[],radec=c.cooFrame==CooFrameEnum.GAL?CooConversion.GalacticToJ2000([e.ra,e.dec]):[e.ra,e.dec],c.pointTo(radec[0],radec[1])},d||$(c.reticleCanvas).dblclick(onDblClick),$(c.reticleCanvas).bind("mousedown touchstart",function(b){var d=c.imageCanvas.relMouseCoords(b);return b.originalEvent&&b.originalEvent.targetTouches?(c.dragx=b.originalEvent.targetTouches[0].clientX,c.dragy=b.originalEvent.targetTouches[0].clientY):(c.dragx=d.x,c.dragy=d.y),c.dragging=!0,c.mode==a.PAN?c.setCursor("move"):c.mode==a.SELECT&&(c.selectStartCoo={x:c.dragx,y:c.dragy}),!1});var e;$(c.reticleCanvas).bind("click mouseout touchend",function(d){if(c.mode==a.SELECT&&c.dragging&&c.aladin.fire("selectend",c.getObjectsInBBox(c.selectStartCoo.x,c.selectStartCoo.y,c.dragx-c.selectStartCoo.x,c.dragy-c.selectStartCoo.y)),c.dragging&&(c.setCursor("default"),c.dragging=!1),c.mustClearCatalog=!0,c.mustRedrawReticle=!0,c.dragx=c.dragy=null,"mouseout"===d.type)return c.requestRedraw(!0),void b(c,c.width/2,c.height/2,!0);var f=c.imageCanvas.relMouseCoords(d),g=c.closestObjects(f.x,f.y,5);if(g){var h=g[0];h.marker?(c.popup.setTitle(h.popupTitle),c.popup.setText(h.popupDesc),c.popup.setSource(h),c.popup.show()):(c.aladin.objClickedFunction&&c.aladin.objClickedFunction(h),e&&e.actionOtherObjectClicked(),h.actionClicked(),e=h)}else e&&(c.aladin.measurementTable.hide(),e.actionOtherObjectClicked(),e=null,c.aladin.objClickedFunction&&c.aladin.objClickedFunction(null));
c.refreshProgressiveCats(),c.requestRedraw(!0)});var f;$(c.reticleCanvas).bind("mousemove touchmove",function(e){e.preventDefault();var g=c.imageCanvas.relMouseCoords(e);if(!c.dragging||d){if(b(c,g.x,g.y),!c.dragging&&!c.mode==a.SELECT){var h=c.closestObjects(g.x,g.y,5);h?(c.setCursor("pointer"),c.aladin.objHoveredFunction&&h[0]!=f&&c.aladin.objHoveredFunction(h[0]),f=h[0]):(c.setCursor("default"),c.aladin.objHoveredFunction&&f&&(f=null,c.aladin.objHoveredFunction(null)))}if(!d)return}var i,j,k,l;if(e.originalEvent&&e.originalEvent.targetTouches){i=e.originalEvent.targetTouches[0].clientX-c.dragx,j=e.originalEvent.targetTouches[0].clientY-c.dragy;var m=AladinUtils.viewToXy(e.originalEvent.targetTouches[0].clientX,e.originalEvent.targetTouches[0].clientY,c.width,c.height,c.largestDim,c.zoomFactor),n=AladinUtils.viewToXy(c.dragx,c.dragy,c.width,c.height,c.largestDim,c.zoomFactor);k=c.projection.unproject(m.x,m.y),l=c.projection.unproject(n.x,n.y)}else{i=g.x-c.dragx,j=g.y-c.dragy;var m=AladinUtils.viewToXy(g.x,g.y,c.width,c.height,c.largestDim,c.zoomFactor),n=AladinUtils.viewToXy(c.dragx,c.dragy,c.width,c.height,c.largestDim,c.zoomFactor);k=c.projection.unproject(m.x,m.y),l=c.projection.unproject(n.x,n.y)}return e.originalEvent&&e.originalEvent.targetTouches?(c.dragx=e.originalEvent.targetTouches[0].clientX,c.dragy=e.originalEvent.targetTouches[0].clientY):(c.dragx=g.x,c.dragy=g.y),c.mode==a.SELECT?void c.requestRedraw():(c.viewCenter.lon+=l.ra-k.ra,c.viewCenter.lat+=l.dec-k.dec,c.viewCenter.lat>90?c.viewCenter.lat=90:-90>c.viewCenter.lat&&(c.viewCenter.lat=-90),0>c.viewCenter.lon?c.viewCenter.lon=360+c.viewCenter.lon:c.viewCenter.lon>360&&(c.viewCenter.lon=c.viewCenter.lon%360),void c.requestRedraw())}),$(c.aladinDiv).onselectstart=function(){return!1},$(c.reticleCanvas).on("mousewheel",function(a){a.preventDefault(),a.stopPropagation();var b=c.zoomLevel,d=a.deltaY;return d>0?b+=1:b-=1,c.setZoomLevel(b),!1})};var d=function(a){var b=new Stats;b.domElement.style.top="50px",$("#aladin-statsDiv").length>0&&$("#aladin-statsDiv")[0].appendChild(b.domElement),a.stats=b,createListeners(a),a.displayHpxGrid=!1,a.displaySurvey=!0,a.displayCatalog=!1,a.displayReticle=!0,a.fov=computeFov(a),updateFovDiv(a),a.redraw()};a.prototype.requestRedrawAtDate=function(a){this.dateRequestDraw=a},a.prototype.getBackgroundColor=function(){var a="rgb(255, 255, 255)",b="rgb(0, 0, 0)";if(!this.imageSurvey)return b;var c=this.imageSurvey.getColorMap();if(!c)return b;if("native"==c.mapName||"grayscale"==c.mapName)return c.reversed?a:b;var d=c.reversed?255:0,e=ColorMap.MAPS[c.mapName].r[d],f=ColorMap.MAPS[c.mapName].g[d],g=ColorMap.MAPS[c.mapName].b[d];return"rgb("+e+","+f+","+g+")"},a.prototype.getViewParams=function(){var a=this.width>this.height?this.fov/this.width:this.fov/this.height;return{fov:[this.width*a,this.height*a],width:this.width,height:this.height}},a.prototype.redraw=function(){var b=this.needRedraw;requestAnimFrame(this.redraw.bind(this));var c=(new Date).getTime();if(this.dateRequestDraw&&c>this.dateRequestDraw)this.dateRequestDraw=null;else if(!this.needRedraw){if(!this.flagForceRedraw)return;this.flagForceRedraw=!1}this.stats.update();var d=this.imageCtx;d.clearRect(0,0,this.imageCanvas.width,this.imageCanvas.height);var e=this.getBackgroundColor();this.projectionMethod==ProjectionEnum.SIN&&(this.fov>80?(d.fillStyle=e,d.beginPath(),d.arc(this.cx,this.cy,this.cx*this.zoomFactor,0,2*Math.PI,!0),d.fill()):60>this.fov?(d.fillStyle=e,d.fillRect(0,0,this.imageCanvas.width,this.imageCanvas.height)):(d.fillStyle=e,d.beginPath(),d.arc(this.cx,this.cy,this.cx*this.zoomFactor,0,2*Math.PI,!0),d.fill())),this.projection?this.projection.setCenter(this.viewCenter.lon,this.viewCenter.lat):this.projection=new Projection(this.viewCenter.lon,this.viewCenter.lat),this.projection.setProjection(this.projectionMethod);var f=null;if(this.imageSurvey&&this.imageSurvey.isReady&&this.displaySurvey&&(null==this.aladin.reduceDeformations?this.imageSurvey.draw(d,this,!this.dragging,this.curNorder):this.imageSurvey.draw(d,this,this.aladin.reduceDeformations,this.curNorder)),this.overlayImageSurvey&&this.overlayImageSurvey.isReady&&(d.globalAlpha=this.overlayImageSurvey.getAlpha(),null==this.aladin.reduceDeformations?this.overlayImageSurvey.draw(d,this,!this.dragging,this.curOverlayNorder):this.overlayImageSurvey.draw(d,this,this.aladin.reduceDeformations,this.curOverlayNorder),d.globalAlpha=1),this.displayHpxGrid){var g=this.getVisibleCells(3),f=null;this.curNorder>=3&&(f=3==this.curNorder?g:this.getVisibleCells(this.curNorder)),f&&this.curNorder>3?this.healpixGrid.redraw(d,f,this.fov,this.curNorder):this.healpixGrid.redraw(d,g,this.fov,3)}this.showGrid&&(null==this.cooGrid&&(this.cooGrid=new CooGrid),this.cooGrid.redraw(d,this.projection,this.cooFrame,this.width,this.height,this.largestDim,this.zoomFactor,this.fov));var h=this.catalogCtx,i=!1;if(this.mustClearCatalog&&(h.clearRect(0,0,this.width,this.height),i=!0,this.mustClearCatalog=!1),this.catalogs&&this.catalogs.length>0&&this.displayCatalog&&(!this.dragging||a.DRAW_SOURCES_WHILE_DRAGGING)){i||(h.clearRect(0,0,this.width,this.height),i=!0);for(var j=0;this.catalogs.length>j;j++){var k=this.catalogs[j];k.draw(h,this.projection,this.cooFrame,this.width,this.height,this.largestDim,this.zoomFactor)}}var l=this.catalogCtx;if(this.overlays&&this.overlays.length>0&&(!this.dragging||a.DRAW_SOURCES_WHILE_DRAGGING)){i||(h.clearRect(0,0,this.width,this.height),i=!0);for(var j=0;this.overlays.length>j;j++)this.overlays[j].draw(l,this.projection,this.cooFrame,this.width,this.height,this.largestDim,this.zoomFactor)}var m=this.catalogCtx;if(this.mocs&&this.mocs.length>0&&(!this.dragging||a.DRAW_MOCS_WHILE_DRAGGING)){i||(h.clearRect(0,0,this.width,this.height),i=!0);for(var j=0;this.mocs.length>j;j++)this.mocs[j].draw(m,this.projection,this.cooFrame,this.width,this.height,this.largestDim,this.zoomFactor,this.fov)}this.mode==a.SELECT&&(mustRedrawReticle=!0);var n=this.reticleCtx;if((this.mustRedrawReticle||this.mode==a.SELECT)&&n.clearRect(0,0,this.width,this.height),this.displayReticle){if(!this.reticleCache){var o=document.createElement("canvas"),p=this.options.reticleSize;o.width=p,o.height=p;var q=o.getContext("2d");q.lineWidth=2,q.strokeStyle=this.options.reticleColor,q.beginPath(),q.moveTo(p/2,p/2+(p/2-1)),q.lineTo(p/2,p/2+2),q.moveTo(p/2,p/2-(p/2-1)),q.lineTo(p/2,p/2-2),q.moveTo(p/2+(p/2-1),p/2),q.lineTo(p/2+2,p/2),q.moveTo(p/2-(p/2-1),p/2),q.lineTo(p/2-2,p/2),q.stroke(),this.reticleCache=o}n.drawImage(this.reticleCache,this.width/2-this.reticleCache.width/2,this.height/2-this.reticleCache.height/2),this.mustRedrawReticle=!1}if(this.mode==a.SELECT&&this.dragging){n.fillStyle="rgba(100, 240, 110, 0.25)";var r=this.dragx-this.selectStartCoo.x,s=this.dragy-this.selectStartCoo.y;n.fillRect(this.selectStartCoo.x,this.selectStartCoo.y,r,s)}b==this.needRedraw&&(this.needRedraw=!1),this.dragging||this.updateObjectsLookup()},a.prototype.forceRedraw=function(){this.flagForceRedraw=!0},a.prototype.refreshProgressiveCats=function(){if(this.catalogs)for(var a=0;this.catalogs.length>a;a++)"progressivecat"==this.catalogs[a].type&&this.catalogs[a].loadNeededTiles()},a.prototype.getVisiblePixList=function(a,b){var c,d=Math.pow(2,a),e=HealpixIndex.nside2Npix(d);if(this.fov>80){c=[];for(var f=0;e>f;f++)c.push(f)}else{var g=new HealpixIndex(d);g.init();var h=new SpatialVector,i=AladinUtils.viewToXy(this.cx,this.cy,this.width,this.height,this.largestDim,this.zoomFactor),j=this.projection.unproject(i.x,i.y),k=[];b&&b!=this.cooFrame?b==CooFrameEnum.J2000?k=CooConversion.GalacticToJ2000([j.ra,j.dec]):b==CooFrameEnum.GAL&&(k=CooConversion.J2000ToGalactic([j.ra,j.dec])):k=[j.ra,j.dec],h.set(k[0],k[1]);var l=.5*this.fov*this.ratio;l*=this.fov>60?1.6:this.fov>12?1.45:1.1,c=g.queryDisc(h,l*Math.PI/180,!0,!0);var m=Utils.radecToPolar(k[0],k[1]);ipixCenter=g.ang2pix_nest(m.theta,m.phi),c.unshift(ipixCenter)}return c},a.prototype.getVisibleCells=function(a,b){!b&&this.imageSurvey&&(b=this.imageSurvey.cooFrame);var c,d=[],e=[],f=new SpatialVector,g=Math.pow(2,a),h=HealpixIndex.nside2Npix(g),i=null;if(this.fov>80){c=[];for(var j=0;h>j;j++)c.push(j)}else{var k=new HealpixIndex(g);k.init();var l=new SpatialVector,m=AladinUtils.viewToXy(this.cx,this.cy,this.width,this.height,this.largestDim,this.zoomFactor),n=this.projection.unproject(m.x,m.y),o=[];b&&b!=this.cooFrame?b==CooFrameEnum.J2000?o=CooConversion.GalacticToJ2000([n.ra,n.dec]):b==CooFrameEnum.GAL&&(o=CooConversion.J2000ToGalactic([n.ra,n.dec])):o=[n.ra,n.dec],l.set(o[0],o[1]);var p=.5*this.fov*this.ratio;p*=this.fov>60?1.6:this.fov>12?1.45:1.1,c=k.queryDisc(l,p*Math.PI/180,!0,!0);var q=Utils.radecToPolar(o[0],o[1]);i=k.ang2pix_nest(q.theta,q.phi),c.unshift(i)}for(var j,r,s,t=0,u=c.length;u>t;t++)if(j=c[t],!(j==i&&t>0)){var v=[];corners=HealpixCache.corners_nest(j,g);for(var w=0;4>w;w++){if(f.setXYZ(corners[w].x,corners[w].y,corners[w].z),b&&b!=this.cooFrame){if(b==CooFrameEnum.J2000){var n=CooConversion.J2000ToGalactic([f.ra(),f.dec()]);r=n[0],s=n[1]}else if(b==CooFrameEnum.GAL){var n=CooConversion.GalacticToJ2000([f.ra(),f.dec()]);r=n[0],s=n[1]}}else r=f.ra(),s=f.dec();e[w]=this.projection.project(r,s)}if(null!=e[0]&&null!=e[1]&&null!=e[2]&&null!=e[3]){for(var w=0;4>w;w++)v[w]=AladinUtils.xyToView(e[w].X,e[w].Y,this.width,this.height,this.largestDim,this.zoomFactor);if(!(0>v[0].vx&&0>v[1].vx&&0>v[2].vx&&0>v[3].vx||0>v[0].vy&&0>v[1].vy&&0>v[2].vy&&0>v[3].vy||v[0].vx>=this.width&&v[1].vx>=this.width&&v[2].vx>=this.width&&v[3].vx>=this.width||v[0].vy>=this.height&&v[1].vy>=this.height&&v[2].vy>=this.height&&v[3].vy>=this.height)){if(this.projection.PROJECTION==ProjectionEnum.AITOFF){var x=v[0].vx-v[2].vx,y=v[0].vy-v[2].vy,z=Math.sqrt(x*x+y*y);if(z>this.largestDim/5)continue;if(x=v[1].vx-v[3].vx,y=v[1].vy-v[3].vy,z=Math.sqrt(x*x+y*y),z>this.largestDim/5)continue}v.ipix=j,d.push(v)}}}return d},a.prototype.getPositionsInView=function(a,b){for(var c,d,e=[],f=new SpatialVector,g=Math.pow(2,b),h=[],i=HealpixCache.corners_nest(a,g),j=0;4>j;j++){if(f.setXYZ(i[j].x,i[j].y,i[j].z),this.imageSurvey&&this.imageSurvey.cooFrame!=this.cooFrame){if(this.imageSurvey.cooFrame==CooFrameEnum.J2000){var k=CooConversion.J2000ToGalactic([f.ra(),f.dec()]);c=k[0],d=k[1]}else if(this.imageSurvey.cooFrame==CooFrameEnum.GAL){var k=CooConversion.GalacticToJ2000([f.ra(),f.dec()]);c=k[0],d=k[1]}}else c=f.ra(),d=f.dec();e[j]=this.projection.project(c,d)}if(null==e[0]||null==e[1]||null==e[2]||null==e[3])return null;for(var j=0;4>j;j++)h[j]=AladinUtils.xyToView(e[j].X,e[j].Y,this.width,this.height,this.largestDim,this.zoomFactor);return h},a.prototype.computeZoomFactor=function(a){return a>0?AladinUtils.getZoomFactorForAngle(180/Math.pow(1.15,a),this.projectionMethod):1+.1*a},a.prototype.setZoom=function(a){if(!(0>a||a>180)){var b=Math.log(180/a)/Math.log(1.15);this.setZoomLevel(b)}},a.prototype.setShowGrid=function(a){this.showGrid=a,this.requestRedraw()},a.prototype.setZoomLevel=function(a){if(this.minFOV||this.maxFOV){var b=doComputeFov(this,this.computeZoomFactor(Math.max(-2,a)));if(this.maxFOV&&b>this.maxFOV||this.minFOV&&this.minFOV>b)return}if(this.zoomLevel=this.projectionMethod==ProjectionEnum.SIN?this.aladin.options.allowFullZoomout===!0?this.width/this.height>2?Math.max(-7,a):.5>this.width/this.height?Math.max(-2,a):Math.max(-6,a):Math.max(-2,a):Math.max(-7,a),this.zoomFactor=this.computeZoomFactor(this.zoomLevel),this.fov=computeFov(this),updateFovDiv(this),this.computeNorder(),this.forceRedraw(),this.requestRedraw(),!this.debounceProgCatOnZoom){var c=this;this.debounceProgCatOnZoom=Utils.debounce(function(){c.refreshProgressiveCats()},300)}this.debounceProgCatOnZoom()},a.prototype.computeNorder=function(){var a=this.fov/this.largestDim,b=512,c=HealpixIndex.calculateNSide(3600*b*a),d=Math.log(c)/Math.log(2);d=Math.max(d,1),this.realNorder=d,50>=this.fov&&2>=d&&(d=3),this.imageSurvey&&2>=d&&this.imageSurvey.minOrder>2&&(d=this.imageSurvey.minOrder);var e=d;this.imageSurvey&&d>this.imageSurvey.maxOrder&&(d=this.imageSurvey.maxOrder),this.overlayImageSurvey&&e>this.overlayImageSurvey.maxOrder&&(e=this.overlayImageSurvey.maxOrder),d>HealpixIndex.ORDER_MAX&&(d=HealpixIndex.ORDER_MAX),e>HealpixIndex.ORDER_MAX&&(e=HealpixIndex.ORDER_MAX),this.curNorder=d,this.curOverlayNorder=e},a.prototype.untaintCanvases=function(){this.createCanvases(),createListeners(this),this.fixLayoutDimensions()},a.prototype.setOverlayImageSurvey=function(a,b){if(!a)return this.overlayImageSurvey=null,void this.requestRedraw();$.support.cors&&this.overlayImageSurvey&&!this.overlayImageSurvey.useCors&&this.untaintCanvases();var c;"string"==typeof a?(c=HpxImageSurvey.getSurveyFromId(a),c||(c=HpxImageSurvey.getSurveyFromId(HpxImageSurvey.DEFAULT_SURVEY_ID))):c=a,c.isReady=!1,this.overlayImageSurvey=c;var d=this;c.init(this,function(){d.computeNorder(),c.isReady=!0,d.requestRedraw(),d.updateObjectsLookup(),b&&b()})},a.prototype.setUnknownSurveyIfNeeded=function(){e&&(this.setImageSurvey(e),e=void 0)};var e=void 0;return a.prototype.setImageSurvey=function(a,b){if(a){$.support.cors&&this.imageSurvey&&!this.imageSurvey.useCors&&this.untaintCanvases();var c;"string"==typeof a?(c=HpxImageSurvey.getSurveyFromId(a),c||(c=HpxImageSurvey.getSurveyFromId(HpxImageSurvey.DEFAULT_SURVEY_ID),e=a)):c=a,this.tileBuffer=new TileBuffer,c.isReady=!1,this.imageSurvey=c;var d=this;c.init(this,function(){d.computeNorder(),c.isReady=!0,d.requestRedraw(),d.updateObjectsLookup(),b&&b()})}},a.prototype.requestRedraw=function(){this.needRedraw=!0},a.prototype.changeProjection=function(a){this.projectionMethod=a,this.requestRedraw()},a.prototype.changeFrame=function(a){if(this.cooFrame=a,this.cooFrame==CooFrameEnum.GAL){var b=CooConversion.J2000ToGalactic([this.viewCenter.lon,this.viewCenter.lat]);this.viewCenter.lon=b[0],this.viewCenter.lat=b[1]}else if(this.cooFrame==CooFrameEnum.J2000){var c=CooConversion.GalacticToJ2000([this.viewCenter.lon,this.viewCenter.lat]);this.viewCenter.lon=c[0],this.viewCenter.lat=c[1]}this.requestRedraw()},a.prototype.showHealpixGrid=function(a){this.displayHpxGrid=a,this.requestRedraw()},a.prototype.showSurvey=function(a){this.displaySurvey=a,this.requestRedraw()},a.prototype.showCatalog=function(a){this.displayCatalog=a,this.displayCatalog||(this.mustClearCatalog=!0),this.requestRedraw()},a.prototype.showReticle=function(a){this.displayReticle=a,this.mustRedrawReticle=!0,this.requestRedraw()},a.prototype.pointTo=function(a,b){if(a=parseFloat(a),b=parseFloat(b),!isNaN(a)&&!isNaN(b)){if(this.cooFrame==CooFrameEnum.J2000)this.viewCenter.lon=a,this.viewCenter.lat=b;else if(this.cooFrame==CooFrameEnum.GAL){var c=CooConversion.J2000ToGalactic([a,b]);this.viewCenter.lon=c[0],this.viewCenter.lat=c[1]}this.location.update(this.viewCenter.lon,this.viewCenter.lat,this.cooFrame,!0),this.forceRedraw(),this.requestRedraw();var d=this;setTimeout(function(){d.refreshProgressiveCats()},1e3)}},a.prototype.makeUniqLayerName=function(a){if(!this.layerNameExists(a))return a;for(var b=1;;++b){var c=a+"_"+b;if(!this.layerNameExists(c))return c}},a.prototype.layerNameExists=function(a){for(var b=this.catalogs,c=0;b.length>c;c++)if(a==b[c].name)return!0;return!1},a.prototype.removeLayers=function(){this.catalogs=[],this.overlays=[],this.requestRedraw()},a.prototype.addCatalog=function(a){a.name=this.makeUniqLayerName(a.name),this.catalogs.push(a),"catalog"==a.type?a.setView(this):"progressivecat"==a.type&&a.init(this)},a.prototype.addOverlay=function(a){this.overlays.push(a),a.setView(this)},a.prototype.addMOC=function(a){this.mocs.push(a),a.setView(this)},a.prototype.getObjectsInBBox=function(a,b,c,d){0>c&&(a+=c,c=-c),0>d&&(b+=d,d=-d);var e,f,g,h=[];if(this.catalogs)for(var i=0;this.catalogs.length>i;i++)if(e=this.catalogs[i],e.isShowing){f=e.getSources();for(var j=0;f.length>j;j++)g=f[j],g.isShowing&&g.x&&g.y&&g.x>=a&&a+c>=g.x&&g.y>=b&&b+d>=g.y&&h.push(g)}return h},a.prototype.updateObjectsLookup=function(){this.objLookup=[];var a,b,c,d,e;if(this.catalogs)for(var f=0;this.catalogs.length>f;f++)if(a=this.catalogs[f],a.isShowing){b=a.getSources();for(var g=0;b.length>g;g++)c=b[g],c.isShowing&&c.x&&c.y&&(d=c.x,e=c.y,this.objLookup[d]||(this.objLookup[d]=[]),this.objLookup[d][e]||(this.objLookup[d][e]=[]),this.objLookup[d][e].push(c))}},a.prototype.closestObjects=function(a,b,c){if(!this.objLookup)return null;for(var d,e,f=0;c>=f;f++){d=e=null;for(var g=-c;c>=g;g++)if(this.objLookup[a+g])for(var h=-c;c>=h;h++)if(this.objLookup[a+g][b+h])if(d){var i=g*g+h*h;e>i&&(e=i,d=this.objLookup[a+g][b+h])}else d=this.objLookup[a+g][b+h];if(d)return d}return null},a}(),Aladin=function(){var a=function(b,c){if(0!=$(b).length){HealpixCache.init();var d=this;if(void 0===c&&(c=this.getOptionsFromQueryString()),c=c||{},"zoom"in c){var e=c.zoom;delete c.zoom,c.fov=e}var f={};for(var g in a.DEFAULT_OPTIONS)f[g]=void 0!==c[g]?c[g]:a.DEFAULT_OPTIONS[g];for(var g in c)void 0===a.DEFAULT_OPTIONS[g]&&(f[g]=c[g]);this.options=f,$("<style type='text/css'> .aladin-reticleColor { color: "+this.options.reticleColor+"; font-weight:bold;} </style>").appendTo(b),this.aladinDiv=b,this.reduceDeformations=!0,$(b).addClass("aladin-container");var h=CooFrameEnum.fromString(f.cooFrame,CooFrameEnum.J2000),i=h==CooFrameEnum.J2000,j=$('<div class="aladin-location">'+(f.showFrame?'<select class="aladin-frameChoice"><option value="'+CooFrameEnum.J2000+'" '+(i?'selected="selected"':"")+'>J2000</option><option value="'+CooFrameEnum.GAL+'" '+(i?"":'selected="selected"')+">GAL</option></select>":"")+'<span class="aladin-location-text"></span></div>').appendTo(b),k=$('<div class="aladin-fov"></div>').appendTo(b);f.showZoomControl&&$('<div class="aladin-zoomControl"><a href="#" class="zoomPlus" title="Zoom in">+</a><a href="#" class="zoomMinus" title="Zoom out">&ndash;</a></div>').appendTo(b),f.showFullscreenControl&&$('<div class="aladin-fullscreenControl aladin-maximize" title="Full screen"></div>').appendTo(b),this.fullScreenBtn=$(b).find(".aladin-fullscreenControl"),this.fullScreenBtn.click(function(){d.toggleFullscreen()}),$("<div class='aladin-logo-container'><a href='http://aladin.unistra.fr/' title='Powered by Aladin Lite' target='_blank'><div class='aladin-logo'></div></a></div>").appendTo(b),this.boxes=[],this.measurementTable=new MeasurementTable(b);var l=new Location(j.find(".aladin-location-text"));if(this.view=new View(this,l,k,h,f.fov),this.view.setShowGrid(f.showCooGrid),$.ajax({url:"http://aladin.unistra.fr/java/nph-aladin.pl",data:{frame:"aladinLiteDic"},method:"GET",dataType:"jsonp",success:function(a){for(var b={},c=0;a.length>c;c++)b[a[c].id]=!0;for(var c=0;HpxImageSurvey.SURVEYS.length>c;c++)b[HpxImageSurvey.SURVEYS[c].id]||a.push(HpxImageSurvey.SURVEYS[c]);HpxImageSurvey.SURVEYS=a,d.view.setUnknownSurveyIfNeeded()},error:function(){}}),f.showLayersControl){var m=$('<div class="aladin-layersControl-container" title="Manage layers"><div class="aladin-layersControl"></div></div>');m.appendTo(b);var n=$('<div class="aladin-box aladin-layerBox aladin-cb-list"></div>');n.appendTo(b),this.boxes.push(n),m.click(function(){return d.hideBoxes(),d.showLayerBox(),!1})}if(f.showGotoControl){var m=$('<div class="aladin-gotoControl-container" title="Go to position"><div class="aladin-gotoControl"></div></div>');m.appendTo(b);var o=$('<div class="aladin-box aladin-gotoBox"><a class="aladin-closeBtn">&times;</a><div style="clear: both;"></div><form class="aladin-target-form">Go to: <input type="text" placeholder="Object name/position" /></form></div>');o.appendTo(b),this.boxes.push(o);var p=o.find(".aladin-target-form input");p.on("paste keydown",function(){$(this).removeClass("aladin-unknownObject")}),m.click(function(){return d.hideBoxes(),p.val(""),p.removeClass("aladin-unknownObject"),o.show(),p.focus(),!1}),o.find(".aladin-closeBtn").click(function(){return d.hideBoxes(),!1})}if(f.showShareControl){var m=$('<div class="aladin-shareControl-container" title="Share current view"><div class="aladin-shareControl"></div></div>');m.appendTo(b);var q=$('<div class="aladin-box aladin-shareBox"><a class="aladin-closeBtn">&times;</a><div style="clear: both;"></div><b>Share</b><input type="text" class="aladin-shareInput" /></div>');q.appendTo(b),this.boxes.push(q),m.click(function(){return d.hideBoxes(),q.show(),!1}),q.find(".aladin-closeBtn").click(function(){return d.hideBoxes(),!1})}if(this.gotoObject(f.target),f.log){var r=c;r.version=a.VERSION,Logger.log("startup",r)}if(this.showReticle(f.showReticle),f.catalogUrls)for(var s=0,t=f.catalogUrls.length;t>s;s++)this.createCatalogFromVOTable(f.catalogUrls[s]);this.setImageSurvey(f.survey),this.view.showCatalog(f.showCatalog);var u=this;$(b).find(".aladin-frameChoice").change(function(){u.setFrame($(this).val())}),$("#projectionChoice").change(function(){u.setProjection($(this).val())}),$(b).find(".aladin-target-form").submit(function(){return u.gotoObject($(this).find("input").val(),function(){$(b).find(".aladin-target-form input").addClass("aladin-unknownObject")}),!1});var v=$(b).find(".zoomPlus");v.click(function(){return u.increaseZoom(),!1}),v.bind("mousedown",function(a){a.preventDefault()});var w=$(b).find(".zoomMinus");w.click(function(){return u.decreaseZoom(),!1}),w.bind("mousedown",function(a){a.preventDefault()}),f.fullScreen&&window.setTimeout(function(){d.toggleFullscreen()},1e3)}};a.VERSION="2017-02-24",a.JSONP_PROXY="http://alasky.unistra.fr/cgi/JSONProxy",a.DEFAULT_OPTIONS={target:"0 +0",cooFrame:"J2000",survey:"P/DSS2/color",fov:60,showReticle:!0,showZoomControl:!0,showFullscreenControl:!0,showLayersControl:!0,showGotoControl:!0,showShareControl:!1,showCatalog:!0,showFrame:!0,showCooGrid:!1,fullScreen:!1,reticleColor:"rgb(178, 50, 178)",reticleSize:22,log:!0,allowFullZoomout:!1},a.prototype.toggleFullscreen=function(){this.fullScreenBtn.toggleClass("aladin-maximize aladin-restore");var a=this.fullScreenBtn.hasClass("aladin-restore");this.fullScreenBtn.attr("title",a?"Restore original size":"Full screen"),$(this.aladinDiv).toggleClass("aladin-fullscreen"),this.view.fixLayoutDimensions()},a.prototype.updateSurveysDropdownList=function(a){a=a.sort(function(a,b){return a.order?a.order&&a.order>b.order?1:-1:a.id>b.id});var b=$(this.aladinDiv).find(".aladin-surveySelection");b.empty();for(var c=0;a.length>c;c++){var d=this.view.imageSurvey.id==a[c].id;b.append($("<option />").attr("selected",d).val(a[c].id).text(a[c].name))}},a.prototype.getOptionsFromQueryString=function(){var a={},b=$.urlParam("target");b&&(a.target=b);var c=$.urlParam("frame");c&&CooFrameEnum[c]&&(a.frame=c);var d=$.urlParam("survey");d&&HpxImageSurvey.getSurveyInfoFromId(d)&&(a.survey=d);var e=$.urlParam("zoom");e&&e>0&&180>e&&(a.zoom=e);var f=$.urlParam("showReticle");f&&(a.showReticle="true"==f.toLowerCase());var g=$.urlParam("cooFrame");g&&(a.cooFrame=g);var h=$.urlParam("fullScreen");return void 0!==h&&(a.fullScreen=h),a},a.prototype.setZoom=function(a){this.view.setZoom(a)},a.prototype.setFoV=a.prototype.setFov=function(a){this.view.setZoom(a)},a.prototype.setFrame=function(a){if(a){var b=CooFrameEnum.fromString(a,CooFrameEnum.J2000);b!=this.view.cooFrame&&(this.view.changeFrame(b),$(this.aladinDiv).find(".aladin-frameChoice").val(b))}},a.prototype.setProjection=function(a){if(a)switch(a=a.toLowerCase()){case"aitoff":this.view.changeProjection(ProjectionEnum.AITOFF);break;case"sinus":default:this.view.changeProjection(ProjectionEnum.SIN)}},a.prototype.gotoObject=function(a,b){var c=/[a-zA-Z]/.test(a);if(c){var d=this;Sesame.resolve(a,function(a){var b=a.Target.Resolver.jradeg,c=a.Target.Resolver.jdedeg;d.view.pointTo(b,c)},function(a){console&&void 0,b&&b()})}else{var e=new Coo;e.parse(a);var f=[e.lon,e.lat];this.view.cooFrame==CooFrameEnum.GAL&&(f=CooConversion.GalacticToJ2000(f)),this.view.pointTo(f[0],f[1])}},a.prototype.gotoPosition=function(a,b){var c;c=this.view.cooFrame==CooFrameEnum.GAL?CooConversion.GalacticToJ2000([a,b]):[a,b],this.view.pointTo(c[0],c[1])};var b=function(a){var c=a.animationParams;if(null!=c){var d=(new Date).getTime();if(d>c.end)return a.gotoRaDec(c.raEnd,c.decEnd),void(c.complete&&c.complete());var e=c.raStart+(c.raEnd-c.raStart)*(d-c.start)/(c.end-c.start),f=c.decStart+(c.decEnd-c.decStart)*(d-c.start)/(c.end-c.start);a.gotoRaDec(e,f),setTimeout(function(){b(a)},50)}};return a.prototype.animateToRaDec=function(a,c,d,e){d=d||5,this.animationParams=null,b(this);var f={};f.start=(new Date).getTime(),f.end=(new Date).getTime()+1e3*d;var g=this.getRaDec();f.raStart=g[0],f.decStart=g[1],f.raEnd=a,f.decEnd=c,f.complete=e,this.animationParams=f,b(this)},a.prototype.getRaDec=function(){if(this.view.cooFrame==CooFrameEnum.J2000)return[this.view.viewCenter.lon,this.view.viewCenter.lat];var a=CooConversion.GalacticToJ2000([this.view.viewCenter.lon,this.view.viewCenter.lat]);return a},a.prototype.gotoRaDec=function(a,b){this.view.pointTo(a,b)},a.prototype.showHealpixGrid=function(a){this.view.showHealpixGrid(a)},a.prototype.showSurvey=function(a){this.view.showSurvey(a)},a.prototype.showCatalog=function(a){this.view.showCatalog(a)},a.prototype.showReticle=function(a){this.view.showReticle(a),$("#displayReticle").attr("checked",a)},a.prototype.removeLayers=function(){this.view.removeLayers()},a.prototype.addCatalog=function(a){this.view.addCatalog(a)},a.prototype.addOverlay=function(a){this.view.addOverlay(a)},a.prototype.addMOC=function(a){this.view.addMOC(a)},a.prototype.createImageSurvey=function(a,b,c,d,e,f){return new HpxImageSurvey(a,b,c,d,e,f)},a.prototype.getBaseImageLayer=function(){return this.view.imageSurvey},a.prototype.setImageSurvey=function(a,b){if(this.view.setImageSurvey(a,b),this.updateSurveysDropdownList(HpxImageSurvey.getAvailableSurveys()),this.options.log){var c=a;"string"!=typeof a&&(c=a.rootUrl),Logger.log("changeImageSurvey",c)}},a.prototype.setBaseImageLayer=a.prototype.setImageSurvey,a.prototype.getOverlayImageLayer=function(){return this.view.overlayImageSurvey},a.prototype.setOverlayImageLayer=function(a,b){this.view.setOverlayImageSurvey(a,b)},a.prototype.increaseZoom=function(a){a||(a=5),this.view.setZoomLevel(this.view.zoomLevel+a)},a.prototype.decreaseZoom=function(a){a||(a=5),this.view.setZoomLevel(this.view.zoomLevel-a)},a.prototype.createCatalog=function(a){return A.catalog(a)},a.prototype.createProgressiveCatalog=function(a,b,c,d){return new ProgressiveCat(a,b,c,d)},a.prototype.createSource=function(a,b,c){return new cds.Source(a,b,c)},a.prototype.createMarker=function(a,b,c,d){return c=c||{},c.marker=!0,new cds.Source(a,b,d,c)},a.prototype.createOverlay=function(a){return new Overlay(a)},a.prototype.createFootprintsFromSTCS=function(a){for(var b=Overlay.parseSTCS(a),c=[],d=0,e=b.length;e>d;d++)c.push(new Footprint(b[d]));return c},A.MOCFromURL=function(a,b,c){var d=new MOC(b);return d.dataFromFITSURL(a,c),d},A.MOCFromJSON=function(a,b){var c=new MOC(b);return c.dataFromJSON(a),c},a.prototype.createCatalogFromVOTable=function(a,b){return A.catalogFromURL(a,b)},A.catalogFromURL=function(a,b,c,d){var e=A.catalog(b);return cds.Catalog.parseVOTable(a,function(a){e.addSources(a),c&&c(a)},e.maxNbSources,d,e.raField,e.decField),e},A.catalogFromSimbad=function(a,b,c,d){c=c||{},"name"in c||(c.name="Simbad");var e=URLBuilder.buildSimbadCSURL(a,b);return A.catalogFromURL(e,c,d,!1)},A.catalogFromNED=function(a,b,c,d){c=c||{},"name"in c||(c.name="NED");var e;if(a&&"object"==typeof a)"ra"in a&&"dec"in a&&(e=URLBuilder.buildNEDPositionCSURL(a.ra,a.dec,b));else{var f=/[a-zA-Z]/.test(a);if(f)e=URLBuilder.buildNEDObjectCSURL(a,b);else{var g=new Coo;g.parse(a),e=URLBuilder.buildNEDPositionCSURL(g.lon,g.lat,b)}}return A.catalogFromURL(e,c,d)},A.catalogFromVizieR=function(a,b,c,d,e){d=d||{},"name"in d||(d.name="VizieR:"+a);var f=URLBuilder.buildVizieRCSURL(a,b,c);return A.catalogFromURL(f,d,e,!1)},A.catalogFromSkyBot=function(a,b,c,d,e,f,g){e=e||{},f=f||{},"name"in f||(f.name="SkyBot");var h=URLBuilder.buildSkyBotCSURL(a,b,c,d,e);return A.catalogFromURL(h,f,g,!1)},a.prototype.on=function(a,b){"select"===a?this.selectFunction=b:"objectClicked"==a?this.objClickedFunction=b:"objectHovered"==a&&(this.objHoveredFunction=b)},a.prototype.select=function(){this.fire("selectstart")},a.prototype.fire=function(a,b){"selectstart"===a?this.view.setMode(View.SELECT):"selectend"===a&&(this.view.setMode(View.PAN),this.selectFunction&&this.selectFunction(b))},a.prototype.hideBoxes=function(){if(this.boxes)for(var a=0;this.boxes.length>a;a++)this.boxes[a].hide()},a.prototype.updateCM=function(){},a.prototype.showLayerBox=function(){var a=this,b=$(this.aladinDiv).find(".aladin-layerBox");b.empty(),b.append('<a class="aladin-closeBtn">&times;</a><div style="clear: both;"></div><div class="aladin-label">Base image layer</div><select class="aladin-surveySelection"></select><div class="aladin-cmap">Color map:<div><select class="aladin-cmSelection"></select><button class="aladin-btn aladin-btn-small aladin-reverseCm" type="button">Reverse</button></div></div><div class="aladin-box-separator"></div><div class="aladin-label">Overlay layers</div>');for(var c=b.find(".aladin-cmap"),d=b.find(".aladin-cmSelection"),e=0;ColorMap.MAPS_NAMES.length>e;e++)d.append($("<option />").text(ColorMap.MAPS_NAMES[e]));d.val(a.getBaseImageLayer().getColorMap().mapName);for(var f=this.view.catalogs,g="<ul>",e=f.length-1;e>=0;e--){var h=f[e].name,i="";f[e].isShowing&&(i='checked="checked"');var j=f[e].getSources().length,k=j+" source"+(j>1?"s":""),l=f[e].color,m=$("<div></div>").css("color",l).css("color"),n=Color.getLabelColorForBackground(m);g+='<li><div class="aladin-layerIcon" style="background: '+l+';"></div><input type="checkbox" '+i+' id="aladin_lite_'+h+'"></input><label for="aladin_lite_'+h+'" class="aladin-layer-label" style="background: '+l+"; color:"+n+';" title="'+k+'">'+h+"</label></li>"}g+="</ul>",b.append(g),b.append('<div class="aladin-blank-separator"></div>');var i="";this.view.displayReticle&&(i='checked="checked"');var o=$('<input type="checkbox" '+i+' id="displayReticle" />');b.append(o).append('<label for="displayReticle">Reticle</label><br/>'),o.change(function(){a.showReticle($(this).is(":checked"))}),i="",this.view.displayHpxGrid&&(i='checked="checked"');var p=$('<input type="checkbox" '+i+' id="displayHpxGrid"/>');b.append(p).append('<label for="displayHpxGrid">HEALPix grid</label><br/>'),p.change(function(){a.showHealpixGrid($(this).is(":checked"))}),b.append('<div class="aladin-box-separator"></div><div class="aladin-label">Tools</div>');var q=$('<button class="aladin-btn" type="button">Export view as PNG</button>');b.append(q),q.click(function(){a.exportAsPNG()}),b.find(".aladin-closeBtn").click(function(){return a.hideBoxes(),!1}),this.updateSurveysDropdownList(HpxImageSurvey.getAvailableSurveys());var r=$(this.aladinDiv).find(".aladin-surveySelection");r.change(function(){var b=HpxImageSurvey.getAvailableSurveys()[$(this)[0].selectedIndex];a.setImageSurvey(b.id,function(){var b=a.getBaseImageLayer();b.useCors?(d.val(b.getColorMap().mapName),c.show(),q.show()):(c.hide(),q.hide())})}),c.find(".aladin-cmSelection").change(function(){var b=$(this).find(":selected").val();a.getBaseImageLayer().getColorMap().update(b)}),c.find(".aladin-reverseCm").click(function(){a.getBaseImageLayer().getColorMap().reverse()}),this.getBaseImageLayer().useCors?(c.show(),q.show()):(c.hide(),q.hide()),b.find(".aladin-reverseCm").parent().attr("disabled",!0),$(this.aladinDiv).find(".aladin-layerBox ul input").change(function(){var b=$(this).attr("id").substr(12),c=a.layerByName(b);$(this).is(":checked")?c.show():c.hide()}),b.show()},a.prototype.layerByName=function(a){for(var b=this.view.catalogs,c=0;this.view.catalogs.length>c;c++)if(a==b[c].name)return b[c];return null},a.prototype.exportAsPNG=function(){window.open(this.getViewDataURL(),"Aladin Lite snapshot")},a.prototype.getViewDataURL=function(a){return this.view.getCanvasDataURL(a)},a.prototype.setFOVRange=function(a,b){if(a>b){var c=a;a=b,b=c}this.view.minFOV=a,this.view.maxFOV=b},a.prototype.pix2world=function(a,b){
var c,d=AladinUtils.viewToXy(a,b,this.view.width,this.view.height,this.view.largestDim,this.view.zoomFactor),e=this.view.projection.unproject(d.x,d.y);return c=this.view.cooFrame==CooFrameEnum.GAL?CooConversion.GalacticToJ2000([e.ra,e.dec]):[e.ra,e.dec]},a.prototype.world2pix=function(a,b){var c;if(this.view.cooFrame==CooFrameEnum.GAL){var d=CooConversion.J2000ToGalactic([a,b]);c=this.view.projection.project(d[0],d[1])}else c=this.view.projection.project(a,b);if(c){var e=AladinUtils.xyToView(c.X,c.Y,this.view.width,this.view.height,this.view.largestDim,this.view.zoomFactor);return[e.vx,e.vy]}return null},a.prototype.getFovCorners=function(a){(!a||1>a)&&(a=1);for(var b,c,d,e,f=[],g=0;4>g;g++){b=0==g||3==g?0:this.view.width-1,c=2>g?0:this.view.height-1,d=2>g?this.view.width-1:0,e=1==g||2==g?this.view.height-1:0;for(var h=0;a>h;h++)f.push(this.pix2world(b+h/a*(d-b),c+h/a*(e-c)))}return f},a.prototype.getFov=function(){var a=this.view.fov,b=this.getSize(),c=b[1]/b[0]*a;return a=Math.min(a,180),c=Math.min(c,180),[a,c]},a.prototype.getSize=function(){return[this.view.width,this.view.height]},a.prototype.getParentDiv=function(){return $(this.aladinDiv)},a}(),A.aladin=function(a,b){return new Aladin($(a)[0],b)},A.imageLayer=function(a,b,c,d){return new HpxImageSurvey(a,b,c,null,null,d)},A.source=function(a,b,c,d){return new cds.Source(a,b,c,d)},A.marker=function(a,b,c,d){return c=c||{},c.marker=!0,A.source(a,b,d,c)},A.polygon=function(a){var b=a.length;return b>0&&(a[0][0]!=a[b-1][0]||a[0][1]!=a[b-1][1])&&a.push([a[0][0],a[0][1]]),new Footprint(a)},A.polyline=function(a,b){return new Polyline(a,b)},A.circle=function(a,b,c,d){return new Circle([a,b],c,d)},A.graphicOverlay=function(a){return new Overlay(a)},A.catalog=function(a){return new cds.Catalog(a)},A.catalogHiPS=function(a,b){return new ProgressiveCat(a,null,null,b)},Aladin.prototype.getShareURL=function(){var a=this.getRaDec(),b=new Coo;return b.prec=7,b.lon=a[0],b.lat=a[1],"http://aladin.unistra.fr/AladinLite/?target="+encodeURIComponent(b.format("s"))+"&fov="+this.getFov()[0].toFixed(2)+"&survey="+encodeURIComponent(this.getBaseImageLayer().id)},Aladin.prototype.getEmbedCode=function(){var a=this.getRaDec(),b=new Coo;b.prec=7,b.lon=a[0],b.lat=a[1];var c=this.getBaseImageLayer().id,d=this.getFov()[0],e="";return e+='<link rel="stylesheet" href="http://aladin.unistra.fr/AladinLite/api/v2/latest/aladin.min.css" />\n',e+='<script type="text/javascript" src="//code.jquery.com/jquery-1.9.1.min.js" charset="utf-8"></script>\n',e+='<div id="aladin-lite-div" style="width:400px;height:400px;"></div>\n',e+='<script type="text/javascript" src="http://aladin.unistra.fr/AladinLite/api/v2/latest/aladin.min.js" charset="utf-8"></script>\n',e+='<script type="text/javascript">\n',e+='var aladin = A.aladin("#aladin-lite-div", {survey: "'+c+'P/DSS2/color", fov: '+d.toFixed(2)+', target: "'+b.format("s")+'"});\n',e+="</script>"},Aladin.prototype.displayFITS=function(a,b,c,d){b=b||{};var e={url:a};b.color&&(e.color=!0),b.outputFormat&&(e.format=b.outputFormat),b.order&&(e.order=b.order),b.nocache&&(e.nocache=b.nocache);var f=this;$.ajax({url:"http://alasky.unistra.fr/cgi/fits2HiPS",data:e,method:"GET",dataType:"json",success:function(a){if("success"!=a.status)return void(d&&d(a.message));var e=b.label||"FITS image",g=a.data.meta;f.setOverlayImageLayer(f.createImageSurvey(e,e,a.data.url,"equatorial",g.max_norder,{imgFormat:"png"}));var h=b&&b.transparency||1;f.getOverlayImageLayer().setAlpha(h);var i=!0;c&&(i=c(g.ra,g.dec,g.fov)),i===!0&&(f.gotoRaDec(g.ra,g.dec),f.setFoV(g.fov))}})},Aladin.prototype.displayJPG=Aladin.prototype.displayPNG=function(a,b,c,d){b=b||{},b.color=!0,b.label="JPG/PNG image",b.outputFormat="png",this.displayFITS(a,b,c,d)},Aladin.prototype.setReduceDeformations=function(a){this.reduceDeformations=a,this.view.requestRedraw()},$&&($.aladin=A.aladin),function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b():"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?exports.Handlebars=b():a.Handlebars=b()}(this,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){"use strict";function d(){var a=r();return a.compile=function(b,c){return k.compile(b,c,a)},a.precompile=function(b,c){return k.precompile(b,c,a)},a.AST=i.default,a.Compiler=k.Compiler,a.JavaScriptCompiler=m.default,a.Parser=j.parser,a.parse=j.parse,a}var e=c(1).default;b.__esModule=!0;var f=c(2),g=e(f),h=c(21),i=e(h),j=c(22),k=c(27),l=c(28),m=e(l),n=c(25),o=e(n),p=c(20),q=e(p),r=g.default.create,s=d();s.create=d,q.default(s),s.Visitor=o.default,s.default=s,b.default=s,a.exports=b.default},function(a,b){"use strict";b.default=function(a){return a&&a.__esModule?a:{default:a}},b.__esModule=!0},function(a,b,c){"use strict";function d(){var a=new h.HandlebarsEnvironment;return n.extend(a,h),a.SafeString=j.default,a.Exception=l.default,a.Utils=n,a.escapeExpression=n.escapeExpression,a.VM=p,a.template=function(b){return p.template(b,a)},a}var e=c(3).default,f=c(1).default;b.__esModule=!0;var g=c(4),h=e(g),i=c(18),j=f(i),k=c(6),l=f(k),m=c(5),n=e(m),o=c(19),p=e(o),q=c(20),r=f(q),s=d();s.create=d,r.default(s),s.default=s,b.default=s,a.exports=b.default},function(a,b){"use strict";b.default=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b},b.__esModule=!0},function(a,b,c){"use strict";function d(a,b,c){this.helpers=a||{},this.partials=b||{},this.decorators=c||{},i.registerDefaultHelpers(this),j.registerDefaultDecorators(this)}var e=c(1).default;b.__esModule=!0,b.HandlebarsEnvironment=d;var f=c(5),g=c(6),h=e(g),i=c(7),j=c(15),k=c(17),l=e(k),m="4.0.5";b.VERSION=m;var n=7;b.COMPILER_REVISION=n;var o={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0"};b.REVISION_CHANGES=o;var p="[object Object]";d.prototype={constructor:d,logger:l.default,log:l.default.log,registerHelper:function(a,b){if(f.toString.call(a)===p){if(b)throw new h.default("Arg not supported with multiple helpers");f.extend(this.helpers,a)}else this.helpers[a]=b},unregisterHelper:function(a){delete this.helpers[a]},registerPartial:function(a,b){if(f.toString.call(a)===p)f.extend(this.partials,a);else{if("undefined"==typeof b)throw new h.default('Attempting to register a partial called "'+a+'" as undefined');this.partials[a]=b}},unregisterPartial:function(a){delete this.partials[a]},registerDecorator:function(a,b){if(f.toString.call(a)===p){if(b)throw new h.default("Arg not supported with multiple decorators");f.extend(this.decorators,a)}else this.decorators[a]=b},unregisterDecorator:function(a){delete this.decorators[a]}};var q=l.default.log;b.log=q,b.createFrame=f.createFrame,b.logger=l.default},function(a,b){"use strict";function c(a){return k[a]}function d(a){for(var b=1;b<arguments.length;b++)for(var c in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],c)&&(a[c]=arguments[b][c]);return a}function e(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1}function f(a){if("string"!=typeof a){if(a&&a.toHTML)return a.toHTML();if(null==a)return"";if(!a)return a+"";a=""+a}return m.test(a)?a.replace(l,c):a}function g(a){return!a&&0!==a||!(!p(a)||0!==a.length)}function h(a){var b=d({},a);return b._parent=a,b}function i(a,b){return a.path=b,a}function j(a,b){return(a?a+".":"")+b}b.__esModule=!0,b.extend=d,b.indexOf=e,b.escapeExpression=f,b.isEmpty=g,b.createFrame=h,b.blockParams=i,b.appendContextPath=j;var k={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},l=/[&<>"'`=]/g,m=/[&<>"'`=]/,n=Object.prototype.toString;b.toString=n;var o=function(a){return"function"==typeof a};o(/x/)&&(b.isFunction=o=function(a){return"function"==typeof a&&"[object Function]"===n.call(a)}),b.isFunction=o;var p=Array.isArray||function(a){return!(!a||"object"!=typeof a)&&"[object Array]"===n.call(a)};b.isArray=p},function(a,b){"use strict";function c(a,b){var e=b&&b.loc,f=void 0,g=void 0;e&&(f=e.start.line,g=e.start.column,a+=" - "+f+":"+g);for(var h=Error.prototype.constructor.call(this,a),i=0;i<d.length;i++)this[d[i]]=h[d[i]];Error.captureStackTrace&&Error.captureStackTrace(this,c),e&&(this.lineNumber=f,this.column=g)}b.__esModule=!0;var d=["description","fileName","lineNumber","message","name","number","stack"];c.prototype=new Error,b.default=c,a.exports=b.default},function(a,b,c){"use strict";function d(a){g.default(a),i.default(a),k.default(a),m.default(a),o.default(a),q.default(a),s.default(a)}var e=c(1).default;b.__esModule=!0,b.registerDefaultHelpers=d;var f=c(8),g=e(f),h=c(9),i=e(h),j=c(10),k=e(j),l=c(11),m=e(l),n=c(12),o=e(n),p=c(13),q=e(p),r=c(14),s=e(r)},function(a,b,c){"use strict";b.__esModule=!0;var d=c(5);b.default=function(a){a.registerHelper("blockHelperMissing",function(b,c){var e=c.inverse,f=c.fn;if(b===!0)return f(this);if(b===!1||null==b)return e(this);if(d.isArray(b))return b.length>0?(c.ids&&(c.ids=[c.name]),a.helpers.each(b,c)):e(this);if(c.data&&c.ids){var g=d.createFrame(c.data);g.contextPath=d.appendContextPath(c.data.contextPath,c.name),c={data:g}}return f(b,c)})},a.exports=b.default},function(a,b,c){"use strict";var d=c(1).default;b.__esModule=!0;var e=c(5),f=c(6),g=d(f);b.default=function(a){a.registerHelper("each",function(a,b){function c(b,c,f){j&&(j.key=b,j.index=c,j.first=0===c,j.last=!!f,k&&(j.contextPath=k+b)),i+=d(a[b],{data:j,blockParams:e.blockParams([a[b],b],[k+b,null])})}if(!b)throw new g.default("Must pass iterator to #each");var d=b.fn,f=b.inverse,h=0,i="",j=void 0,k=void 0;if(b.data&&b.ids&&(k=e.appendContextPath(b.data.contextPath,b.ids[0])+"."),e.isFunction(a)&&(a=a.call(this)),b.data&&(j=e.createFrame(b.data)),a&&"object"==typeof a)if(e.isArray(a))for(var l=a.length;h<l;h++)h in a&&c(h,h,h===a.length-1);else{var m=void 0;for(var n in a)a.hasOwnProperty(n)&&(void 0!==m&&c(m,h-1),m=n,h++);void 0!==m&&c(m,h-1,!0)}return 0===h&&(i=f(this)),i})},a.exports=b.default},function(a,b,c){"use strict";var d=c(1).default;b.__esModule=!0;var e=c(6),f=d(e);b.default=function(a){a.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new f.default('Missing helper: "'+arguments[arguments.length-1].name+'"')})},a.exports=b.default},function(a,b,c){"use strict";b.__esModule=!0;var d=c(5);b.default=function(a){a.registerHelper("if",function(a,b){return d.isFunction(a)&&(a=a.call(this)),!b.hash.includeZero&&!a||d.isEmpty(a)?b.inverse(this):b.fn(this)}),a.registerHelper("unless",function(b,c){return a.helpers.if.call(this,b,{fn:c.inverse,inverse:c.fn,hash:c.hash})})},a.exports=b.default},function(a,b){"use strict";b.__esModule=!0,b.default=function(a){a.registerHelper("log",function(){for(var b=[void 0],c=arguments[arguments.length-1],d=0;d<arguments.length-1;d++)b.push(arguments[d]);var e=1;null!=c.hash.level?e=c.hash.level:c.data&&null!=c.data.level&&(e=c.data.level),b[0]=e,a.log.apply(a,b)})},a.exports=b.default},function(a,b){"use strict";b.__esModule=!0,b.default=function(a){a.registerHelper("lookup",function(a,b){return a&&a[b]})},a.exports=b.default},function(a,b,c){"use strict";b.__esModule=!0;var d=c(5);b.default=function(a){a.registerHelper("with",function(a,b){d.isFunction(a)&&(a=a.call(this));var c=b.fn;if(d.isEmpty(a))return b.inverse(this);var e=b.data;return b.data&&b.ids&&(e=d.createFrame(b.data),e.contextPath=d.appendContextPath(b.data.contextPath,b.ids[0])),c(a,{data:e,blockParams:d.blockParams([a],[e&&e.contextPath])})})},a.exports=b.default},function(a,b,c){"use strict";function d(a){g.default(a)}var e=c(1).default;b.__esModule=!0,b.registerDefaultDecorators=d;var f=c(16),g=e(f)},function(a,b,c){"use strict";b.__esModule=!0;var d=c(5);b.default=function(a){a.registerDecorator("inline",function(a,b,c,e){var f=a;return b.partials||(b.partials={},f=function(e,f){var g=c.partials;c.partials=d.extend({},g,b.partials);var h=a(e,f);return c.partials=g,h}),b.partials[e.args[0]]=e.fn,f})},a.exports=b.default},function(a,b,c){"use strict";b.__esModule=!0;var d=c(5),e={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(a){if("string"==typeof a){var b=d.indexOf(e.methodMap,a.toLowerCase());a=b>=0?b:parseInt(a,10)}return a},log:function(a){if(a=e.lookupLevel(a),"undefined"!=typeof console&&e.lookupLevel(e.level)<=a){var b=e.methodMap[a];console[b]||(b="log");for(var c=arguments.length,d=Array(c>1?c-1:0),f=1;f<c;f++)d[f-1]=arguments[f]}}};b.default=e,a.exports=b.default},function(a,b){"use strict";function c(a){this.string=a}b.__esModule=!0,c.prototype.toString=c.prototype.toHTML=function(){return""+this.string},b.default=c,a.exports=b.default},function(a,b,c){"use strict";function d(a){var b=a&&a[0]||1,c=r.COMPILER_REVISION;if(b!==c){if(b<c){var d=r.REVISION_CHANGES[c],e=r.REVISION_CHANGES[b];throw new q.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+d+") or downgrade your runtime to an older version ("+e+").")}throw new q.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+a[1]+").")}}function e(a,b){function c(c,d,e){e.hash&&(d=o.extend({},d,e.hash),e.ids&&(e.ids[0]=!0)),c=b.VM.resolvePartial.call(this,c,d,e);var f=b.VM.invokePartial.call(this,c,d,e);if(null==f&&b.compile&&(e.partials[e.name]=b.compile(c,a.compilerOptions,b),f=e.partials[e.name](d,e)),null!=f){if(e.indent){for(var g=f.split("\n"),h=0,i=g.length;h<i&&(g[h]||h+1!==i);h++)g[h]=e.indent+g[h];f=g.join("\n")}return f}throw new q.default("The partial "+e.name+" could not be compiled when running in runtime-only mode")}function d(b){function c(b){return""+a.main(e,b,e.helpers,e.partials,g,i,h)}var f=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],g=f.data;d._setup(f),!f.partial&&a.useData&&(g=j(b,g));var h=void 0,i=a.useBlockParams?[]:void 0;return a.useDepths&&(h=f.depths?b!==f.depths[0]?[b].concat(f.depths):f.depths:[b]),(c=k(a.main,c,e,f.depths||[],g,i))(b,f)}if(!b)throw new q.default("No environment passed to template");if(!a||!a.main)throw new q.default("Unknown template object: "+typeof a);a.main.decorator=a.main_d,b.VM.checkRevision(a.compiler);var e={strict:function(a,b){if(!(b in a))throw new q.default('"'+b+'" not defined in '+a);return a[b]},lookup:function(a,b){for(var c=a.length,d=0;d<c;d++)if(a[d]&&null!=a[d][b])return a[d][b]},lambda:function(a,b){return"function"==typeof a?a.call(b):a},escapeExpression:o.escapeExpression,invokePartial:c,fn:function(b){var c=a[b];return c.decorator=a[b+"_d"],c},programs:[],program:function(a,b,c,d,e){var g=this.programs[a],h=this.fn(a);return b||e||d||c?g=f(this,a,h,b,c,d,e):g||(g=this.programs[a]=f(this,a,h)),g},data:function(a,b){for(;a&&b--;)a=a._parent;return a},merge:function(a,b){var c=a||b;return a&&b&&a!==b&&(c=o.extend({},b,a)),c},noop:b.VM.noop,compilerInfo:a.compiler};return d.isTop=!0,d._setup=function(c){c.partial?(e.helpers=c.helpers,e.partials=c.partials,e.decorators=c.decorators):(e.helpers=e.merge(c.helpers,b.helpers),a.usePartial&&(e.partials=e.merge(c.partials,b.partials)),(a.usePartial||a.useDecorators)&&(e.decorators=e.merge(c.decorators,b.decorators)))},d._child=function(b,c,d,g){if(a.useBlockParams&&!d)throw new q.default("must pass block params");if(a.useDepths&&!g)throw new q.default("must pass parent depths");return f(e,b,a[b],c,0,d,g)},d}function f(a,b,c,d,e,f,g){function h(b){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],h=g;return g&&b!==g[0]&&(h=[b].concat(g)),c(a,b,a.helpers,a.partials,e.data||d,f&&[e.blockParams].concat(f),h)}return h=k(c,h,a,g,d,f),h.program=b,h.depth=g?g.length:0,h.blockParams=e||0,h}function g(a,b,c){return a?a.call||c.name||(c.name=a,a=c.partials[a]):a="@partial-block"===c.name?c.data["partial-block"]:c.partials[c.name],a}function h(a,b,c){c.partial=!0,c.ids&&(c.data.contextPath=c.ids[0]||c.data.contextPath);var d=void 0;if(c.fn&&c.fn!==i&&(c.data=r.createFrame(c.data),d=c.data["partial-block"]=c.fn,d.partials&&(c.partials=o.extend({},c.partials,d.partials))),void 0===a&&d&&(a=d),void 0===a)throw new q.default("The partial "+c.name+" could not be found");if(a instanceof Function)return a(b,c)}function i(){return""}function j(a,b){return b&&"root"in b||(b=b?r.createFrame(b):{},b.root=a),b}function k(a,b,c,d,e,f){if(a.decorator){var g={};b=a.decorator(b,g,c,d&&d[0],e,f,d),o.extend(b,g)}return b}var l=c(3).default,m=c(1).default;b.__esModule=!0,b.checkRevision=d,b.template=e,b.wrapProgram=f,b.resolvePartial=g,b.invokePartial=h,b.noop=i;var n=c(5),o=l(n),p=c(6),q=m(p),r=c(4)},function(a,b){(function(c){"use strict";b.__esModule=!0,b.default=function(a){var b="undefined"!=typeof c?c:window,d=b.Handlebars;a.noConflict=function(){return b.Handlebars===a&&(b.Handlebars=d),a}},a.exports=b.default}).call(b,function(){return this}())},function(a,b){"use strict";b.__esModule=!0;var c={helpers:{helperExpression:function(a){return"SubExpression"===a.type||("MustacheStatement"===a.type||"BlockStatement"===a.type)&&!!(a.params&&a.params.length||a.hash)},scopedId:function(a){return/^\.|this\b/.test(a.original)},simpleId:function(a){return 1===a.parts.length&&!c.helpers.scopedId(a)&&!a.depth}}};b.default=c,a.exports=b.default},function(a,b,c){"use strict";function d(a,b){if("Program"===a.type)return a;h.default.yy=n,n.locInfo=function(a){return new n.SourceLocation(b&&b.srcName,a)};var c=new j.default(b);return c.accept(h.default.parse(a))}var e=c(1).default,f=c(3).default;b.__esModule=!0,b.parse=d;var g=c(23),h=e(g),i=c(24),j=e(i),k=c(26),l=f(k),m=c(5);b.parser=h.default;var n={};m.extend(n,l)},function(a,b){"use strict";var c=function(){function a(){this.yy={}}var b={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,partialBlock:12,content:13,COMMENT:14,CONTENT:15,openRawBlock:16,rawBlock_repetition_plus0:17,END_RAW_BLOCK:18,OPEN_RAW_BLOCK:19,helperName:20,openRawBlock_repetition0:21,openRawBlock_option0:22,CLOSE_RAW_BLOCK:23,openBlock:24,block_option0:25,closeBlock:26,openInverse:27,block_option1:28,OPEN_BLOCK:29,openBlock_repetition0:30,openBlock_option0:31,openBlock_option1:32,CLOSE:33,OPEN_INVERSE:34,openInverse_repetition0:35,openInverse_option0:36,openInverse_option1:37,openInverseChain:38,OPEN_INVERSE_CHAIN:39,openInverseChain_repetition0:40,openInverseChain_option0:41,openInverseChain_option1:42,inverseAndProgram:43,INVERSE:44,inverseChain:45,inverseChain_option0:46,OPEN_ENDBLOCK:47,OPEN:48,mustache_repetition0:49,mustache_option0:50,OPEN_UNESCAPED:51,mustache_repetition1:52,mustache_option1:53,CLOSE_UNESCAPED:54,OPEN_PARTIAL:55,partialName:56,partial_repetition0:57,partial_option0:58,openPartialBlock:59,OPEN_PARTIAL_BLOCK:60,openPartialBlock_repetition0:61,openPartialBlock_option0:62,param:63,sexpr:64,OPEN_SEXPR:65,sexpr_repetition0:66,sexpr_option0:67,CLOSE_SEXPR:68,hash:69,hash_repetition_plus0:70,hashSegment:71,ID:72,EQUALS:73,blockParams:74,OPEN_BLOCK_PARAMS:75,blockParams_repetition_plus0:76,CLOSE_BLOCK_PARAMS:77,path:78,dataName:79,STRING:80,NUMBER:81,BOOLEAN:82,UNDEFINED:83,NULL:84,DATA:85,pathSegments:86,SEP:87,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"COMMENT",15:"CONTENT",18:"END_RAW_BLOCK",19:"OPEN_RAW_BLOCK",23:"CLOSE_RAW_BLOCK",29:"OPEN_BLOCK",33:"CLOSE",34:"OPEN_INVERSE",39:"OPEN_INVERSE_CHAIN",44:"INVERSE",47:"OPEN_ENDBLOCK",48:"OPEN",51:"OPEN_UNESCAPED",54:"CLOSE_UNESCAPED",55:"OPEN_PARTIAL",60:"OPEN_PARTIAL_BLOCK",65:"OPEN_SEXPR",68:"CLOSE_SEXPR",72:"ID",73:"EQUALS",75:"OPEN_BLOCK_PARAMS",77:"CLOSE_BLOCK_PARAMS",80:"STRING",81:"NUMBER",82:"BOOLEAN",83:"UNDEFINED",84:"NULL",85:"DATA",87:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[13,1],[10,3],[16,5],[9,4],[9,4],[24,6],[27,6],[38,6],[43,2],[45,3],[45,1],[26,3],[8,5],[8,5],[11,5],[12,3],[59,5],[63,1],[63,1],[64,5],[69,1],[71,3],[74,3],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[56,1],[56,1],[79,2],[78,1],[86,3],[86,1],[6,0],[6,2],[17,1],[17,2],[21,0],[21,2],[22,0],[22,1],[25,0],[25,1],[28,0],[28,1],[30,0],[30,2],[31,0],[31,1],[32,0],[32,1],[35,0],[35,2],[36,0],[36,1],[37,0],[37,1],[40,0],[40,2],[41,0],[41,1],[42,0],[42,1],[46,0],[46,1],[49,0],[49,2],[50,0],[50,1],[52,0],[52,2],[53,0],[53,1],[57,0],[57,2],[58,0],[58,1],[61,0],[61,2],[62,0],[62,1],[66,0],[66,2],[67,0],[67,1],[70,1],[70,2],[76,1],[76,2]],performAction:function(a,b,c,d,e,f,g){var h=f.length-1;switch(e){case 1:return f[h-1];case 2:this.$=d.prepareProgram(f[h]);break;case 3:this.$=f[h];break;case 4:this.$=f[h];break;case 5:this.$=f[h];break;case 6:this.$=f[h];break;case 7:this.$=f[h];break;case 8:this.$=f[h];break;case 9:this.$={type:"CommentStatement",value:d.stripComment(f[h]),strip:d.stripFlags(f[h],f[h]),loc:d.locInfo(this._$)};break;case 10:this.$={type:"ContentStatement",original:f[h],value:f[h],loc:d.locInfo(this._$)};break;case 11:this.$=d.prepareRawBlock(f[h-2],f[h-1],f[h],this._$);break;case 12:this.$={path:f[h-3],params:f[h-2],hash:f[h-1]};break;case 13:this.$=d.prepareBlock(f[h-3],f[h-2],f[h-1],f[h],!1,this._$);break;case 14:this.$=d.prepareBlock(f[h-3],f[h-2],f[h-1],f[h],!0,this._$);break;case 15:this.$={open:f[h-5],path:f[h-4],params:f[h-3],hash:f[h-2],blockParams:f[h-1],strip:d.stripFlags(f[h-5],f[h])};break;case 16:this.$={path:f[h-4],params:f[h-3],hash:f[h-2],blockParams:f[h-1],strip:d.stripFlags(f[h-5],f[h])};break;case 17:this.$={path:f[h-4],params:f[h-3],hash:f[h-2],blockParams:f[h-1],strip:d.stripFlags(f[h-5],f[h])};break;case 18:this.$={strip:d.stripFlags(f[h-1],f[h-1]),program:f[h]};break;case 19:var i=d.prepareBlock(f[h-2],f[h-1],f[h],f[h],!1,this._$),j=d.prepareProgram([i],f[h-1].loc);j.chained=!0,this.$={strip:f[h-2].strip,program:j,chain:!0};break;case 20:this.$=f[h];break;case 21:this.$={path:f[h-1],strip:d.stripFlags(f[h-2],f[h])};break;case 22:this.$=d.prepareMustache(f[h-3],f[h-2],f[h-1],f[h-4],d.stripFlags(f[h-4],f[h]),this._$);break;case 23:this.$=d.prepareMustache(f[h-3],f[h-2],f[h-1],f[h-4],d.stripFlags(f[h-4],f[h]),this._$);break;case 24:this.$={type:"PartialStatement",name:f[h-3],params:f[h-2],hash:f[h-1],indent:"",strip:d.stripFlags(f[h-4],f[h]),loc:d.locInfo(this._$)};break;case 25:this.$=d.preparePartialBlock(f[h-2],f[h-1],f[h],this._$);break;case 26:this.$={path:f[h-3],params:f[h-2],hash:f[h-1],strip:d.stripFlags(f[h-4],f[h])};break;case 27:this.$=f[h];break;case 28:this.$=f[h];break;case 29:this.$={type:"SubExpression",path:f[h-3],params:f[h-2],hash:f[h-1],loc:d.locInfo(this._$)};break;case 30:this.$={type:"Hash",pairs:f[h],loc:d.locInfo(this._$)};break;case 31:this.$={type:"HashPair",key:d.id(f[h-2]),value:f[h],loc:d.locInfo(this._$)};break;case 32:this.$=d.id(f[h-1]);break;case 33:this.$=f[h];break;case 34:this.$=f[h];break;case 35:this.$={type:"StringLiteral",value:f[h],original:f[h],loc:d.locInfo(this._$)};break;case 36:this.$={type:"NumberLiteral",value:Number(f[h]),original:Number(f[h]),loc:d.locInfo(this._$)};break;case 37:this.$={type:"BooleanLiteral",value:"true"===f[h],original:"true"===f[h],loc:d.locInfo(this._$)};break;case 38:this.$={type:"UndefinedLiteral",original:void 0,value:void 0,loc:d.locInfo(this._$)};break;case 39:this.$={type:"NullLiteral",original:null,value:null,loc:d.locInfo(this._$)};break;case 40:this.$=f[h];break;case 41:this.$=f[h];break;case 42:this.$=d.preparePath(!0,f[h],this._$);break;case 43:this.$=d.preparePath(!1,f[h],this._$);break;case 44:f[h-2].push({part:d.id(f[h]),original:f[h],separator:f[h-1]}),this.$=f[h-2];break;case 45:this.$=[{part:d.id(f[h]),original:f[h]}];break;case 46:this.$=[];break;case 47:f[h-1].push(f[h]);break;case 48:this.$=[f[h]];break;case 49:f[h-1].push(f[h]);break;case 50:this.$=[];break;case 51:f[h-1].push(f[h]);break;case 58:this.$=[];break;case 59:f[h-1].push(f[h]);break;case 64:this.$=[];break;case 65:f[h-1].push(f[h]);break;case 70:this.$=[];break;case 71:f[h-1].push(f[h]);break;case 78:this.$=[];break;case 79:f[h-1].push(f[h]);break;case 82:this.$=[];break;case 83:f[h-1].push(f[h]);break;case 86:this.$=[];break;case 87:f[h-1].push(f[h]);break;case 90:this.$=[];break;case 91:f[h-1].push(f[h]);break;case 94:this.$=[];break;case 95:f[h-1].push(f[h]);break;case 98:this.$=[f[h]];break;case 99:f[h-1].push(f[h]);break;case 100:this.$=[f[h]];break;case 101:f[h-1].push(f[h])}},table:[{3:1,4:2,5:[2,46],6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:11,14:[1,12],15:[1,20],16:17,19:[1,23],24:15,27:16,29:[1,21],34:[1,22],39:[2,2],44:[2,2],47:[2,2],48:[1,13],51:[1,14],55:[1,18],59:19,60:[1,24]},{1:[2,1]},{5:[2,47],14:[2,47],15:[2,47],19:[2,47],29:[2,47],34:[2,47],39:[2,47],44:[2,47],47:[2,47],48:[2,47],51:[2,47],55:[2,47],60:[2,47]},{5:[2,3],14:[2,3],15:[2,3],19:[2,3],29:[2,3],34:[2,3],39:[2,3],44:[2,3],47:[2,3],48:[2,3],51:[2,3],55:[2,3],60:[2,3]},{5:[2,4],14:[2,4],15:[2,4],19:[2,4],29:[2,4],34:[2,4],39:[2,4],44:[2,4],47:[2,4],48:[2,4],51:[2,4],55:[2,4],60:[2,4]},{5:[2,5],14:[2,5],15:[2,5],19:[2,5],29:[2,5],34:[2,5],39:[2,5],44:[2,5],47:[2,5],48:[2,5],51:[2,5],55:[2,5],60:[2,5]},{5:[2,6],14:[2,6],15:[2,6],19:[2,6],29:[2,6],34:[2,6],39:[2,6],44:[2,6],47:[2,6],48:[2,6],51:[2,6],55:[2,6],60:[2,6]},{5:[2,7],14:[2,7],15:[2,7],19:[2,7],29:[2,7],34:[2,7],39:[2,7],44:[2,7],47:[2,7],48:[2,7],51:[2,7],55:[2,7],60:[2,7]},{5:[2,8],14:[2,8],15:[2,8],19:[2,8],29:[2,8],34:[2,8],39:[2,8],44:[2,8],47:[2,8],48:[2,8],51:[2,8],55:[2,8],60:[2,8]},{5:[2,9],14:[2,9],15:[2,9],19:[2,9],29:[2,9],34:[2,9],39:[2,9],44:[2,9],47:[2,9],48:[2,9],51:[2,9],55:[2,9],60:[2,9]},{20:25,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:36,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:37,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{4:38,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{13:40,15:[1,20],17:39},{20:42,56:41,64:43,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:45,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{5:[2,10],14:[2,10],15:[2,10],18:[2,10],19:[2,10],29:[2,10],34:[2,10],39:[2,10],44:[2,10],47:[2,10],48:[2,10],51:[2,10],55:[2,10],60:[2,10]},{20:46,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:47,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:48,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:42,56:49,64:43,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[2,78],49:50,65:[2,78],72:[2,78],80:[2,78],81:[2,78],82:[2,78],83:[2,78],84:[2,78],85:[2,78]},{23:[2,33],33:[2,33],54:[2,33],65:[2,33],68:[2,33],72:[2,33],75:[2,33],80:[2,33],81:[2,33],82:[2,33],83:[2,33],84:[2,33],85:[2,33]},{23:[2,34],33:[2,34],54:[2,34],65:[2,34],68:[2,34],72:[2,34],75:[2,34],80:[2,34],81:[2,34],82:[2,34],83:[2,34],84:[2,34],85:[2,34]},{23:[2,35],33:[2,35],54:[2,35],65:[2,35],68:[2,35],72:[2,35],75:[2,35],80:[2,35],81:[2,35],82:[2,35],83:[2,35],84:[2,35],85:[2,35]},{23:[2,36],33:[2,36],54:[2,36],65:[2,36],68:[2,36],72:[2,36],75:[2,36],80:[2,36],81:[2,36],82:[2,36],83:[2,36],84:[2,36],85:[2,36]},{23:[2,37],33:[2,37],54:[2,37],65:[2,37],68:[2,37],72:[2,37],75:[2,37],80:[2,37],81:[2,37],82:[2,37],83:[2,37],84:[2,37],85:[2,37]},{23:[2,38],33:[2,38],54:[2,38],65:[2,38],68:[2,38],72:[2,38],75:[2,38],80:[2,38],81:[2,38],82:[2,38],83:[2,38],84:[2,38],85:[2,38]},{23:[2,39],33:[2,39],54:[2,39],65:[2,39],68:[2,39],72:[2,39],75:[2,39],80:[2,39],81:[2,39],82:[2,39],83:[2,39],84:[2,39],85:[2,39]},{23:[2,43],33:[2,43],54:[2,43],65:[2,43],68:[2,43],72:[2,43],75:[2,43],80:[2,43],81:[2,43],82:[2,43],83:[2,43],84:[2,43],85:[2,43],87:[1,51]},{72:[1,35],86:52},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{52:53,54:[2,82],65:[2,82],72:[2,82],80:[2,82],81:[2,82],82:[2,82],83:[2,82],84:[2,82],85:[2,82]},{25:54,38:56,39:[1,58],43:57,44:[1,59],45:55,47:[2,54]},{28:60,43:61,44:[1,59],47:[2,56]},{13:63,15:[1,20],18:[1,62]},{15:[2,48],18:[2,48]},{33:[2,86],57:64,65:[2,86],72:[2,86],80:[2,86],81:[2,86],82:[2,86],83:[2,86],84:[2,86],85:[2,86]},{33:[2,40],65:[2,40],72:[2,40],80:[2,40],81:[2,40],82:[2,40],83:[2,40],84:[2,40],85:[2,40]},{33:[2,41],65:[2,41],72:[2,41],80:[2,41],81:[2,41],82:[2,41],83:[2,41],84:[2,41],85:[2,41]},{20:65,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:66,47:[1,67]},{30:68,33:[2,58],65:[2,58],72:[2,58],75:[2,58],80:[2,58],81:[2,58],82:[2,58],83:[2,58],84:[2,58],85:[2,58]},{33:[2,64],35:69,65:[2,64],72:[2,64],75:[2,64],80:[2,64],81:[2,64],82:[2,64],83:[2,64],84:[2,64],85:[2,64]},{21:70,23:[2,50],65:[2,50],72:[2,50],80:[2,50],81:[2,50],82:[2,50],83:[2,50],84:[2,50],85:[2,50]},{33:[2,90],61:71,65:[2,90],72:[2,90],80:[2,90],81:[2,90],82:[2,90],83:[2,90],84:[2,90],85:[2,90]},{20:75,33:[2,80],50:72,63:73,64:76,65:[1,44],69:74,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{72:[1,80]},{23:[2,42],33:[2,42],54:[2,42],65:[2,42],68:[2,42],72:[2,42],75:[2,42],80:[2,42],81:[2,42],82:[2,42],83:[2,42],84:[2,42],85:[2,42],87:[1,51]},{20:75,53:81,54:[2,84],63:82,64:76,65:[1,44],69:83,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:84,47:[1,67]},{47:[2,55]},{4:85,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{47:[2,20]},{20:86,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:87,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{26:88,47:[1,67]},{47:[2,57]},{5:[2,11],14:[2,11],15:[2,11],19:[2,11],29:[2,11],34:[2,11],39:[2,11],44:[2,11],47:[2,11],48:[2,11],51:[2,11],55:[2,11],60:[2,11]},{15:[2,49],18:[2,49]},{20:75,33:[2,88],58:89,63:90,64:76,65:[1,44],69:91,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{65:[2,94],66:92,68:[2,94],72:[2,94],80:[2,94],81:[2,94],82:[2,94],83:[2,94],84:[2,94],85:[2,94]},{5:[2,25],14:[2,25],15:[2,25],19:[2,25],29:[2,25],34:[2,25],39:[2,25],44:[2,25],47:[2,25],48:[2,25],51:[2,25],55:[2,25],60:[2,25]},{20:93,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,31:94,33:[2,60],63:95,64:76,65:[1,44],69:96,70:77,71:78,72:[1,79],75:[2,60],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,33:[2,66],36:97,63:98,64:76,65:[1,44],69:99,70:77,71:78,72:[1,79],75:[2,66],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,22:100,23:[2,52],63:101,64:76,65:[1,44],69:102,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,33:[2,92],62:103,63:104,64:76,65:[1,44],69:105,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,106]},{33:[2,79],65:[2,79],72:[2,79],80:[2,79],81:[2,79],82:[2,79],83:[2,79],84:[2,79],85:[2,79]},{33:[2,81]},{23:[2,27],33:[2,27],54:[2,27],65:[2,27],68:[2,27],72:[2,27],75:[2,27],80:[2,27],81:[2,27],82:[2,27],83:[2,27],84:[2,27],85:[2,27]},{23:[2,28],33:[2,28],54:[2,28],65:[2,28],68:[2,28],72:[2,28],75:[2,28],80:[2,28],81:[2,28],82:[2,28],83:[2,28],84:[2,28],85:[2,28]},{23:[2,30],33:[2,30],54:[2,30],68:[2,30],71:107,72:[1,108],
75:[2,30]},{23:[2,98],33:[2,98],54:[2,98],68:[2,98],72:[2,98],75:[2,98]},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],73:[1,109],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{23:[2,44],33:[2,44],54:[2,44],65:[2,44],68:[2,44],72:[2,44],75:[2,44],80:[2,44],81:[2,44],82:[2,44],83:[2,44],84:[2,44],85:[2,44],87:[2,44]},{54:[1,110]},{54:[2,83],65:[2,83],72:[2,83],80:[2,83],81:[2,83],82:[2,83],83:[2,83],84:[2,83],85:[2,83]},{54:[2,85]},{5:[2,13],14:[2,13],15:[2,13],19:[2,13],29:[2,13],34:[2,13],39:[2,13],44:[2,13],47:[2,13],48:[2,13],51:[2,13],55:[2,13],60:[2,13]},{38:56,39:[1,58],43:57,44:[1,59],45:112,46:111,47:[2,76]},{33:[2,70],40:113,65:[2,70],72:[2,70],75:[2,70],80:[2,70],81:[2,70],82:[2,70],83:[2,70],84:[2,70],85:[2,70]},{47:[2,18]},{5:[2,14],14:[2,14],15:[2,14],19:[2,14],29:[2,14],34:[2,14],39:[2,14],44:[2,14],47:[2,14],48:[2,14],51:[2,14],55:[2,14],60:[2,14]},{33:[1,114]},{33:[2,87],65:[2,87],72:[2,87],80:[2,87],81:[2,87],82:[2,87],83:[2,87],84:[2,87],85:[2,87]},{33:[2,89]},{20:75,63:116,64:76,65:[1,44],67:115,68:[2,96],69:117,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,118]},{32:119,33:[2,62],74:120,75:[1,121]},{33:[2,59],65:[2,59],72:[2,59],75:[2,59],80:[2,59],81:[2,59],82:[2,59],83:[2,59],84:[2,59],85:[2,59]},{33:[2,61],75:[2,61]},{33:[2,68],37:122,74:123,75:[1,121]},{33:[2,65],65:[2,65],72:[2,65],75:[2,65],80:[2,65],81:[2,65],82:[2,65],83:[2,65],84:[2,65],85:[2,65]},{33:[2,67],75:[2,67]},{23:[1,124]},{23:[2,51],65:[2,51],72:[2,51],80:[2,51],81:[2,51],82:[2,51],83:[2,51],84:[2,51],85:[2,51]},{23:[2,53]},{33:[1,125]},{33:[2,91],65:[2,91],72:[2,91],80:[2,91],81:[2,91],82:[2,91],83:[2,91],84:[2,91],85:[2,91]},{33:[2,93]},{5:[2,22],14:[2,22],15:[2,22],19:[2,22],29:[2,22],34:[2,22],39:[2,22],44:[2,22],47:[2,22],48:[2,22],51:[2,22],55:[2,22],60:[2,22]},{23:[2,99],33:[2,99],54:[2,99],68:[2,99],72:[2,99],75:[2,99]},{73:[1,109]},{20:75,63:126,64:76,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,23],14:[2,23],15:[2,23],19:[2,23],29:[2,23],34:[2,23],39:[2,23],44:[2,23],47:[2,23],48:[2,23],51:[2,23],55:[2,23],60:[2,23]},{47:[2,19]},{47:[2,77]},{20:75,33:[2,72],41:127,63:128,64:76,65:[1,44],69:129,70:77,71:78,72:[1,79],75:[2,72],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,24],14:[2,24],15:[2,24],19:[2,24],29:[2,24],34:[2,24],39:[2,24],44:[2,24],47:[2,24],48:[2,24],51:[2,24],55:[2,24],60:[2,24]},{68:[1,130]},{65:[2,95],68:[2,95],72:[2,95],80:[2,95],81:[2,95],82:[2,95],83:[2,95],84:[2,95],85:[2,95]},{68:[2,97]},{5:[2,21],14:[2,21],15:[2,21],19:[2,21],29:[2,21],34:[2,21],39:[2,21],44:[2,21],47:[2,21],48:[2,21],51:[2,21],55:[2,21],60:[2,21]},{33:[1,131]},{33:[2,63]},{72:[1,133],76:132},{33:[1,134]},{33:[2,69]},{15:[2,12]},{14:[2,26],15:[2,26],19:[2,26],29:[2,26],34:[2,26],47:[2,26],48:[2,26],51:[2,26],55:[2,26],60:[2,26]},{23:[2,31],33:[2,31],54:[2,31],68:[2,31],72:[2,31],75:[2,31]},{33:[2,74],42:135,74:136,75:[1,121]},{33:[2,71],65:[2,71],72:[2,71],75:[2,71],80:[2,71],81:[2,71],82:[2,71],83:[2,71],84:[2,71],85:[2,71]},{33:[2,73],75:[2,73]},{23:[2,29],33:[2,29],54:[2,29],65:[2,29],68:[2,29],72:[2,29],75:[2,29],80:[2,29],81:[2,29],82:[2,29],83:[2,29],84:[2,29],85:[2,29]},{14:[2,15],15:[2,15],19:[2,15],29:[2,15],34:[2,15],39:[2,15],44:[2,15],47:[2,15],48:[2,15],51:[2,15],55:[2,15],60:[2,15]},{72:[1,138],77:[1,137]},{72:[2,100],77:[2,100]},{14:[2,16],15:[2,16],19:[2,16],29:[2,16],34:[2,16],44:[2,16],47:[2,16],48:[2,16],51:[2,16],55:[2,16],60:[2,16]},{33:[1,139]},{33:[2,75]},{33:[2,32]},{72:[2,101],77:[2,101]},{14:[2,17],15:[2,17],19:[2,17],29:[2,17],34:[2,17],39:[2,17],44:[2,17],47:[2,17],48:[2,17],51:[2,17],55:[2,17],60:[2,17]}],defaultActions:{4:[2,1],55:[2,55],57:[2,20],61:[2,57],74:[2,81],83:[2,85],87:[2,18],91:[2,89],102:[2,53],105:[2,93],111:[2,19],112:[2,77],117:[2,97],120:[2,63],123:[2,69],124:[2,12],136:[2,75],137:[2,32]},parseError:function(a,b){throw new Error(a)},parse:function(a){function b(){var a;return a=c.lexer.lex()||1,"number"!=typeof a&&(a=c.symbols_[a]||a),a}var c=this,d=[0],e=[null],f=[],g=this.table,h="",i=0,j=0,k=0;this.lexer.setInput(a),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var l=this.lexer.yylloc;f.push(l);var m=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var n,o,p,q,r,s,t,u,v,w={};;){if(p=d[d.length-1],this.defaultActions[p]?q=this.defaultActions[p]:(null!==n&&"undefined"!=typeof n||(n=b()),q=g[p]&&g[p][n]),"undefined"==typeof q||!q.length||!q[0]){var x="";if(!k){v=[];for(s in g[p])this.terminals_[s]&&s>2&&v.push("'"+this.terminals_[s]+"'");x=this.lexer.showPosition?"Parse error on line "+(i+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+v.join(", ")+", got '"+(this.terminals_[n]||n)+"'":"Parse error on line "+(i+1)+": Unexpected "+(1==n?"end of input":"'"+(this.terminals_[n]||n)+"'"),this.parseError(x,{text:this.lexer.match,token:this.terminals_[n]||n,line:this.lexer.yylineno,loc:l,expected:v})}}if(q[0]instanceof Array&&q.length>1)throw new Error("Parse Error: multiple actions possible at state: "+p+", token: "+n);switch(q[0]){case 1:d.push(n),e.push(this.lexer.yytext),f.push(this.lexer.yylloc),d.push(q[1]),n=null,o?(n=o,o=null):(j=this.lexer.yyleng,h=this.lexer.yytext,i=this.lexer.yylineno,l=this.lexer.yylloc,k>0&&k--);break;case 2:if(t=this.productions_[q[1]][1],w.$=e[e.length-t],w._$={first_line:f[f.length-(t||1)].first_line,last_line:f[f.length-1].last_line,first_column:f[f.length-(t||1)].first_column,last_column:f[f.length-1].last_column},m&&(w._$.range=[f[f.length-(t||1)].range[0],f[f.length-1].range[1]]),r=this.performAction.call(w,h,j,i,this.yy,q[1],e,f),"undefined"!=typeof r)return r;t&&(d=d.slice(0,-1*t*2),e=e.slice(0,-1*t),f=f.slice(0,-1*t)),d.push(this.productions_[q[1]][0]),e.push(w.$),f.push(w._$),u=g[d[d.length-2]][d[d.length-1]],d.push(u);break;case 3:return!0}}return!0}},c=function(){var a={EOF:1,parseError:function(a,b){if(!this.yy.parser)throw new Error(a);this.yy.parser.parseError(a,b)},setInput:function(a){return this._input=a,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var a=this._input[0];this.yytext+=a,this.yyleng++,this.offset++,this.match+=a,this.matched+=a;var b=a.match(/(?:\r\n?|\n).*/g);return b?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),a},unput:function(a){var b=a.length,c=a.split(/(?:\r\n?|\n)/g);this._input=a+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-b-1),this.offset-=b;var d=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),c.length-1&&(this.yylineno-=c.length-1);var e=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:c?(c.length===d.length?this.yylloc.first_column:0)+d[d.length-c.length].length-c[0].length:this.yylloc.first_column-b},this.options.ranges&&(this.yylloc.range=[e[0],e[0]+this.yyleng-b]),this},more:function(){return this._more=!0,this},less:function(a){this.unput(this.match.slice(a))},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(a.length>20?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;return a.length<20&&(a+=this._input.substr(0,20-a.length)),(a.substr(0,20)+(a.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),b=new Array(a.length+1).join("-");return a+this.upcomingInput()+"\n"+b+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a,b,c,d,e;this._more||(this.yytext="",this.match="");for(var f=this._currentRules(),g=0;g<f.length&&(c=this._input.match(this.rules[f[g]]),!c||b&&!(c[0].length>b[0].length)||(b=c,d=g,this.options.flex));g++);return b?(e=b[0].match(/(?:\r\n?|\n).*/g),e&&(this.yylineno+=e.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:e?e[e.length-1].length-e[e.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+b[0].length},this.yytext+=b[0],this.match+=b[0],this.matches=b,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(b[0].length),this.matched+=b[0],a=this.performAction.call(this,this.yy,this,f[d],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),a?a:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var a=this.next();return"undefined"!=typeof a?a:this.lex()},begin:function(a){this.conditionStack.push(a)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(a){this.begin(a)}};return a.options={},a.performAction=function(a,b,c,d){function e(a,c){return b.yytext=b.yytext.substr(a,b.yyleng-c)}switch(c){case 0:if("\\\\"===b.yytext.slice(-2)?(e(0,1),this.begin("mu")):"\\"===b.yytext.slice(-1)?(e(0,1),this.begin("emu")):this.begin("mu"),b.yytext)return 15;break;case 1:return 15;case 2:return this.popState(),15;case 3:return this.begin("raw"),15;case 4:return this.popState(),"raw"===this.conditionStack[this.conditionStack.length-1]?15:(b.yytext=b.yytext.substr(5,b.yyleng-9),"END_RAW_BLOCK");case 5:return 15;case 6:return this.popState(),14;case 7:return 65;case 8:return 68;case 9:return 19;case 10:return this.popState(),this.begin("raw"),23;case 11:return 55;case 12:return 60;case 13:return 29;case 14:return 47;case 15:return this.popState(),44;case 16:return this.popState(),44;case 17:return 34;case 18:return 39;case 19:return 51;case 20:return 48;case 21:this.unput(b.yytext),this.popState(),this.begin("com");break;case 22:return this.popState(),14;case 23:return 48;case 24:return 73;case 25:return 72;case 26:return 72;case 27:return 87;case 28:break;case 29:return this.popState(),54;case 30:return this.popState(),33;case 31:return b.yytext=e(1,2).replace(/\\"/g,'"'),80;case 32:return b.yytext=e(1,2).replace(/\\'/g,"'"),80;case 33:return 85;case 34:return 82;case 35:return 82;case 36:return 83;case 37:return 84;case 38:return 81;case 39:return 75;case 40:return 77;case 41:return 72;case 42:return b.yytext=b.yytext.replace(/\\([\\\]])/g,"$1"),72;case 43:return"INVALID";case 44:return 5}},a.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{(?=[^\/]))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#>)/,/^(?:\{\{(~)?#\*?)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?\*?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[(\\\]|[^\]])*\])/,/^(?:.)/,/^(?:$)/],a.conditions={mu:{rules:[7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[6],inclusive:!1},raw:{rules:[3,4,5],inclusive:!1},INITIAL:{rules:[0,1,44],inclusive:!0}},a}();return b.lexer=c,a.prototype=b,b.Parser=a,new a}();b.__esModule=!0,b.default=c},function(a,b,c){"use strict";function d(){var a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.options=a}function e(a,b,c){void 0===b&&(b=a.length);var d=a[b-1],e=a[b-2];return d?"ContentStatement"===d.type?(e||!c?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(d.original):void 0:c}function f(a,b,c){void 0===b&&(b=-1);var d=a[b+1],e=a[b+2];return d?"ContentStatement"===d.type?(e||!c?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(d.original):void 0:c}function g(a,b,c){var d=a[null==b?0:b+1];if(d&&"ContentStatement"===d.type&&(c||!d.rightStripped)){var e=d.value;d.value=d.value.replace(c?/^\s+/:/^[ \t]*\r?\n?/,""),d.rightStripped=d.value!==e}}function h(a,b,c){var d=a[null==b?a.length-1:b-1];if(d&&"ContentStatement"===d.type&&(c||!d.leftStripped)){var e=d.value;return d.value=d.value.replace(c?/\s+$/:/[ \t]+$/,""),d.leftStripped=d.value!==e,d.leftStripped}}var i=c(1).default;b.__esModule=!0;var j=c(25),k=i(j);d.prototype=new k.default,d.prototype.Program=function(a){var b=!this.options.ignoreStandalone,c=!this.isRootSeen;this.isRootSeen=!0;for(var d=a.body,i=0,j=d.length;i<j;i++){var k=d[i],l=this.accept(k);if(l){var m=e(d,i,c),n=f(d,i,c),o=l.openStandalone&&m,p=l.closeStandalone&&n,q=l.inlineStandalone&&m&&n;l.close&&g(d,i,!0),l.open&&h(d,i,!0),b&&q&&(g(d,i),h(d,i)&&"PartialStatement"===k.type&&(k.indent=/([ \t]+$)/.exec(d[i-1].original)[1])),b&&o&&(g((k.program||k.inverse).body),h(d,i)),b&&p&&(g(d,i),h((k.inverse||k.program).body))}}return a},d.prototype.BlockStatement=d.prototype.DecoratorBlock=d.prototype.PartialBlockStatement=function(a){this.accept(a.program),this.accept(a.inverse);var b=a.program||a.inverse,c=a.program&&a.inverse,d=c,i=c;if(c&&c.chained)for(d=c.body[0].program;i.chained;)i=i.body[i.body.length-1].program;var j={open:a.openStrip.open,close:a.closeStrip.close,openStandalone:f(b.body),closeStandalone:e((d||b).body)};if(a.openStrip.close&&g(b.body,null,!0),c){var k=a.inverseStrip;k.open&&h(b.body,null,!0),k.close&&g(d.body,null,!0),a.closeStrip.open&&h(i.body,null,!0),!this.options.ignoreStandalone&&e(b.body)&&f(d.body)&&(h(b.body),g(d.body))}else a.closeStrip.open&&h(b.body,null,!0);return j},d.prototype.Decorator=d.prototype.MustacheStatement=function(a){return a.strip},d.prototype.PartialStatement=d.prototype.CommentStatement=function(a){var b=a.strip||{};return{inlineStandalone:!0,open:b.open,close:b.close}},b.default=d,a.exports=b.default},function(a,b,c){"use strict";function d(){this.parents=[]}function e(a){this.acceptRequired(a,"path"),this.acceptArray(a.params),this.acceptKey(a,"hash")}function f(a){e.call(this,a),this.acceptKey(a,"program"),this.acceptKey(a,"inverse")}function g(a){this.acceptRequired(a,"name"),this.acceptArray(a.params),this.acceptKey(a,"hash")}var h=c(1).default;b.__esModule=!0;var i=c(6),j=h(i);d.prototype={constructor:d,mutating:!1,acceptKey:function(a,b){var c=this.accept(a[b]);if(this.mutating){if(c&&!d.prototype[c.type])throw new j.default('Unexpected node type "'+c.type+'" found when accepting '+b+" on "+a.type);a[b]=c}},acceptRequired:function(a,b){if(this.acceptKey(a,b),!a[b])throw new j.default(a.type+" requires "+b)},acceptArray:function(a){for(var b=0,c=a.length;b<c;b++)this.acceptKey(a,b),a[b]||(a.splice(b,1),b--,c--)},accept:function(a){if(a){if(!this[a.type])throw new j.default("Unknown type: "+a.type,a);this.current&&this.parents.unshift(this.current),this.current=a;var b=this[a.type](a);return this.current=this.parents.shift(),!this.mutating||b?b:b!==!1?a:void 0}},Program:function(a){this.acceptArray(a.body)},MustacheStatement:e,Decorator:e,BlockStatement:f,DecoratorBlock:f,PartialStatement:g,PartialBlockStatement:function(a){g.call(this,a),this.acceptKey(a,"program")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:e,PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(a){this.acceptArray(a.pairs)},HashPair:function(a){this.acceptRequired(a,"value")}},b.default=d,a.exports=b.default},function(a,b,c){"use strict";function d(a,b){if(b=b.path?b.path.original:b,a.path.original!==b){var c={loc:a.path.loc};throw new q.default(a.path.original+" doesn't match "+b,c)}}function e(a,b){this.source=a,this.start={line:b.first_line,column:b.first_column},this.end={line:b.last_line,column:b.last_column}}function f(a){return/^\[.*\]$/.test(a)?a.substr(1,a.length-2):a}function g(a,b){return{open:"~"===a.charAt(2),close:"~"===b.charAt(b.length-3)}}function h(a){return a.replace(/^\{\{~?\!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function i(a,b,c){c=this.locInfo(c);for(var d=a?"@":"",e=[],f=0,g="",h=0,i=b.length;h<i;h++){var j=b[h].part,k=b[h].original!==j;if(d+=(b[h].separator||"")+j,k||".."!==j&&"."!==j&&"this"!==j)e.push(j);else{if(e.length>0)throw new q.default("Invalid path: "+d,{loc:c});".."===j&&(f++,g+="../")}}return{type:"PathExpression",data:a,depth:f,parts:e,original:d,loc:c}}function j(a,b,c,d,e,f){var g=d.charAt(3)||d.charAt(2),h="{"!==g&&"&"!==g,i=/\*/.test(d);return{type:i?"Decorator":"MustacheStatement",path:a,params:b,hash:c,escaped:h,strip:e,loc:this.locInfo(f)}}function k(a,b,c,e){d(a,c),e=this.locInfo(e);var f={type:"Program",body:b,strip:{},loc:e};return{type:"BlockStatement",path:a.path,params:a.params,hash:a.hash,program:f,openStrip:{},inverseStrip:{},closeStrip:{},loc:e}}function l(a,b,c,e,f,g){e&&e.path&&d(a,e);var h=/\*/.test(a.open);b.blockParams=a.blockParams;var i=void 0,j=void 0;if(c){if(h)throw new q.default("Unexpected inverse block on decorator",c);c.chain&&(c.program.body[0].closeStrip=e.strip),j=c.strip,i=c.program}return f&&(f=i,i=b,b=f),{type:h?"DecoratorBlock":"BlockStatement",path:a.path,params:a.params,hash:a.hash,program:b,inverse:i,openStrip:a.strip,inverseStrip:j,closeStrip:e&&e.strip,loc:this.locInfo(g)}}function m(a,b){if(!b&&a.length){var c=a[0].loc,d=a[a.length-1].loc;c&&d&&(b={source:c.source,start:{line:c.start.line,column:c.start.column},end:{line:d.end.line,column:d.end.column}})}return{type:"Program",body:a,strip:{},loc:b}}function n(a,b,c,e){return d(a,c),{type:"PartialBlockStatement",name:a.path,params:a.params,hash:a.hash,program:b,openStrip:a.strip,closeStrip:c&&c.strip,loc:this.locInfo(e)}}var o=c(1).default;b.__esModule=!0,b.SourceLocation=e,b.id=f,b.stripFlags=g,b.stripComment=h,b.preparePath=i,b.prepareMustache=j,b.prepareRawBlock=k,b.prepareBlock=l,b.prepareProgram=m,b.preparePartialBlock=n;var p=c(6),q=o(p)},function(a,b,c){"use strict";function d(){}function e(a,b,c){if(null==a||"string"!=typeof a&&"Program"!==a.type)throw new k.default("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+a);b=b||{},"data"in b||(b.data=!0),b.compat&&(b.useDepths=!0);var d=c.parse(a,b),e=(new c.Compiler).compile(d,b);return(new c.JavaScriptCompiler).compile(e,b)}function f(a,b,c){function d(){var d=c.parse(a,b),e=(new c.Compiler).compile(d,b),f=(new c.JavaScriptCompiler).compile(e,b,void 0,!0);return c.template(f)}function e(a,b){return f||(f=d()),f.call(this,a,b)}if(void 0===b&&(b={}),null==a||"string"!=typeof a&&"Program"!==a.type)throw new k.default("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+a);"data"in b||(b.data=!0),b.compat&&(b.useDepths=!0);var f=void 0;return e._setup=function(a){return f||(f=d()),f._setup(a)},e._child=function(a,b,c,e){return f||(f=d()),f._child(a,b,c,e)},e}function g(a,b){if(a===b)return!0;if(l.isArray(a)&&l.isArray(b)&&a.length===b.length){for(var c=0;c<a.length;c++)if(!g(a[c],b[c]))return!1;return!0}}function h(a){if(!a.path.parts){var b=a.path;a.path={type:"PathExpression",data:!1,depth:0,parts:[b.original+""],original:b.original+"",loc:b.loc}}}var i=c(1).default;b.__esModule=!0,b.Compiler=d,b.precompile=e,b.compile=f;var j=c(6),k=i(j),l=c(5),m=c(21),n=i(m),o=[].slice;d.prototype={compiler:d,equals:function(a){var b=this.opcodes.length;if(a.opcodes.length!==b)return!1;for(var c=0;c<b;c++){var d=this.opcodes[c],e=a.opcodes[c];if(d.opcode!==e.opcode||!g(d.args,e.args))return!1}b=this.children.length;for(var c=0;c<b;c++)if(!this.children[c].equals(a.children[c]))return!1;return!0},guid:0,compile:function(a,b){this.sourceNode=[],this.opcodes=[],this.children=[],this.options=b,this.stringParams=b.stringParams,this.trackIds=b.trackIds,b.blockParams=b.blockParams||[];var c=b.knownHelpers;if(b.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,if:!0,unless:!0,with:!0,log:!0,lookup:!0},c)for(var d in c)d in c&&(b.knownHelpers[d]=c[d]);return this.accept(a)},compileProgram:function(a){var b=new this.compiler,c=b.compile(a,this.options),d=this.guid++;return this.usePartial=this.usePartial||c.usePartial,this.children[d]=c,this.useDepths=this.useDepths||c.useDepths,d},accept:function(a){if(!this[a.type])throw new k.default("Unknown type: "+a.type,a);this.sourceNode.unshift(a);var b=this[a.type](a);return this.sourceNode.shift(),b},Program:function(a){this.options.blockParams.unshift(a.blockParams);for(var b=a.body,c=b.length,d=0;d<c;d++)this.accept(b[d]);return this.options.blockParams.shift(),this.isSimple=1===c,this.blockParams=a.blockParams?a.blockParams.length:0,this},BlockStatement:function(a){h(a);var b=a.program,c=a.inverse;b=b&&this.compileProgram(b),c=c&&this.compileProgram(c);var d=this.classifySexpr(a);"helper"===d?this.helperSexpr(a,b,c):"simple"===d?(this.simpleSexpr(a),this.opcode("pushProgram",b),this.opcode("pushProgram",c),this.opcode("emptyHash"),this.opcode("blockValue",a.path.original)):(this.ambiguousSexpr(a,b,c),this.opcode("pushProgram",b),this.opcode("pushProgram",c),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},DecoratorBlock:function(a){var b=a.program&&this.compileProgram(a.program),c=this.setupFullMustacheParams(a,b,void 0),d=a.path;this.useDecorators=!0,this.opcode("registerDecorator",c.length,d.original)},PartialStatement:function(a){this.usePartial=!0;var b=a.program;b&&(b=this.compileProgram(a.program));var c=a.params;if(c.length>1)throw new k.default("Unsupported number of partial arguments: "+c.length,a);c.length||(this.options.explicitPartialContext?this.opcode("pushLiteral","undefined"):c.push({type:"PathExpression",parts:[],depth:0}));var d=a.name.original,e="SubExpression"===a.name.type;e&&this.accept(a.name),this.setupFullMustacheParams(a,b,void 0,!0);var f=a.indent||"";this.options.preventIndent&&f&&(this.opcode("appendContent",f),f=""),this.opcode("invokePartial",e,d,f),this.opcode("append")},PartialBlockStatement:function(a){this.PartialStatement(a)},MustacheStatement:function(a){this.SubExpression(a),a.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},Decorator:function(a){this.DecoratorBlock(a)},ContentStatement:function(a){a.value&&this.opcode("appendContent",a.value)},CommentStatement:function(){},SubExpression:function(a){h(a);var b=this.classifySexpr(a);"simple"===b?this.simpleSexpr(a):"helper"===b?this.helperSexpr(a):this.ambiguousSexpr(a)},ambiguousSexpr:function(a,b,c){var d=a.path,e=d.parts[0],f=null!=b||null!=c;this.opcode("getContext",d.depth),this.opcode("pushProgram",b),this.opcode("pushProgram",c),d.strict=!0,this.accept(d),this.opcode("invokeAmbiguous",e,f)},simpleSexpr:function(a){var b=a.path;b.strict=!0,this.accept(b),this.opcode("resolvePossibleLambda")},helperSexpr:function(a,b,c){var d=this.setupFullMustacheParams(a,b,c),e=a.path,f=e.parts[0];if(this.options.knownHelpers[f])this.opcode("invokeKnownHelper",d.length,f);else{if(this.options.knownHelpersOnly)throw new k.default("You specified knownHelpersOnly, but used the unknown helper "+f,a);e.strict=!0,e.falsy=!0,this.accept(e),this.opcode("invokeHelper",d.length,e.original,n.default.helpers.simpleId(e))}},PathExpression:function(a){this.addDepth(a.depth),this.opcode("getContext",a.depth);var b=a.parts[0],c=n.default.helpers.scopedId(a),d=!a.depth&&!c&&this.blockParamIndex(b);d?this.opcode("lookupBlockParam",d,a.parts):b?a.data?(this.options.data=!0,this.opcode("lookupData",a.depth,a.parts,a.strict)):this.opcode("lookupOnContext",a.parts,a.falsy,a.strict,c):this.opcode("pushContext")},StringLiteral:function(a){this.opcode("pushString",a.value)},NumberLiteral:function(a){this.opcode("pushLiteral",a.value)},BooleanLiteral:function(a){this.opcode("pushLiteral",a.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(a){var b=a.pairs,c=0,d=b.length;for(this.opcode("pushHash");c<d;c++)this.pushParam(b[c].value);for(;c--;)this.opcode("assignToHash",b[c].key);this.opcode("popHash")},opcode:function(a){this.opcodes.push({opcode:a,args:o.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(a){a&&(this.useDepths=!0)},classifySexpr:function(a){var b=n.default.helpers.simpleId(a.path),c=b&&!!this.blockParamIndex(a.path.parts[0]),d=!c&&n.default.helpers.helperExpression(a),e=!c&&(d||b);if(e&&!d){var f=a.path.parts[0],g=this.options;g.knownHelpers[f]?d=!0:g.knownHelpersOnly&&(e=!1)}return d?"helper":e?"ambiguous":"simple"},pushParams:function(a){for(var b=0,c=a.length;b<c;b++)this.pushParam(a[b])},pushParam:function(a){var b=null!=a.value?a.value:a.original||"";if(this.stringParams)b.replace&&(b=b.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),a.depth&&this.addDepth(a.depth),this.opcode("getContext",a.depth||0),this.opcode("pushStringParam",b,a.type),"SubExpression"===a.type&&this.accept(a);else{if(this.trackIds){var c=void 0;if(!a.parts||n.default.helpers.scopedId(a)||a.depth||(c=this.blockParamIndex(a.parts[0])),c){var d=a.parts.slice(1).join(".");this.opcode("pushId","BlockParam",c,d)}else b=a.original||b,b.replace&&(b=b.replace(/^this(?:\.|$)/,"").replace(/^\.\//,"").replace(/^\.$/,"")),this.opcode("pushId",a.type,b)}this.accept(a)}},setupFullMustacheParams:function(a,b,c,d){var e=a.params;return this.pushParams(e),this.opcode("pushProgram",b),this.opcode("pushProgram",c),a.hash?this.accept(a.hash):this.opcode("emptyHash",d),e},blockParamIndex:function(a){for(var b=0,c=this.options.blockParams.length;b<c;b++){var d=this.options.blockParams[b],e=d&&l.indexOf(d,a);if(d&&e>=0)return[b,e]}}}},function(a,b,c){"use strict";function d(a){this.value=a}function e(){}function f(a,b,c,d){var e=b.popStack(),f=0,g=c.length;for(a&&g--;f<g;f++)e=b.nameLookup(e,c[f],d);return a?[b.aliasable("container.strict"),"(",e,", ",b.quotedString(c[f]),")"]:e}var g=c(1).default;b.__esModule=!0;var h=c(4),i=c(6),j=g(i),k=c(5),l=c(29),m=g(l);e.prototype={nameLookup:function(a,b){return e.isValidJavaScriptVariableName(b)?[a,".",b]:[a,"[",JSON.stringify(b),"]"]},depthedLookup:function(a){return[this.aliasable("container.lookup"),'(depths, "',a,'")']},compilerInfo:function(){var a=h.COMPILER_REVISION,b=h.REVISION_CHANGES[a];return[a,b]},appendToBuffer:function(a,b,c){return k.isArray(a)||(a=[a]),a=this.source.wrap(a,b),this.environment.isSimple?["return ",a,";"]:c?["buffer += ",a,";"]:(a.appendToBuffer=!0,a)},initializeBuffer:function(){return this.quotedString("")},compile:function(a,b,c,d){this.environment=a,this.options=b,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!d,this.name=this.environment.name,this.isChild=!!c,this.context=c||{decorators:[],programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(a,b),this.useDepths=this.useDepths||a.useDepths||a.useDecorators||this.options.compat,this.useBlockParams=this.useBlockParams||a.useBlockParams;var e=a.opcodes,f=void 0,g=void 0,h=void 0,i=void 0;for(h=0,i=e.length;h<i;h++)f=e[h],this.source.currentLocation=f.loc,g=g||f.loc,this[f.opcode].apply(this,f.args);if(this.source.currentLocation=g,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new j.default("Compile completed with content left on stack");this.decorators.isEmpty()?this.decorators=void 0:(this.useDecorators=!0,this.decorators.prepend("var decorators = container.decorators;\n"),this.decorators.push("return fn;"),d?this.decorators=Function.apply(this,["fn","props","container","depth0","data","blockParams","depths",this.decorators.merge()]):(this.decorators.prepend("function(fn, props, container, depth0, data, blockParams, depths) {\n"),this.decorators.push("}\n"),this.decorators=this.decorators.merge()));var k=this.createFunctionContext(d);if(this.isChild)return k;var l={compiler:this.compilerInfo(),main:k};this.decorators&&(l.main_d=this.decorators,l.useDecorators=!0);var m=this.context,n=m.programs,o=m.decorators;for(h=0,i=n.length;h<i;h++)n[h]&&(l[h]=n[h],o[h]&&(l[h+"_d"]=o[h],l.useDecorators=!0));return this.environment.usePartial&&(l.usePartial=!0),this.options.data&&(l.useData=!0),this.useDepths&&(l.useDepths=!0),this.useBlockParams&&(l.useBlockParams=!0),this.options.compat&&(l.compat=!0),d?l.compilerOptions=this.options:(l.compiler=JSON.stringify(l.compiler),this.source.currentLocation={start:{line:1,column:0}},l=this.objectLiteral(l),b.srcName?(l=l.toStringWithSourceMap({file:b.destName}),l.map=l.map&&l.map.toString()):l=l.toString()),l},preamble:function(){this.lastContext=0,this.source=new m.default(this.options.srcName),this.decorators=new m.default(this.options.srcName)},createFunctionContext:function(a){var b="",c=this.stackVars.concat(this.registers.list);c.length>0&&(b+=", "+c.join(", "));var d=0;for(var e in this.aliases){var f=this.aliases[e];this.aliases.hasOwnProperty(e)&&f.children&&f.referenceCount>1&&(b+=", alias"+ ++d+"="+e,f.children[0]="alias"+d)}var g=["container","depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&g.push("blockParams"),this.useDepths&&g.push("depths");var h=this.mergeSource(b);return a?(g.push(h),Function.apply(this,g)):this.source.wrap(["function(",g.join(","),") {\n  ",h,"}"])},mergeSource:function(a){var b=this.environment.isSimple,c=!this.forceBuffer,d=void 0,e=void 0,f=void 0,g=void 0;return this.source.each(function(a){a.appendToBuffer?(f?a.prepend("  + "):f=a,g=a):(f&&(e?f.prepend("buffer += "):d=!0,g.add(";"),f=g=void 0),e=!0,b||(c=!1))}),c?f?(f.prepend("return "),g.add(";")):e||this.source.push('return "";'):(a+=", buffer = "+(d?"":this.initializeBuffer()),f?(f.prepend("return buffer + "),g.add(";")):this.source.push("return buffer;")),a&&this.source.prepend("var "+a.substring(2)+(d?"":";\n")),this.source.merge()},blockValue:function(a){var b=this.aliasable("helpers.blockHelperMissing"),c=[this.contextName(0)];this.setupHelperArgs(a,0,c);var d=this.popStack();c.splice(1,0,d),this.push(this.source.functionCall(b,"call",c))},ambiguousBlockValue:function(){var a=this.aliasable("helpers.blockHelperMissing"),b=[this.contextName(0)];this.setupHelperArgs("",0,b,!0),this.flushInline();var c=this.topStack();b.splice(1,0,c),this.pushSource(["if (!",this.lastHelper,") { ",c," = ",this.source.functionCall(a,"call",b),"}"])},appendContent:function(a){this.pendingContent?a=this.pendingContent+a:this.pendingLocation=this.source.currentLocation,this.pendingContent=a},append:function(){if(this.isInline())this.replaceStack(function(a){return[" != null ? ",a,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()));else{var a=this.popStack();this.pushSource(["if (",a," != null) { ",this.appendToBuffer(a,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){
this.pushSource(this.appendToBuffer([this.aliasable("container.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(a){this.lastContext=a},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(a,b,c,d){var e=0;d||!this.options.compat||this.lastContext?this.pushContext():this.push(this.depthedLookup(a[e++])),this.resolvePath("context",a,e,b,c)},lookupBlockParam:function(a,b){this.useBlockParams=!0,this.push(["blockParams[",a[0],"][",a[1],"]"]),this.resolvePath("context",b,1)},lookupData:function(a,b,c){a?this.pushStackLiteral("container.data(data, "+a+")"):this.pushStackLiteral("data"),this.resolvePath("data",b,0,!0,c)},resolvePath:function(a,b,c,d,e){var g=this;if(this.options.strict||this.options.assumeObjects)return void this.push(f(this.options.strict&&e,this,b,a));for(var h=b.length;c<h;c++)this.replaceStack(function(e){var f=g.nameLookup(e,b[c],a);return d?[" && ",f]:[" != null ? ",f," : ",e]})},resolvePossibleLambda:function(){this.push([this.aliasable("container.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(a,b){this.pushContext(),this.pushString(b),"SubExpression"!==b&&("string"==typeof a?this.pushString(a):this.pushStackLiteral(a))},emptyHash:function(a){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(a?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[],ids:[]}},popHash:function(){var a=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(a.ids)),this.stringParams&&(this.push(this.objectLiteral(a.contexts)),this.push(this.objectLiteral(a.types))),this.push(this.objectLiteral(a.values))},pushString:function(a){this.pushStackLiteral(this.quotedString(a))},pushLiteral:function(a){this.pushStackLiteral(a)},pushProgram:function(a){null!=a?this.pushStackLiteral(this.programExpression(a)):this.pushStackLiteral(null)},registerDecorator:function(a,b){var c=this.nameLookup("decorators",b,"decorator"),d=this.setupHelperArgs(b,a);this.decorators.push(["fn = ",this.decorators.functionCall(c,"",["fn","props","container",d])," || fn;"])},invokeHelper:function(a,b,c){var d=this.popStack(),e=this.setupHelper(a,b),f=c?[e.name," || "]:"",g=["("].concat(f,d);this.options.strict||g.push(" || ",this.aliasable("helpers.helperMissing")),g.push(")"),this.push(this.source.functionCall(g,"call",e.callParams))},invokeKnownHelper:function(a,b){var c=this.setupHelper(a,b);this.push(this.source.functionCall(c.name,"call",c.callParams))},invokeAmbiguous:function(a,b){this.useRegister("helper");var c=this.popStack();this.emptyHash();var d=this.setupHelper(0,a,b),e=this.lastHelper=this.nameLookup("helpers",a,"helper"),f=["(","(helper = ",e," || ",c,")"];this.options.strict||(f[0]="(helper = ",f.push(" != null ? helper : ",this.aliasable("helpers.helperMissing"))),this.push(["(",f,d.paramsInit?["),(",d.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",d.callParams)," : helper))"])},invokePartial:function(a,b,c){var d=[],e=this.setupParams(b,1,d);a&&(b=this.popStack(),delete e.name),c&&(e.indent=JSON.stringify(c)),e.helpers="helpers",e.partials="partials",e.decorators="container.decorators",a?d.unshift(b):d.unshift(this.nameLookup("partials",b,"partial")),this.options.compat&&(e.depths="depths"),e=this.objectLiteral(e),d.push(e),this.push(this.source.functionCall("container.invokePartial","",d))},assignToHash:function(a){var b=this.popStack(),c=void 0,d=void 0,e=void 0;this.trackIds&&(e=this.popStack()),this.stringParams&&(d=this.popStack(),c=this.popStack());var f=this.hash;c&&(f.contexts[a]=c),d&&(f.types[a]=d),e&&(f.ids[a]=e),f.values[a]=b},pushId:function(a,b,c){"BlockParam"===a?this.pushStackLiteral("blockParams["+b[0]+"].path["+b[1]+"]"+(c?" + "+JSON.stringify("."+c):"")):"PathExpression"===a?this.pushString(b):"SubExpression"===a?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:e,compileChildren:function(a,b){for(var c=a.children,d=void 0,e=void 0,f=0,g=c.length;f<g;f++){d=c[f],e=new this.compiler;var h=this.matchExistingProgram(d);null==h?(this.context.programs.push(""),h=this.context.programs.length,d.index=h,d.name="program"+h,this.context.programs[h]=e.compile(d,b,this.context,!this.precompile),this.context.decorators[h]=e.decorators,this.context.environments[h]=d,this.useDepths=this.useDepths||e.useDepths,this.useBlockParams=this.useBlockParams||e.useBlockParams):(d.index=h,d.name="program"+h,this.useDepths=this.useDepths||d.useDepths,this.useBlockParams=this.useBlockParams||d.useBlockParams)}},matchExistingProgram:function(a){for(var b=0,c=this.context.environments.length;b<c;b++){var d=this.context.environments[b];if(d&&d.equals(a))return b}},programExpression:function(a){var b=this.environment.children[a],c=[b.index,"data",b.blockParams];return(this.useBlockParams||this.useDepths)&&c.push("blockParams"),this.useDepths&&c.push("depths"),"container.program("+c.join(", ")+")"},useRegister:function(a){this.registers[a]||(this.registers[a]=!0,this.registers.list.push(a))},push:function(a){return a instanceof d||(a=this.source.wrap(a)),this.inlineStack.push(a),a},pushStackLiteral:function(a){this.push(new d(a))},pushSource:function(a){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),a&&this.source.push(a)},replaceStack:function(a){var b=["("],c=void 0,e=void 0,f=void 0;if(!this.isInline())throw new j.default("replaceStack on non-inline");var g=this.popStack(!0);if(g instanceof d)c=[g.value],b=["(",c],f=!0;else{e=!0;var h=this.incrStack();b=["((",this.push(h)," = ",g,")"],c=this.topStack()}var i=a.call(this,c);f||this.popStack(),e&&this.stackSlot--,this.push(b.concat(i,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var a=this.inlineStack;this.inlineStack=[];for(var b=0,c=a.length;b<c;b++){var e=a[b];if(e instanceof d)this.compileStack.push(e);else{var f=this.incrStack();this.pushSource([f," = ",e,";"]),this.compileStack.push(f)}}},isInline:function(){return this.inlineStack.length},popStack:function(a){var b=this.isInline(),c=(b?this.inlineStack:this.compileStack).pop();if(!a&&c instanceof d)return c.value;if(!b){if(!this.stackSlot)throw new j.default("Invalid stack pop");this.stackSlot--}return c},topStack:function(){var a=this.isInline()?this.inlineStack:this.compileStack,b=a[a.length-1];return b instanceof d?b.value:b},contextName:function(a){return this.useDepths&&a?"depths["+a+"]":"depth"+a},quotedString:function(a){return this.source.quotedString(a)},objectLiteral:function(a){return this.source.objectLiteral(a)},aliasable:function(a){var b=this.aliases[a];return b?(b.referenceCount++,b):(b=this.aliases[a]=this.source.wrap(a),b.aliasable=!0,b.referenceCount=1,b)},setupHelper:function(a,b,c){var d=[],e=this.setupHelperArgs(b,a,d,c),f=this.nameLookup("helpers",b,"helper"),g=this.aliasable(this.contextName(0)+" != null ? "+this.contextName(0)+" : {}");return{params:d,paramsInit:e,name:f,callParams:[g].concat(d)}},setupParams:function(a,b,c){var d={},e=[],f=[],g=[],h=!c,i=void 0;h&&(c=[]),d.name=this.quotedString(a),d.hash=this.popStack(),this.trackIds&&(d.hashIds=this.popStack()),this.stringParams&&(d.hashTypes=this.popStack(),d.hashContexts=this.popStack());var j=this.popStack(),k=this.popStack();(k||j)&&(d.fn=k||"container.noop",d.inverse=j||"container.noop");for(var l=b;l--;)i=this.popStack(),c[l]=i,this.trackIds&&(g[l]=this.popStack()),this.stringParams&&(f[l]=this.popStack(),e[l]=this.popStack());return h&&(d.args=this.source.generateArray(c)),this.trackIds&&(d.ids=this.source.generateArray(g)),this.stringParams&&(d.types=this.source.generateArray(f),d.contexts=this.source.generateArray(e)),this.options.data&&(d.data="data"),this.useBlockParams&&(d.blockParams="blockParams"),d},setupHelperArgs:function(a,b,c,d){var e=this.setupParams(a,b,c);return e=this.objectLiteral(e),d?(this.useRegister("options"),c.push("options"),["options=",e]):c?(c.push(e),""):e}},function(){for(var a="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),b=e.RESERVED_WORDS={},c=0,d=a.length;c<d;c++)b[a[c]]=!0}(),e.isValidJavaScriptVariableName=function(a){return!e.RESERVED_WORDS[a]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(a)},b.default=e,a.exports=b.default},function(a,b,c){"use strict";function d(a,b,c){if(f.isArray(a)){for(var d=[],e=0,g=a.length;e<g;e++)d.push(b.wrap(a[e],c));return d}return"boolean"==typeof a||"number"==typeof a?a+"":a}function e(a){this.srcFile=a,this.source=[]}b.__esModule=!0;var f=c(5),g=void 0;try{}catch(a){}g||(g=function(a,b,c,d){this.src="",d&&this.add(d)},g.prototype={add:function(a){f.isArray(a)&&(a=a.join("")),this.src+=a},prepend:function(a){f.isArray(a)&&(a=a.join("")),this.src=a+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}}),e.prototype={isEmpty:function(){return!this.source.length},prepend:function(a,b){this.source.unshift(this.wrap(a,b))},push:function(a,b){this.source.push(this.wrap(a,b))},merge:function(){var a=this.empty();return this.each(function(b){a.add(["  ",b,"\n"])}),a},each:function(a){for(var b=0,c=this.source.length;b<c;b++)a(this.source[b])},empty:function(){var a=this.currentLocation||{start:{}};return new g(a.start.line,a.start.column,this.srcFile)},wrap:function(a){var b=arguments.length<=1||void 0===arguments[1]?this.currentLocation||{start:{}}:arguments[1];return a instanceof g?a:(a=d(a,this,b),new g(b.start.line,b.start.column,this.srcFile,a))},functionCall:function(a,b,c){return c=this.generateList(c),this.wrap([a,b?"."+b+"(":"(",c,")"])},quotedString:function(a){return'"'+(a+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(a){var b=[];for(var c in a)if(a.hasOwnProperty(c)){var e=d(a[c],this);"undefined"!==e&&b.push([this.quotedString(c),":",e])}var f=this.generateList(b);return f.prepend("{"),f.add("}"),f},generateList:function(a){for(var b=this.empty(),c=0,e=a.length;c<e;c++)c&&b.add(","),b.add(d(a[c],this));return b},generateArray:function(a){var b=this.generateList(a);return b.prepend("["),b.add("]"),b}},b.default=e,a.exports=b.default}])});